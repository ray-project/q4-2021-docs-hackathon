
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.3">
    
    
      
        <title>Utility - Ray</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/termynal.css">
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#utils-package-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://ray.io" title="Ray" class="md-header__button md-logo" aria-label="Ray" data-md-component="logo">
      
  <img src="../../../images/ray-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ray
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Utility
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ray-project/ray" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ray-project/ray
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-deployment/" class="md-tabs__link">
        Deploying Ray
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-ecosystem/" class="md-tabs__link">
        Ecosystem
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-examples/" class="md-tabs__link">
        Examples
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link md-tabs__link--active">
        API
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-contributor-guide/" class="md-tabs__link">
        Contribute
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ray.io" title="Ray" class="md-nav__button md-logo" aria-label="Ray" data-md-component="logo">
      
  <img src="../../../images/ray-logo.png" alt="logo">

    </a>
    Ray
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ray-project/ray" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ray-project/ray
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../..">Getting Started</a>
          
            <label for="__nav_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-overview/what-and-why-ray/" class="md-nav__link">
        Why Ray?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-overview/more-information/" class="md-nav__link">
        Learn more
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-core/">Ray Core</a>
          
            <label for="__nav_1_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Core" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          Ray Core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-core/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-core/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-data/">Ray Data</a>
          
            <label for="__nav_1_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Data" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          Ray Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-data/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5_3" type="checkbox" id="__nav_1_5_3" >
      
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-data/tutorials/">Tutorials</a>
          
        </div>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_5_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-train/">Ray Train</a>
          
            <label for="__nav_1_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Train" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Ray Train
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-train/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-train/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7" type="checkbox" id="__nav_1_7" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-rllib/">Ray RLlib</a>
          
            <label for="__nav_1_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray RLlib" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_7">
          <span class="md-nav__icon md-icon"></span>
          Ray RLlib
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-rllib/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-rllib/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_8" type="checkbox" id="__nav_1_8" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-tune/">Ray Tune</a>
          
            <label for="__nav_1_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Tune" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_8">
          <span class="md-nav__icon md-icon"></span>
          Ray Tune
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-tune/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-tune/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_9" type="checkbox" id="__nav_1_9" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-serve/">Ray Serve</a>
          
            <label for="__nav_1_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Serve" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_9">
          <span class="md-nav__icon md-icon"></span>
          Ray Serve
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-serve/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_9_3" type="checkbox" id="__nav_1_9_3" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-serve/tutorials/">Tutorials</a>
          
            <label for="__nav_1_9_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_9_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-serve/tutorials/model-composition/" class="md-nav__link">
        Model composition
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_10" type="checkbox" id="__nav_1_10" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-workflows/">Ray Workflows</a>
          
            <label for="__nav_1_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Workflows" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_10">
          <span class="md-nav__icon md-icon"></span>
          Ray Workflows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-workflows/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-workflows/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-deployment/">Deploying Ray</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Deploying Ray" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Deploying Ray
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-deployment/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-deployment/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ecosystem/">Ecosystem</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ecosystem" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Ecosystem
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ecosystem/integrations/integrations/" class="md-nav__link">
        Integrations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ecosystem/integrations/joblib/" class="md-nav__link">
        Joblib
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-examples/">Examples</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Crash Course
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Crash Course" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Crash Course
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/00-Ray-Crash-Course-Overview/" class="md-nav__link">
        Ray "Crash Course" Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/01-Ray-Tasks/" class="md-nav__link">
        Ray Crash Course - Tasks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/02-Ray-Actors/" class="md-nav__link">
        Ray Crash Course - Actors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/03-Why-Ray/" class="md-nav__link">
        Ray Crash Course - Why Ray?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/04-Ray-Multiprocessing/" class="md-nav__link">
        Ray Crash Course - Python Multiprocessing with Ray
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/05-Ray-Parallel-Iterators/" class="md-nav__link">
        Ray Crash Course - Ray Parallel Iterators (Now deprecated in Ray 1.7)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/06-Exploring-Ray-API-Calls/" class="md-nav__link">
        Ray Crash Course - Exploring Ray API Calls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/07-Running-Ray-Clusters/" class="md-nav__link">
        Ray Crash Course - Ray Clusters and the Ray CLI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../">API</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Ray RLlib</a>
          
            <label for="__nav_5_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray RLlib" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Ray RLlib
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../agents/" class="md-nav__link">
        Agents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../policy/" class="md-nav__link">
        Policies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../env/" class="md-nav__link">
        Environments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation/" class="md-nav__link">
        Evaluation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../execution/" class="md-nav__link">
        Execution
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Utility
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Utility
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.annotations.override" class="md-nav__link">
    override()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.annotations.PublicAPI" class="md-nav__link">
    PublicAPI()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.annotations.DeveloperAPI" class="md-nav__link">
    DeveloperAPI()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.framework.try_import_tf" class="md-nav__link">
    try_import_tf()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.framework.try_import_tfp" class="md-nav__link">
    try_import_tfp()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.framework.try_import_torch" class="md-nav__link">
    try_import_torch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.deprecation.deprecation_warning" class="md-nav__link">
    deprecation_warning()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter_manager.FilterManager" class="md-nav__link">
    FilterManager
  </a>
  
    <nav class="md-nav" aria-label="FilterManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter_manager.FilterManager.synchronize" class="md-nav__link">
    synchronize()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter.Filter" class="md-nav__link">
    Filter
  </a>
  
    <nav class="md-nav" aria-label="Filter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter.Filter.apply_changes" class="md-nav__link">
    apply_changes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter.Filter.clear_buffer" class="md-nav__link">
    clear_buffer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter.Filter.copy" class="md-nav__link">
    copy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter.Filter.sync" class="md-nav__link">
    sync()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.sigmoid" class="md-nav__link">
    sigmoid()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.softmax" class="md-nav__link">
    softmax()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.relu" class="md-nav__link">
    relu()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.one_hot" class="md-nav__link">
    one_hot()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.fc" class="md-nav__link">
    fc()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.lstm" class="md-nav__link">
    lstm()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.linear_schedule.LinearSchedule" class="md-nav__link">
    LinearSchedule
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.piecewise_schedule.PiecewiseSchedule" class="md-nav__link">
    PiecewiseSchedule
  </a>
  
    <nav class="md-nav" aria-label="PiecewiseSchedule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.piecewise_schedule.PiecewiseSchedule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.polynomial_schedule.PolynomialSchedule" class="md-nav__link">
    PolynomialSchedule
  </a>
  
    <nav class="md-nav" aria-label="PolynomialSchedule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.polynomial_schedule.PolynomialSchedule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.exponential_schedule.ExponentialSchedule" class="md-nav__link">
    ExponentialSchedule
  </a>
  
    <nav class="md-nav" aria-label="ExponentialSchedule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.exponential_schedule.ExponentialSchedule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.constant_schedule.ConstantSchedule" class="md-nav__link">
    ConstantSchedule
  </a>
  
    <nav class="md-nav" aria-label="ConstantSchedule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.constant_schedule.ConstantSchedule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.test_utils.check" class="md-nav__link">
    check()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.test_utils.check_compute_single_action" class="md-nav__link">
    check_compute_single_action()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.test_utils.check_train_results" class="md-nav__link">
    check_train_results()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.test_utils.framework_iterator" class="md-nav__link">
    framework_iterator()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.util.ml_utils.dict.merge_dicts" class="md-nav__link">
    merge_dicts()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.util.ml_utils.dict.deep_update" class="md-nav__link">
    deep_update()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.add_mixins" class="md-nav__link">
    add_mixins()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.force_list" class="md-nav__link">
    force_list()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.force_tuple" class="md-nav__link">
    force_tuple
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-core/" class="md-nav__link">
        Ray Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-data/" class="md-nav__link">
        Ray Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-train/" class="md-nav__link">
        Ray Train
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-tune/" class="md-nav__link">
        Ray Tune
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-workflows/" class="md-nav__link">
        Ray Workflows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-serve/" class="md-nav__link">
        Ray Serve
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-contributor-guide/">Contribute</a>
          
            <label for="__nav_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Contribute" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Contribute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-contributor-guide/getting-involved/" class="md-nav__link">
        Start Contributing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-contributor-guide/installing-ray/building-ray-on-linux-and-macos/" class="md-nav__link">
        Building Ray on Linux and macOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-contributor-guide/installing-ray/building-ray-on-windows/" class="md-nav__link">
        Building Ray on Windows
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.annotations.override" class="md-nav__link">
    override()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.annotations.PublicAPI" class="md-nav__link">
    PublicAPI()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.annotations.DeveloperAPI" class="md-nav__link">
    DeveloperAPI()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.framework.try_import_tf" class="md-nav__link">
    try_import_tf()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.framework.try_import_tfp" class="md-nav__link">
    try_import_tfp()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.framework.try_import_torch" class="md-nav__link">
    try_import_torch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.deprecation.deprecation_warning" class="md-nav__link">
    deprecation_warning()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter_manager.FilterManager" class="md-nav__link">
    FilterManager
  </a>
  
    <nav class="md-nav" aria-label="FilterManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter_manager.FilterManager.synchronize" class="md-nav__link">
    synchronize()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter.Filter" class="md-nav__link">
    Filter
  </a>
  
    <nav class="md-nav" aria-label="Filter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter.Filter.apply_changes" class="md-nav__link">
    apply_changes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter.Filter.clear_buffer" class="md-nav__link">
    clear_buffer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter.Filter.copy" class="md-nav__link">
    copy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.filter.Filter.sync" class="md-nav__link">
    sync()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.sigmoid" class="md-nav__link">
    sigmoid()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.softmax" class="md-nav__link">
    softmax()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.relu" class="md-nav__link">
    relu()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.one_hot" class="md-nav__link">
    one_hot()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.fc" class="md-nav__link">
    fc()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.numpy.lstm" class="md-nav__link">
    lstm()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.linear_schedule.LinearSchedule" class="md-nav__link">
    LinearSchedule
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.piecewise_schedule.PiecewiseSchedule" class="md-nav__link">
    PiecewiseSchedule
  </a>
  
    <nav class="md-nav" aria-label="PiecewiseSchedule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.piecewise_schedule.PiecewiseSchedule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.polynomial_schedule.PolynomialSchedule" class="md-nav__link">
    PolynomialSchedule
  </a>
  
    <nav class="md-nav" aria-label="PolynomialSchedule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.polynomial_schedule.PolynomialSchedule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.exponential_schedule.ExponentialSchedule" class="md-nav__link">
    ExponentialSchedule
  </a>
  
    <nav class="md-nav" aria-label="ExponentialSchedule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.exponential_schedule.ExponentialSchedule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.constant_schedule.ConstantSchedule" class="md-nav__link">
    ConstantSchedule
  </a>
  
    <nav class="md-nav" aria-label="ConstantSchedule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.utils.schedules.constant_schedule.ConstantSchedule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.test_utils.check" class="md-nav__link">
    check()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.test_utils.check_compute_single_action" class="md-nav__link">
    check_compute_single_action()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.test_utils.check_train_results" class="md-nav__link">
    check_train_results()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.test_utils.framework_iterator" class="md-nav__link">
    framework_iterator()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.util.ml_utils.dict.merge_dicts" class="md-nav__link">
    merge_dicts()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.util.ml_utils.dict.deep_update" class="md-nav__link">
    deep_update()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.add_mixins" class="md-nav__link">
    add_mixins()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.force_list" class="md-nav__link">
    force_list()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.utils.force_tuple" class="md-nav__link">
    force_tuple
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="utils-package-api-reference"><code>utils</code> Package API Reference</h1>


  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.annotations.override">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Annotation for documenting method overrides.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>cls</code></td>
        <td><code>type</code></td>
        <td><p>The superclass that provides the overridden method. If this
cls does not actually have the method, an error is raised.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/annotations.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">override</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Annotation for documenting method overrides.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">        cls (type): The superclass that provides the overridden method. If this</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">            cls does not actually have the method, an error is raised.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="k">def</span> <span class="nf">check_override</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> does not override any method of </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>                <span class="n">method</span><span class="p">,</span> <span class="bp">cls</span><span class="p">))</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>        <span class="k">return</span> <span class="n">method</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="k">return</span> <span class="n">check_override</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.annotations.PublicAPI">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">PublicAPI</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Annotation for documenting public APIs.</p>
<p>Public APIs are classes and methods exposed to end users of RLlib. You
can expect these APIs to remain stable across RLlib releases.</p>
<p>Subclasses that inherit from a <code>@PublicAPI</code> base class can be
assumed part of the RLlib public API as well (e.g., all trainer classes
are in public API because Trainer is <code>@PublicAPI</code>).</p>
<p>In addition, you can assume all trainer configurations are part of their
public API as well.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/annotations.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">PublicAPI</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Annotation for documenting public APIs.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    Public APIs are classes and methods exposed to end users of RLlib. You</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    can expect these APIs to remain stable across RLlib releases.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Subclasses that inherit from a ``@PublicAPI`` base class can be</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    assumed part of the RLlib public API as well (e.g., all trainer classes</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    are in public API because Trainer is ``@PublicAPI``).</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    In addition, you can assume all trainer configurations are part of their</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    public API as well.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.annotations.DeveloperAPI">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">DeveloperAPI</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Annotation for documenting developer APIs.</p>
<p>Developer APIs are classes and methods explicitly exposed to developers
for the purposes of building custom algorithms or advanced training
strategies on top of RLlib internals. You can generally expect these APIs
to be stable sans minor changes (but less stable than public APIs).</p>
<p>Subclasses that inherit from a <code>@DeveloperAPI</code> base class can be
assumed part of the RLlib developer API as well.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/annotations.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">DeveloperAPI</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Annotation for documenting developer APIs.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    Developer APIs are classes and methods explicitly exposed to developers</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    for the purposes of building custom algorithms or advanced training</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    strategies on top of RLlib internals. You can generally expect these APIs</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    to be stable sans minor changes (but less stable than public APIs).</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    Subclasses that inherit from a ``@DeveloperAPI`` base class can be</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    assumed part of the RLlib developer API as well.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.framework.try_import_tf">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">try_import_tf</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Tries importing tf and returns the module (or None).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>error</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to raise an error if tf cannot be imported.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple containing
1) tf1.x module (either from tf2.x.compat.v1 OR as tf1.x).
2) tf module (resulting from `import tensorflow`). Either tf1.x or
2.x. 3) The actually installed tf version as int</code></td>
      <td><p>1 or 2.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If error=True and tf is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/framework.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">try_import_tf</span><span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Tries importing tf and returns the module (or None).</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">        error: Whether to raise an error if tf cannot be imported.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        Tuple containing</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        1) tf1.x module (either from tf2.x.compat.v1 OR as tf1.x).</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        2) tf module (resulting from `import tensorflow`). Either tf1.x or</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        2.x. 3) The actually installed tf version as int: 1 or 2.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        ImportError: If error=True and tf is not installed.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="c1"># Make sure, these are reset after each test case</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="c1"># that uses them: del os.environ[&quot;RLLIB_TEST_NO_TF_IMPORT&quot;]</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">if</span> <span class="s2">&quot;RLLIB_TEST_NO_TF_IMPORT&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Not importing TensorFlow for test purposes&quot;</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">if</span> <span class="s2">&quot;TF_CPP_MIN_LOG_LEVEL&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;TF_CPP_MIN_LOG_LEVEL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;3&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="c1"># Try to reuse already imported tf module. This will avoid going through</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="c1"># the initial import steps below and thereby switching off v2_behavior</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="c1"># (switching off v2 behavior twice breaks all-framework tests for eager).</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">was_imported</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="k">if</span> <span class="s2">&quot;tensorflow&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="n">tf_module</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">]</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="n">was_imported</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>            <span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf_module</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>                    <span class="s2">&quot;Could not import TensorFlow! RLlib requires you to &quot;</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                    <span class="s2">&quot;install at least one deep-learning framework: &quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>                    <span class="s2">&quot;`pip install [torch|tensorflow|jax]`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="c1"># Try &quot;reducing&quot; tf to tf.compat.v1.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="n">tf1_module</span> <span class="o">=</span> <span class="n">tf_module</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">tf1_module</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">set_verbosity</span><span class="p">(</span><span class="n">tf1_module</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">was_imported</span><span class="p">:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>            <span class="n">tf1_module</span><span class="o">.</span><span class="n">disable_v2_behavior</span><span class="p">()</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="n">tf1_module</span><span class="o">.</span><span class="n">enable_resource_variables</span><span class="p">()</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">tf1_module</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">set_verbosity</span><span class="p">(</span><span class="n">tf1_module</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">WARN</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="c1"># No compat.v1 -&gt; return tf as is.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="n">tf1_module</span> <span class="o">=</span> <span class="n">tf_module</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tf_module</span><span class="p">,</span> <span class="s2">&quot;__version__&quot;</span><span class="p">):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># sphinx doc gen</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">version</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="s2">&quot;2.&quot;</span> <span class="ow">in</span> <span class="n">tf_module</span><span class="o">.</span><span class="n">__version__</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="k">return</span> <span class="n">tf1_module</span><span class="p">,</span> <span class="n">tf_module</span><span class="p">,</span> <span class="n">version</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.framework.try_import_tfp">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">try_import_tfp</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Tries importing tfp and returns the module (or None).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>error</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to raise an error if tfp cannot be imported.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>The tfp module.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If error=True and tfp is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/framework.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">try_import_tfp</span><span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Tries importing tfp and returns the module (or None).</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">        error: Whether to raise an error if tfp cannot be imported.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        The tfp module.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        ImportError: If error=True and tfp is not installed.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="k">if</span> <span class="s2">&quot;RLLIB_TEST_NO_TF_IMPORT&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Not importing TensorFlow Probability for test &quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>                       <span class="s2">&quot;purposes.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="kn">import</span> <span class="nn">tensorflow_probability</span> <span class="k">as</span> <span class="nn">tfp</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="k">return</span> <span class="n">tfp</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>            <span class="k">raise</span> <span class="n">e</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.framework.try_import_torch">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">try_import_torch</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Tries importing torch and returns the module (or None).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>error</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to raise an error if torch cannot be imported.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>Tuple consisting of the torch- AND torch.nn modules.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ImportError</code></td>
        <td><p>If error=True and PyTorch is not installed.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/framework.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">try_import_torch</span><span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Tries importing torch and returns the module (or None).</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">        error: Whether to raise an error if torch cannot be imported.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        Tuple consisting of the torch- AND torch.nn modules.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        ImportError: If error=True and PyTorch is not installed.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="k">if</span> <span class="s2">&quot;RLLIB_TEST_NO_TORCH_IMPORT&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Not importing PyTorch for test purposes.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="k">return</span> <span class="n">_torch_stubs</span><span class="p">()</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="kn">import</span> <span class="nn">torch</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="k">return</span> <span class="n">torch</span><span class="p">,</span> <span class="n">nn</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>                <span class="s2">&quot;Could not import PyTorch! RLlib requires you to &quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>                <span class="s2">&quot;install at least one deep-learning framework: &quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>                <span class="s2">&quot;`pip install [torch|tensorflow|jax]`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="k">return</span> <span class="n">_torch_stubs</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.deprecation.deprecation_warning">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">deprecation</span><span class="o">.</span><span class="n">deprecation_warning</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Warns (via the <code>logger</code> object) or throws a deprecation warning/error.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>old</code></td>
        <td><code>str</code></td>
        <td><p>A description of the "thing" that is to be deprecated.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>new</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>A description of the new "thing" that replaces it.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>help</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>An optional help text to tell the user, what to
do instead of using <code>old</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>error</code></td>
        <td><code>Optional[Union[bool, Exception]]</code></td>
        <td><p>Whether or which exception to
raise. If True, raise ValueError. If False, just warn.
If error is-a subclass of Exception, raise that Exception.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If <code>error=True</code>.</p></td>
      </tr>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Of type <code>error</code>, iff error is-a Exception subclass.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/deprecation.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">deprecation_warning</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>        <span class="n">old</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="n">new</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">help</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="n">error</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="sd">&quot;&quot;&quot;Warns (via the `logger` object) or throws a deprecation warning/error.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        old (str): A description of the &quot;thing&quot; that is to be deprecated.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        new (Optional[str]): A description of the new &quot;thing&quot; that replaces it.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        help (Optional[str]): An optional help text to tell the user, what to</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            do instead of using `old`.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        error (Optional[Union[bool, Exception]]): Whether or which exception to</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            raise. If True, raise ValueError. If False, just warn.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            If error is-a subclass of Exception, raise that Exception.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        ValueError: If `error=True`.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        Exception: Of type `error`, iff error is-a Exception subclass.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;`</span><span class="si">{}</span><span class="s2">` has been deprecated.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="n">old</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot; Use `</span><span class="si">{}</span><span class="s2">` instead.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> <span class="k">if</span> <span class="n">new</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">help</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>              <span class="k">if</span> <span class="n">help</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="k">if</span> <span class="n">error</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="k">elif</span> <span class="n">error</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="k">raise</span> <span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;DeprecationWarning: &quot;</span> <span class="o">+</span> <span class="n">msg</span> <span class="o">+</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>                       <span class="s2">&quot; This will raise an error in the future!&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.utils.filter_manager.FilterManager">
        <code>
ray.rllib.utils.filter_manager.FilterManager        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Manages filters and coordination across remote evaluators that expose
<code>get_filters</code> and <code>sync_filters</code>.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.utils.filter_manager.FilterManager.synchronize">
<code class="highlight language-python"><span class="n">synchronize</span><span class="p">(</span><span class="n">local_filters</span><span class="p">,</span> <span class="n">remotes</span><span class="p">,</span> <span class="n">update_remote</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Aggregates all filters from remote evaluators.</p>
<p>Local copy is updated and then broadcasted to all remote evaluators.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>local_filters</code></td>
        <td><code>dict</code></td>
        <td><p>Filters to be synchronized.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>remotes</code></td>
        <td><code>list</code></td>
        <td><p>Remote evaluators with filters.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>update_remote</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to push updates to remote filters.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/filter_manager.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nd">@DeveloperAPI</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="k">def</span> <span class="nf">synchronize</span><span class="p">(</span><span class="n">local_filters</span><span class="p">,</span> <span class="n">remotes</span><span class="p">,</span> <span class="n">update_remote</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="sd">&quot;&quot;&quot;Aggregates all filters from remote evaluators.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Local copy is updated and then broadcasted to all remote evaluators.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        local_filters (dict): Filters to be synchronized.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        remotes (list): Remote evaluators with filters.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        update_remote (bool): Whether to push updates to remote filters.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">remote_filters</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">get_filters</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">flush_after</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">remotes</span><span class="p">])</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="k">for</span> <span class="n">rf</span> <span class="ow">in</span> <span class="n">remote_filters</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">local_filters</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>            <span class="n">local_filters</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">apply_changes</span><span class="p">(</span><span class="n">rf</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">with_buffer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">if</span> <span class="n">update_remote</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="n">copies</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">as_serializable</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">local_filters</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="n">remote_copy</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">copies</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">sync_filters</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">remote_copy</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">remotes</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.utils.filter.Filter">
        <code>
ray.rllib.utils.filter.Filter        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Processes input, possibly statefully.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.utils.filter.Filter.apply_changes">
<code class="highlight language-python"><span class="n">apply_changes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Updates self with "new state" from other filter.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/filter.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">apply_changes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Updates self with &quot;new state&quot; from other filter.&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.utils.filter.Filter.clear_buffer">
<code class="highlight language-python"><span class="n">clear_buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Creates copy of current state and clears accumulated state</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/filter.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">clear_buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Creates copy of current state and clears accumulated state&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.utils.filter.Filter.copy">
<code class="highlight language-python"><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Creates a new object with same state as self.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>A copy of self.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/filter.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Creates a new object with same state as self.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">        A copy of self.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.utils.filter.Filter.sync">
<code class="highlight language-python"><span class="n">sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Copies all state from other filter to self.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/filter.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Copies all state from other filter to self.&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.numpy.sigmoid">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">derivative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Returns the sigmoid function applied to x.
Alternatively, can return the derivative or the sigmoid function.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>ndarray</code></td>
        <td><p>The input to the sigmoid function.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>derivative</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to return the derivative or not.
Default: False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ndarray</code></td>
      <td><p>The sigmoid function (or its derivative) applied to x.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/numpy.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">derivative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="sd">    Returns the sigmoid function applied to x.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    Alternatively, can return the derivative or the sigmoid function.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        x: The input to the sigmoid function.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        derivative: Whether to return the derivative or not.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">            Default: False.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        The sigmoid function (or its derivative) applied to x.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="k">if</span> <span class="n">derivative</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.numpy.softmax">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Returns the softmax values for x.</p>
<p>The exact formula used is:
S(xi) = e^xi / SUMj(e^xj), where j goes over all elements in x.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>ndarray</code></td>
        <td><p>The input to the softmax function.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>axis</code></td>
        <td><code>int</code></td>
        <td><p>The axis along which to softmax.</p></td>
        <td><code>-1</code></td>
      </tr>
      <tr>
        <td><code>epsilon</code></td>
        <td><code>Optional[float]</code></td>
        <td><p>Optional epsilon as a minimum value. If None, use
<code>SMALL_NUMBER</code>.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ndarray</code></td>
      <td><p>The softmax over x.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/numpy.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>            <span class="n">epsilon</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Returns the softmax values for x.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    The exact formula used is:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    S(xi) = e^xi / SUMj(e^xj), where j goes over all elements in x.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        x: The input to the softmax function.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        axis: The axis along which to softmax.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        epsilon: Optional epsilon as a minimum value. If None, use</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            `SMALL_NUMBER`.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        The softmax over x.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="ow">or</span> <span class="n">SMALL_NUMBER</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="c1"># x_exp = np.maximum(np.exp(x), SMALL_NUMBER)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">x_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="c1"># return x_exp /</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="c1">#   np.maximum(np.sum(x_exp, axis, keepdims=True), SMALL_NUMBER)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x_exp</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x_exp</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">epsilon</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.numpy.relu">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Implementation of the leaky ReLU function.</p>
<p>y = x * alpha if x &lt; 0 else x</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>ndarray</code></td>
        <td><p>The input values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>alpha</code></td>
        <td><code>float</code></td>
        <td><p>A scaling ("leak") factor to use for negative x.</p></td>
        <td><code>0.0</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ndarray</code></td>
      <td><p>The leaky ReLU output for x.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/numpy.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">relu</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Implementation of the leaky ReLU function.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    y = x * alpha if x &lt; 0 else x</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        x: The input values.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        alpha: A scaling (&quot;leak&quot;) factor to use for negative x.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        The leaky ReLU output for x.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.numpy.one_hot">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">on_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">off_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>One-hot utility function for numpy.</p>
<p>Thanks to qianyizhang:
https://gist.github.com/qianyizhang/07ee1c15cad08afb03f5de69349efc30.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>Union[Any, int]</code></td>
        <td><p>The input to be one-hot encoded.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>depth</code></td>
        <td><code>int</code></td>
        <td><p>The max. number to be one-hot encoded (size of last rank).</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>on_value</code></td>
        <td><code>int</code></td>
        <td><p>The value to use for on. Default: 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
      <tr>
        <td><code>off_value</code></td>
        <td><code>float</code></td>
        <td><p>The value to use for off. Default: 0.0.</p></td>
        <td><code>0.0</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ndarray</code></td>
      <td><p>The one-hot encoded equivalent of the input array.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/numpy.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">one_hot</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TensorType</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>            <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>            <span class="n">on_value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>            <span class="n">off_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;One-hot utility function for numpy.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Thanks to qianyizhang:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    https://gist.github.com/qianyizhang/07ee1c15cad08afb03f5de69349efc30.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        x: The input to be one-hot encoded.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        depth: The max. number to be one-hot encoded (size of last rank).</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        on_value: The value to use for on. Default: 1.0.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        off_value: The value to use for off. Default: 0.0.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        The one-hot encoded equivalent of the input array.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="c1"># Handle simple ints properly.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="c1"># Handle torch arrays properly.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="k">elif</span> <span class="n">torch</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="c1"># Handle bool arrays correctly.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="n">depth</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="c1"># If depth is not given, try to infer it from the values in the array.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="n">depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">depth</span><span class="p">,</span> \
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="s2">&quot;ERROR: The max. index of `x` (</span><span class="si">{}</span><span class="s2">) is larger than depth (</span><span class="si">{}</span><span class="s2">)!&quot;</span><span class="o">.</span>\
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">depth</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">shape</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="c1"># Python 2.7 compatibility, (*shape, depth) is not allowed.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">shape_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">shape</span><span class="p">[:])</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">shape_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape_list</span><span class="p">)</span> <span class="o">*</span> <span class="n">off_value</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">indices</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="n">tiles</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="n">tiles</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">tiles</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">out</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">indices</span><span class="p">)]</span> <span class="o">=</span> <span class="n">on_value</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">return</span> <span class="n">out</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.numpy.fc">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">biases</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">framework</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Calculates FC (dense) layer outputs given weights/biases and input.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>ndarray</code></td>
        <td><p>The input to the dense layer.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>weights</code></td>
        <td><code>ndarray</code></td>
        <td><p>The weights matrix.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>biases</code></td>
        <td><code>Optional[numpy.ndarray]</code></td>
        <td><p>The biases vector. All 0s if None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>framework</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>An optional framework hint (to figure out,
e.g. whether to transpose torch weight matrices).</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ndarray</code></td>
      <td><p>The dense layer's output.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/numpy.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">fc</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>       <span class="n">weights</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>       <span class="n">biases</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>       <span class="n">framework</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Calculates FC (dense) layer outputs given weights/biases and input.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        x: The input to the dense layer.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        weights: The weights matrix.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        biases: The biases vector. All 0s if None.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        framework: An optional framework hint (to figure out,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            e.g. whether to transpose torch weight matrices).</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        The dense layer&#39;s output.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">def</span> <span class="nf">map_</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="k">if</span> <span class="n">torch</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="k">if</span> <span class="n">tf</span> <span class="ow">and</span> <span class="n">tf</span><span class="o">.</span><span class="n">executing_eagerly</span><span class="p">():</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">):</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="k">if</span> <span class="n">transpose</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="k">return</span> <span class="n">data</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">map_</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="c1"># Torch stores matrices in transpose (faster for backprop).</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">transpose</span> <span class="o">=</span> <span class="p">(</span><span class="n">framework</span> <span class="o">==</span> <span class="s2">&quot;torch&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>                                           <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">weights</span> <span class="o">=</span> <span class="n">map_</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="n">transpose</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">biases</span> <span class="o">=</span> <span class="n">map_</span><span class="p">(</span><span class="n">biases</span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="n">biases</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">biases</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.numpy.lstm">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">lstm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">biases</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_internal_states</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_major</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">forget_bias</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Calculates LSTM layer output given weights/biases, states, and input.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td></td>
        <td><p>The inputs to the LSTM layer including time-rank
(0th if time-major, else 1st) and the batch-rank
(1st if time-major, else 0th).</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>weights</code></td>
        <td><code>ndarray</code></td>
        <td><p>The weights matrix.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>biases</code></td>
        <td><code>Optional[numpy.ndarray]</code></td>
        <td><p>The biases vector. All 0s if None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>initial_internal_states</code></td>
        <td><code>Optional[numpy.ndarray]</code></td>
        <td><p>The initial internal
states to pass into the layer. All 0s if None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>time_major</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use time-major or not. Default: False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>forget_bias</code></td>
        <td><code>float</code></td>
        <td><p>Gets added to first sigmoid (forget gate) output.
Default: 1.0.</p></td>
        <td><code>1.0</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple consisting of 1) The LSTM layer&#39;s output and
2) Tuple</code></td>
      <td><p>Last (c-state, h-state).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/numpy.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">lstm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>         <span class="n">weights</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>         <span class="n">biases</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>         <span class="n">initial_internal_states</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>         <span class="n">time_major</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>         <span class="n">forget_bias</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="sd">&quot;&quot;&quot;Calculates LSTM layer output given weights/biases, states, and input.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        x: The inputs to the LSTM layer including time-rank</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            (0th if time-major, else 1st) and the batch-rank</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            (1st if time-major, else 0th).</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        weights: The weights matrix.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        biases: The biases vector. All 0s if None.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        initial_internal_states: The initial internal</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            states to pass into the layer. All 0s if None.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        time_major: Whether to use time-major or not. Default: False.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        forget_bias: Gets added to first sigmoid (forget gate) output.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            Default: 1.0.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        Tuple consisting of 1) The LSTM layer&#39;s output and</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        2) Tuple: Last (c-state, h-state).</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">sequence_length</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">time_major</span> <span class="k">else</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">time_major</span> <span class="k">else</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">units</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">4</span>  <span class="c1"># 4 internal layers (3x sigmoid, 1x tanh)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="k">if</span> <span class="n">initial_internal_states</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="n">c_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">units</span><span class="p">))</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="n">h_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">units</span><span class="p">))</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">c_states</span> <span class="o">=</span> <span class="n">initial_internal_states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="n">h_states</span> <span class="o">=</span> <span class="n">initial_internal_states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="c1"># Create a placeholder for all n-time step outputs.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="k">if</span> <span class="n">time_major</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="n">unrolled_outputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">sequence_length</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">units</span><span class="p">))</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="n">unrolled_outputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">sequence_length</span><span class="p">,</span> <span class="n">units</span><span class="p">))</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="c1"># Push the batch 4 times through the LSTM cell and capture the outputs plus</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="c1"># the final h- and c-states.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sequence_length</span><span class="p">):</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="n">input_matrix</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="k">if</span> <span class="n">time_major</span> <span class="k">else</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">t</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="n">input_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">input_matrix</span><span class="p">,</span> <span class="n">h_states</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">input_matmul_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">input_matrix</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span> <span class="o">+</span> <span class="n">biases</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="c1"># Forget gate (3rd slot in tf output matrix). Add static forget bias.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">sigmoid_1</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">input_matmul_matrix</span><span class="p">[:,</span> <span class="n">units</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:</span><span class="n">units</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span> <span class="o">+</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>                            <span class="n">forget_bias</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">c_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">c_states</span><span class="p">,</span> <span class="n">sigmoid_1</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="c1"># Add gate (1st and 2nd slots in tf output matrix).</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="n">sigmoid_2</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">input_matmul_matrix</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">units</span><span class="p">])</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="n">tanh_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">input_matmul_matrix</span><span class="p">[:,</span> <span class="n">units</span><span class="p">:</span><span class="n">units</span> <span class="o">*</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="n">c_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">c_states</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">sigmoid_2</span><span class="p">,</span> <span class="n">tanh_3</span><span class="p">))</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="c1"># Output gate (last slot in tf output matrix).</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">sigmoid_4</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">input_matmul_matrix</span><span class="p">[:,</span> <span class="n">units</span> <span class="o">*</span> <span class="mi">3</span><span class="p">:</span><span class="n">units</span> <span class="o">*</span> <span class="mi">4</span><span class="p">])</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">h_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">sigmoid_4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">c_states</span><span class="p">))</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="c1"># Store this output time-slice.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="k">if</span> <span class="n">time_major</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="n">unrolled_outputs</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">h_states</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="n">unrolled_outputs</span><span class="p">[:,</span> <span class="n">t</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">h_states</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">return</span> <span class="n">unrolled_outputs</span><span class="p">,</span> <span class="p">(</span><span class="n">c_states</span><span class="p">,</span> <span class="n">h_states</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.utils.schedules.linear_schedule.LinearSchedule">
        <code>
ray.rllib.utils.schedules.linear_schedule.LinearSchedule            (<a title="ray.rllib.utils.schedules.polynomial_schedule.PolynomialSchedule" href="#ray.rllib.utils.schedules.polynomial_schedule.PolynomialSchedule">PolynomialSchedule</a>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Linear interpolation between <code>initial_p</code> and <code>final_p</code>. Simply
uses Polynomial with power=1.0.</p>
<p>final_p + (initial_p - final_p) * (1 - <code>t</code>/t_max)</p>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.utils.schedules.piecewise_schedule.PiecewiseSchedule">
        <code>
ray.rllib.utils.schedules.piecewise_schedule.PiecewiseSchedule            (<span title="ray.rllib.utils.schedules.schedule.Schedule">Schedule</span>)
        </code>



</h2>

    <div class="doc doc-contents first">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.utils.schedules.piecewise_schedule.PiecewiseSchedule.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">,</span> <span class="n">framework</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_linear_interpolation</span> <span class="n">at</span> <span class="mh">0x11030d3b0</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">outside_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>endpoints</code></td>
        <td><code>List[Tuple[int,float]]</code></td>
        <td><p>A list of tuples
<code>(t, value)</code> such that the output
is an interpolation (given by the <code>interpolation</code> callable)
between two values.
E.g.
t=400 and endpoints=[(0, 20.0),(500, 30.0)]
output=20.0 + 0.8 * (30.0 - 20.0) = 28.0
NOTE: All the values for time must be sorted in an increasing
order.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>interpolation</code></td>
        <td><code>callable</code></td>
        <td><p>A function that takes the left-value,
the right-value and an alpha interpolation parameter
(0.0=only left value, 1.0=only right value), which is the
fraction of distance from left endpoint to right endpoint.</p></td>
        <td><code>&lt;function _linear_interpolation at 0x11030d3b0&gt;</code></td>
      </tr>
      <tr>
        <td><code>outside_value</code></td>
        <td><code>Optional[float]</code></td>
        <td><p>If t in call to <code>value</code> is
outside of all the intervals in <code>endpoints</code> this value is
returned. If None then an AssertionError is raised when outside
value is requested.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/schedules/piecewise_schedule.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>             <span class="n">endpoints</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">framework</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>             <span class="n">interpolation</span><span class="o">=</span><span class="n">_linear_interpolation</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>             <span class="n">outside_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        endpoints (List[Tuple[int,float]]): A list of tuples</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">            `(t, value)` such that the output</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">            is an interpolation (given by the `interpolation` callable)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            between two values.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            E.g.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            t=400 and endpoints=[(0, 20.0),(500, 30.0)]</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">            output=20.0 + 0.8 * (30.0 - 20.0) = 28.0</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            NOTE: All the values for time must be sorted in an increasing</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            order.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        interpolation (callable): A function that takes the left-value,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            the right-value and an alpha interpolation parameter</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">            (0.0=only left value, 1.0=only right value), which is the</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">            fraction of distance from left endpoint to right endpoint.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        outside_value (Optional[float]): If t in call to `value` is</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">            outside of all the intervals in `endpoints` this value is</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">            returned. If None then an AssertionError is raised when outside</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            value is requested.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">framework</span><span class="o">=</span><span class="n">framework</span><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">idxes</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">endpoints</span><span class="p">]</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="k">assert</span> <span class="n">idxes</span> <span class="o">==</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">idxes</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">outside_value</span> <span class="o">=</span> <span class="n">outside_value</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">endpoints</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.utils.schedules.polynomial_schedule.PolynomialSchedule">
        <code>
ray.rllib.utils.schedules.polynomial_schedule.PolynomialSchedule            (<span title="ray.rllib.utils.schedules.schedule.Schedule">Schedule</span>)
        </code>



</h2>

    <div class="doc doc-contents first">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.utils.schedules.polynomial_schedule.PolynomialSchedule.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schedule_timesteps</span><span class="p">,</span> <span class="n">final_p</span><span class="p">,</span> <span class="n">framework</span><span class="p">,</span> <span class="n">initial_p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Polynomial interpolation between initial_p and final_p over
schedule_timesteps. After this many time steps, always <code>final_p</code> is
returned.</p>
<p>!!! agrs
    schedule_timesteps (int): Number of time steps for which to
        linearly anneal initial_p to final_p
    final_p (float): Final output value.
    initial_p (float): Initial output value.
    framework (Optional[str]): One of "tf", "torch", or None.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/schedules/polynomial_schedule.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>             <span class="n">schedule_timesteps</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">final_p</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>             <span class="n">framework</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>             <span class="n">initial_p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>             <span class="n">power</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Polynomial interpolation between initial_p and final_p over</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    schedule_timesteps. After this many time steps, always `final_p` is</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    returned.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    Agrs:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        schedule_timesteps (int): Number of time steps for which to</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">            linearly anneal initial_p to final_p</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        final_p (float): Final output value.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        initial_p (float): Initial output value.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        framework (Optional[str]): One of &quot;tf&quot;, &quot;torch&quot;, or None.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">framework</span><span class="o">=</span><span class="n">framework</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="k">assert</span> <span class="n">schedule_timesteps</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">schedule_timesteps</span> <span class="o">=</span> <span class="n">schedule_timesteps</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">final_p</span> <span class="o">=</span> <span class="n">final_p</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">initial_p</span> <span class="o">=</span> <span class="n">initial_p</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">power</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.utils.schedules.exponential_schedule.ExponentialSchedule">
        <code>
ray.rllib.utils.schedules.exponential_schedule.ExponentialSchedule            (<span title="ray.rllib.utils.schedules.schedule.Schedule">Schedule</span>)
        </code>



</h2>

    <div class="doc doc-contents first">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.utils.schedules.exponential_schedule.ExponentialSchedule.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schedule_timesteps</span><span class="p">,</span> <span class="n">framework</span><span class="p">,</span> <span class="n">initial_p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">decay_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Exponential decay schedule from initial_p to final_p over
schedule_timesteps. After this many time steps always <code>final_p</code> is
returned.</p>
<p>!!! agrs
    schedule_timesteps (int): Number of time steps for which to
        linearly anneal initial_p to final_p
    initial_p (float): Initial output value.
    decay_rate (float): The percentage of the original value after
        100% of the time has been reached (see formula above).
        &gt;0.0: The smaller the decay-rate, the stronger the decay.
        1.0: No decay at all.
    framework (Optional[str]): One of "tf", "torch", or None.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/schedules/exponential_schedule.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>             <span class="n">schedule_timesteps</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">framework</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>             <span class="n">initial_p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>             <span class="n">decay_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Exponential decay schedule from initial_p to final_p over</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    schedule_timesteps. After this many time steps always `final_p` is</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    returned.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Agrs:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        schedule_timesteps (int): Number of time steps for which to</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            linearly anneal initial_p to final_p</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        initial_p (float): Initial output value.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        decay_rate (float): The percentage of the original value after</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            100% of the time has been reached (see formula above).</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">            &gt;0.0: The smaller the decay-rate, the stronger the decay.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">            1.0: No decay at all.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        framework (Optional[str]): One of &quot;tf&quot;, &quot;torch&quot;, or None.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">framework</span><span class="o">=</span><span class="n">framework</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">assert</span> <span class="n">schedule_timesteps</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">schedule_timesteps</span> <span class="o">=</span> <span class="n">schedule_timesteps</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">initial_p</span> <span class="o">=</span> <span class="n">initial_p</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">decay_rate</span> <span class="o">=</span> <span class="n">decay_rate</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.utils.schedules.constant_schedule.ConstantSchedule">
        <code>
ray.rllib.utils.schedules.constant_schedule.ConstantSchedule            (<span title="ray.rllib.utils.schedules.schedule.Schedule">Schedule</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>A Schedule where the value remains constant over time.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.utils.schedules.constant_schedule.ConstantSchedule.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">framework</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>value</code></td>
        <td><code>float</code></td>
        <td><p>The constant value to return, independently of time.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/schedules/constant_schedule.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">framework</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">        value (float): The constant value to return, independently of time.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">framework</span><span class="o">=</span><span class="n">framework</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_v</span> <span class="o">=</span> <span class="n">value</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.test_utils.check">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">test_utils</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Checks two structures (dict, tuple, list,
np.array, float, int, etc..) for (almost) numeric identity.
All numbers in the two structures have to match up to <code>decimal</code> digits
after the floating point. Uses assertions.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>x</code></td>
        <td><code>any</code></td>
        <td><p>The value to be compared (to the expectation: <code>y</code>). This
may be a Tensor.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>y</code></td>
        <td><code>any</code></td>
        <td><p>The expected value to be compared to <code>x</code>. This must not
be a tf-Tensor, but may be a tfe/torch-Tensor.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>decimals</code></td>
        <td><code>int</code></td>
        <td><p>The number of digits after the floating point up to
which all numeric values have to match.</p></td>
        <td><code>5</code></td>
      </tr>
      <tr>
        <td><code>atol</code></td>
        <td><code>float</code></td>
        <td><p>Absolute tolerance of the difference between x and y
(overrides <code>decimals</code> if given).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>rtol</code></td>
        <td><code>float</code></td>
        <td><p>Relative tolerance of the difference between x and y
(overrides <code>decimals</code> if given).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>false</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to check that x and y are NOT the same.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/test_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="sd">    Checks two structures (dict, tuple, list,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    np.array, float, int, etc..) for (almost) numeric identity.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    All numbers in the two structures have to match up to `decimal` digits</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    after the floating point. Uses assertions.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        x (any): The value to be compared (to the expectation: `y`). This</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">            may be a Tensor.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        y (any): The expected value to be compared to `x`. This must not</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            be a tf-Tensor, but may be a tfe/torch-Tensor.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        decimals (int): The number of digits after the floating point up to</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">            which all numeric values have to match.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        atol (float): Absolute tolerance of the difference between x and y</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            (overrides `decimals` if given).</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        rtol (float): Relative tolerance of the difference between x and y</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">            (overrides `decimals` if given).</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        false (bool): Whether to check that x and y are NOT the same.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="c1"># A dict type.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> \
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>            <span class="s2">&quot;ERROR: If x is dict, y needs to be a dict as well!&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="n">y_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="k">assert</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">y</span><span class="p">,</span> \
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>                <span class="s2">&quot;ERROR: y does not have x&#39;s key=&#39;</span><span class="si">{}</span><span class="s2">&#39;! y=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>            <span class="n">check</span><span class="p">(</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>                <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>                <span class="n">y</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>                <span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>                <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>                <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>                <span class="n">false</span><span class="o">=</span><span class="n">false</span><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="n">y_keys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="n">y_keys</span><span class="p">,</span> \
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="s2">&quot;ERROR: y contains keys (</span><span class="si">{}</span><span class="s2">) that are not in x! y=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span>\
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="nb">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_keys</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="c1"># A tuple type.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)),</span>\
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>            <span class="s2">&quot;ERROR: If x is tuple, y needs to be a tuple as well!&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>\
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>            <span class="s2">&quot;ERROR: y does not have the same length as x (</span><span class="si">{}</span><span class="s2"> vs </span><span class="si">{}</span><span class="s2">)!&quot;</span><span class="o">.</span>\
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>            <span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>            <span class="n">check</span><span class="p">(</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>                <span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>                <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>                <span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>                <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>                <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                <span class="n">false</span><span class="o">=</span><span class="n">false</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="c1"># Boolean comparison.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="k">if</span> <span class="n">false</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>            <span class="k">assert</span> <span class="nb">bool</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> \
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>                <span class="s2">&quot;ERROR: x (</span><span class="si">{}</span><span class="s2">) is y (</span><span class="si">{}</span><span class="s2">)!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="k">assert</span> <span class="nb">bool</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> \
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>                <span class="s2">&quot;ERROR: x (</span><span class="si">{}</span><span class="s2">) is not y (</span><span class="si">{}</span><span class="s2">)!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="c1"># Nones or primitives.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">elif</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="k">if</span> <span class="n">false</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>            <span class="k">assert</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;ERROR: x (</span><span class="si">{}</span><span class="s2">) is the same as y (</span><span class="si">{}</span><span class="s2">)!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="k">assert</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">,</span> \
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                <span class="s2">&quot;ERROR: x (</span><span class="si">{}</span><span class="s2">) is not the same as y (</span><span class="si">{}</span><span class="s2">)!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="c1"># String/byte comparisons.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;dtype&quot;</span><span class="p">)</span> <span class="ow">and</span> \
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">object</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&lt;U&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="k">if</span> <span class="n">false</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> \
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                    <span class="s2">&quot;ERROR: x (</span><span class="si">{}</span><span class="s2">) is the same as y (</span><span class="si">{}</span><span class="s2">)!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="k">if</span> <span class="n">false</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                <span class="k">raise</span> <span class="n">e</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="c1"># Everything else (assume numeric or tf/torch.Tensor).</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="k">if</span> <span class="n">tf1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="c1"># y should never be a Tensor (y=expected value).</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">tf1</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">tf1</span><span class="o">.</span><span class="n">Variable</span><span class="p">)):</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                <span class="c1"># In eager mode, numpyize tensors.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">executing_eagerly</span><span class="p">():</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                        <span class="s2">&quot;`y` (expected value) must not be a Tensor. &quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>                        <span class="s2">&quot;Use numpy.ndarray instead&quot;</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">tf1</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">tf1</span><span class="o">.</span><span class="n">Variable</span><span class="p">)):</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                <span class="c1"># In eager mode, numpyize tensors.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="k">if</span> <span class="n">tf1</span><span class="o">.</span><span class="n">executing_eagerly</span><span class="p">():</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="c1"># Otherwise, use a new tf-session.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                    <span class="k">with</span> <span class="n">tf1</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                        <span class="n">x</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                        <span class="k">return</span> <span class="n">check</span><span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                            <span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                            <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                            <span class="n">decimals</span><span class="o">=</span><span class="n">decimals</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                            <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                            <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                            <span class="n">false</span><span class="o">=</span><span class="n">false</span><span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">if</span> <span class="n">torch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="c1"># Using decimals.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="k">if</span> <span class="n">atol</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rtol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="c1"># Assert equality of both values.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="n">decimals</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="c1"># Both values are not equal.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                <span class="c1"># Raise error in normal case.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                <span class="k">if</span> <span class="n">false</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                    <span class="k">raise</span> <span class="n">e</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="c1"># Both values are equal.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>                <span class="c1"># If false is set -&gt; raise error (not expected to be equal).</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                <span class="k">if</span> <span class="n">false</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                    <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> \
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                        <span class="s2">&quot;ERROR: x (</span><span class="si">{}</span><span class="s2">) is the same as y (</span><span class="si">{}</span><span class="s2">)!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="c1"># Using atol/rtol.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="c1"># Provide defaults for either one of atol/rtol.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="k">if</span> <span class="n">atol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                <span class="n">atol</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="k">if</span> <span class="n">rtol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>                <span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-7</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                <span class="k">if</span> <span class="n">false</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                    <span class="k">raise</span> <span class="n">e</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                <span class="k">if</span> <span class="n">false</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                    <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> \
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                        <span class="s2">&quot;ERROR: x (</span><span class="si">{}</span><span class="s2">) is the same as y (</span><span class="si">{}</span><span class="s2">)!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.test_utils.check_compute_single_action">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">test_utils</span><span class="o">.</span><span class="n">check_compute_single_action</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">include_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_prev_action_reward</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Tests different combinations of args for trainer.compute_single_action.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>trainer</code></td>
        <td></td>
        <td><p>The Trainer object to test.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>include_state</code></td>
        <td></td>
        <td><p>Whether to include the initial state of the Policy's
Model in the <code>compute_single_action</code> call.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>include_prev_action_reward</code></td>
        <td></td>
        <td><p>Whether to include the prev-action and
-reward in the <code>compute_single_action</code> call.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If anything unexpected happens.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/test_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">check_compute_single_action</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>                                <span class="n">include_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                                <span class="n">include_prev_action_reward</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="sd">&quot;&quot;&quot;Tests different combinations of args for trainer.compute_single_action.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        trainer: The Trainer object to test.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        include_state: Whether to include the initial state of the Policy&#39;s</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">            Model in the `compute_single_action` call.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        include_prev_action_reward: Whether to include the prev-action and</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            -reward in the `compute_single_action` call.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        ValueError: If anything unexpected happens.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="c1"># Have to import this here to avoid circular dependency.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="kn">from</span> <span class="nn">ray.rllib.policy.sample_batch</span> <span class="kn">import</span> <span class="n">SampleBatch</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="c1"># Some Trainers may not abide to the standard API.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="n">pol</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">get_policy</span><span class="p">()</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="n">pol</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">policy</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="c1"># Get the policy&#39;s model.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">pol</span><span class="o">.</span><span class="n">model</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">action_space</span> <span class="o">=</span> <span class="n">pol</span><span class="o">.</span><span class="n">action_space</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="k">def</span> <span class="nf">_test</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">method_to_test</span><span class="p">,</span> <span class="n">obs_space</span><span class="p">,</span> <span class="n">full_fetch</span><span class="p">,</span> <span class="n">explore</span><span class="p">,</span> <span class="n">timestep</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>              <span class="n">unsquash</span><span class="p">,</span> <span class="n">clip</span><span class="p">):</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="n">call_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="k">if</span> <span class="n">what</span> <span class="ow">is</span> <span class="n">trainer</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>            <span class="n">call_kwargs</span><span class="p">[</span><span class="s2">&quot;full_fetch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_fetch</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">obs</span> <span class="o">=</span> <span class="n">obs_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obs_space</span><span class="p">,</span> <span class="n">Box</span><span class="p">):</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="n">state_in</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="k">if</span> <span class="n">include_state</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>            <span class="n">state_in</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_initial_state</span><span class="p">()</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">state_in</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>                <span class="n">state_in</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>                <span class="k">while</span> <span class="sa">f</span><span class="s2">&quot;state_in_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">view_requirements</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>                    <span class="n">state_in</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">view_requirements</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;state_in_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>                                    <span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="n">action_in</span> <span class="o">=</span> <span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span> \
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>            <span class="k">if</span> <span class="n">include_prev_action_reward</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="n">reward_in</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">include_prev_action_reward</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="k">if</span> <span class="n">method_to_test</span> <span class="o">==</span> <span class="s2">&quot;input_dict&quot;</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="k">assert</span> <span class="n">what</span> <span class="ow">is</span> <span class="n">pol</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>            <span class="n">input_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">SampleBatch</span><span class="o">.</span><span class="n">OBS</span><span class="p">:</span> <span class="n">obs</span><span class="p">}</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>            <span class="k">if</span> <span class="n">include_prev_action_reward</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="n">input_dict</span><span class="p">[</span><span class="n">SampleBatch</span><span class="o">.</span><span class="n">PREV_ACTIONS</span><span class="p">]</span> <span class="o">=</span> <span class="n">action_in</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>                <span class="n">input_dict</span><span class="p">[</span><span class="n">SampleBatch</span><span class="o">.</span><span class="n">PREV_REWARDS</span><span class="p">]</span> <span class="o">=</span> <span class="n">reward_in</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>            <span class="k">if</span> <span class="n">state_in</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">state_in</span><span class="p">):</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>                    <span class="n">input_dict</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;state_in_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="n">input_dict_batched</span> <span class="o">=</span> <span class="n">SampleBatch</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                <span class="n">tree</span><span class="o">.</span><span class="n">map_structure</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">input_dict</span><span class="p">))</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="n">action</span> <span class="o">=</span> <span class="n">pol</span><span class="o">.</span><span class="n">compute_actions_from_input_dict</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                <span class="n">input_dict</span><span class="o">=</span><span class="n">input_dict_batched</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                <span class="n">explore</span><span class="o">=</span><span class="n">explore</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                <span class="o">**</span><span class="n">call_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="c1"># Unbatch everything to be able to compare against single</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="c1"># action below.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>            <span class="c1"># ARS and ES return action batches as lists.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">action</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                <span class="n">action</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">action</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">action</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">action</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="n">action</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">map_structure</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">action</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                <span class="n">action2</span> <span class="o">=</span> <span class="n">pol</span><span class="o">.</span><span class="n">compute_single_action</span><span class="p">(</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                    <span class="n">input_dict</span><span class="o">=</span><span class="n">input_dict</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                    <span class="n">explore</span><span class="o">=</span><span class="n">explore</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                    <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>                    <span class="o">**</span><span class="n">call_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>                <span class="c1"># Make sure these are the same, unless we have exploration</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>                <span class="c1"># switched on (or noisy layers).</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">explore</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pol</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;noisy&quot;</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                    <span class="n">check</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">action2</span><span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="k">pass</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="n">action</span> <span class="o">=</span> <span class="n">what</span><span class="o">.</span><span class="n">compute_single_action</span><span class="p">(</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                <span class="n">obs</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                <span class="n">state_in</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>                <span class="n">prev_action</span><span class="o">=</span><span class="n">action_in</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                <span class="n">prev_reward</span><span class="o">=</span><span class="n">reward_in</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                <span class="n">explore</span><span class="o">=</span><span class="n">explore</span><span class="p">,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="n">timestep</span><span class="o">=</span><span class="n">timestep</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                <span class="n">unsquash_action</span><span class="o">=</span><span class="n">unsquash</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="n">clip_action</span><span class="o">=</span><span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                <span class="o">**</span><span class="n">call_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">state_out</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">if</span> <span class="n">state_in</span> <span class="ow">or</span> <span class="n">full_fetch</span> <span class="ow">or</span> <span class="n">what</span> <span class="ow">is</span> <span class="n">pol</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="n">action</span><span class="p">,</span> <span class="n">state_out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">action</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="k">if</span> <span class="n">state_out</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="k">for</span> <span class="n">si</span><span class="p">,</span> <span class="n">so</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">state_in</span><span class="p">,</span> <span class="n">state_out</span><span class="p">):</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="n">check</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">so</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="c1"># Test whether unsquash/clipping works on the Trainer&#39;s</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="c1"># compute_single_action method: Both flags should force the action</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="c1"># to be within the space&#39;s bounds.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="k">if</span> <span class="n">method_to_test</span> <span class="o">==</span> <span class="s2">&quot;single&quot;</span> <span class="ow">and</span> <span class="n">what</span> <span class="o">==</span> <span class="n">trainer</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">action_space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="ow">and</span> \
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                    <span class="p">(</span><span class="n">clip</span> <span class="ow">or</span> <span class="n">unsquash</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">action_space</span><span class="p">,</span> <span class="n">Box</span><span class="p">)):</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                    <span class="sa">f</span><span class="s2">&quot;Returned action (</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">) of trainer/policy </span><span class="si">{</span><span class="n">what</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                    <span class="sa">f</span><span class="s2">&quot;not in Env&#39;s action_space </span><span class="si">{</span><span class="n">action_space</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="c1"># We are operating in normalized space: Expect only smaller action</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="c1"># values.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">action_space</span><span class="p">,</span> <span class="n">Box</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">unsquash</span> <span class="ow">and</span> \
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                    <span class="n">what</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;normalize_actions&quot;</span><span class="p">)</span> <span class="ow">and</span> \
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                    <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">3.0</span><span class="p">):</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                    <span class="sa">f</span><span class="s2">&quot;Returned action (</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">) of trainer/policy </span><span class="si">{</span><span class="n">what</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                    <span class="s2">&quot;should be in normalized space, but seems too large/small &quot;</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>                    <span class="s2">&quot;for that!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="c1"># Loop through: Policy vs Trainer; Different API methods to calculate</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="c1"># actions; unsquash option; clip option; full fetch or not.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">for</span> <span class="n">what</span> <span class="ow">in</span> <span class="p">[</span><span class="n">pol</span><span class="p">,</span> <span class="n">trainer</span><span class="p">]:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">if</span> <span class="n">what</span> <span class="ow">is</span> <span class="n">trainer</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="c1"># Get the obs-space from Workers.env (not Policy) due to possible</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="c1"># pre-processor up front.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="n">worker_set</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="s2">&quot;workers&quot;</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="c1"># TODO: ES and ARS use `self._workers` instead of `self.workers` to</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="c1">#  store their rollout worker set. Change to `self.workers`.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="k">if</span> <span class="n">worker_set</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                <span class="n">worker_set</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="s2">&quot;_workers&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="k">assert</span> <span class="n">worker_set</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">worker_set</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="n">obs_space</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">get_policy</span><span class="p">()</span><span class="o">.</span><span class="n">observation_space</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                <span class="n">obs_space</span> <span class="o">=</span> <span class="n">worker_set</span><span class="o">.</span><span class="n">local_worker</span><span class="p">()</span><span class="o">.</span><span class="n">for_policy</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                    <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">observation_space</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="n">obs_space</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obs_space</span><span class="p">,</span> <span class="s2">&quot;original_space&quot;</span><span class="p">,</span> <span class="n">obs_space</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="n">obs_space</span> <span class="o">=</span> <span class="n">pol</span><span class="o">.</span><span class="n">observation_space</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">for</span> <span class="n">method_to_test</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;single&quot;</span><span class="p">]</span> <span class="o">+</span> \
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>                <span class="p">([</span><span class="s2">&quot;input_dict&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">what</span> <span class="ow">is</span> <span class="n">pol</span> <span class="k">else</span> <span class="p">[]):</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="k">for</span> <span class="n">explore</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                <span class="k">for</span> <span class="n">full_fetch</span> <span class="ow">in</span> <span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>                                   <span class="k">if</span> <span class="n">what</span> <span class="ow">is</span> <span class="n">trainer</span> <span class="k">else</span> <span class="p">[</span><span class="kc">False</span><span class="p">]):</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>                    <span class="n">timestep</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                    <span class="k">for</span> <span class="n">unsquash</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>                        <span class="k">for</span> <span class="n">clip</span> <span class="ow">in</span> <span class="p">([</span><span class="kc">False</span><span class="p">]</span> <span class="k">if</span> <span class="n">unsquash</span> <span class="k">else</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]):</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                            <span class="n">_test</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">method_to_test</span><span class="p">,</span> <span class="n">obs_space</span><span class="p">,</span> <span class="n">full_fetch</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                                  <span class="n">explore</span><span class="p">,</span> <span class="n">timestep</span><span class="p">,</span> <span class="n">unsquash</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.test_utils.check_train_results">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">test_utils</span><span class="o">.</span><span class="n">check_train_results</span><span class="p">(</span><span class="n">train_results</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Checks proper structure of a Trainer.train() returned dict.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>train_results</code></td>
        <td></td>
        <td><p>The train results dict to check.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>AssertionError</code></td>
        <td><p>If <code>train_results</code> doesn't have the proper structure or
data in it.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/test_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">check_train_results</span><span class="p">(</span><span class="n">train_results</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Checks proper structure of a Trainer.train() returned dict.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">        train_results: The train results dict to check.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        AssertionError: If `train_results` doesn&#39;t have the proper structure or</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">            data in it.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="c1"># Import these here to avoid circular dependencies.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="kn">from</span> <span class="nn">ray.rllib.policy.sample_batch</span> <span class="kn">import</span> <span class="n">DEFAULT_POLICY_ID</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="kn">from</span> <span class="nn">ray.rllib.utils.metrics.learner_info</span> <span class="kn">import</span> <span class="n">LEARNER_INFO</span><span class="p">,</span> \
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="n">LEARNER_STATS_KEY</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="kn">from</span> <span class="nn">ray.rllib.utils.multi_agent</span> <span class="kn">import</span> <span class="n">check_multi_agent</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="c1"># Assert that some keys are where we would expect them.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>            <span class="s2">&quot;agent_timesteps_total&quot;</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>            <span class="s2">&quot;config&quot;</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>            <span class="s2">&quot;custom_metrics&quot;</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>            <span class="s2">&quot;episode_len_mean&quot;</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>            <span class="s2">&quot;episode_reward_max&quot;</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>            <span class="s2">&quot;episode_reward_mean&quot;</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>            <span class="s2">&quot;episode_reward_min&quot;</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>            <span class="s2">&quot;episodes_total&quot;</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="s2">&quot;hist_stats&quot;</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>            <span class="s2">&quot;info&quot;</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>            <span class="s2">&quot;iterations_since_restore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>            <span class="s2">&quot;num_healthy_workers&quot;</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>            <span class="s2">&quot;perf&quot;</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>            <span class="s2">&quot;policy_reward_max&quot;</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>            <span class="s2">&quot;policy_reward_mean&quot;</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>            <span class="s2">&quot;policy_reward_min&quot;</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>            <span class="s2">&quot;sampler_perf&quot;</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="s2">&quot;time_since_restore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="s2">&quot;time_this_iter_s&quot;</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="s2">&quot;timesteps_since_restore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="s2">&quot;timesteps_total&quot;</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>            <span class="s2">&quot;timers&quot;</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="s2">&quot;time_total_s&quot;</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="s2">&quot;training_iteration&quot;</span><span class="p">,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="p">]:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="k">assert</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">train_results</span><span class="p">,</span> \
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; not found in `train_results` (</span><span class="si">{</span><span class="n">train_results</span><span class="si">}</span><span class="s2">)!&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">_</span><span class="p">,</span> <span class="n">is_multi_agent</span> <span class="o">=</span> <span class="n">check_multi_agent</span><span class="p">(</span><span class="n">train_results</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">])</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="c1"># Check in particular the &quot;info&quot; dict.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">info</span> <span class="o">=</span> <span class="n">train_results</span><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">]</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="k">assert</span> <span class="n">LEARNER_INFO</span> <span class="ow">in</span> <span class="n">info</span><span class="p">,</span> \
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="sa">f</span><span class="s2">&quot;&#39;learner&#39; not in train_results[&#39;infos&#39;] (</span><span class="si">{</span><span class="n">info</span><span class="si">}</span><span class="s2">)!&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">assert</span> <span class="s2">&quot;num_steps_trained&quot;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">,</span>\
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="sa">f</span><span class="s2">&quot;&#39;num_steps_trained&#39; not in train_results[&#39;infos&#39;] (</span><span class="si">{</span><span class="n">info</span><span class="si">}</span><span class="s2">)!&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">learner_info</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="n">LEARNER_INFO</span><span class="p">]</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="c1"># Make sure we have a default_policy key if we are not in a</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="c1"># multi-agent setup.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_multi_agent</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="c1"># APEX algos sometimes have an empty learner info dict (no metrics</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="c1"># collected yet).</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">learner_info</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">DEFAULT_POLICY_ID</span> <span class="ow">in</span> <span class="n">learner_info</span><span class="p">,</span> \
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">DEFAULT_POLICY_ID</span><span class="si">}</span><span class="s2">&#39; not found in &quot;</span> \
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="sa">f</span><span class="s2">&quot;train_results[&#39;infos&#39;][&#39;learner&#39;] (</span><span class="si">{</span><span class="n">learner_info</span><span class="si">}</span><span class="s2">)!&quot;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">for</span> <span class="n">pid</span><span class="p">,</span> <span class="n">policy_stats</span> <span class="ow">in</span> <span class="n">learner_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="k">if</span> <span class="n">pid</span> <span class="o">==</span> <span class="s2">&quot;batch_count&quot;</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="k">continue</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="c1"># Expect td-errors to be per batch-item.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="k">if</span> <span class="s2">&quot;td_error&quot;</span> <span class="ow">in</span> <span class="n">policy_stats</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="n">configured_b</span> <span class="o">=</span> <span class="n">train_results</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">][</span><span class="s2">&quot;train_batch_size&quot;</span><span class="p">]</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>            <span class="n">actual_b</span> <span class="o">=</span> <span class="n">policy_stats</span><span class="p">[</span><span class="s2">&quot;td_error&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="c1"># R2D2 case.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">configured_b</span> <span class="o">-</span> <span class="n">actual_b</span><span class="p">)</span> <span class="o">/</span> <span class="n">actual_b</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                <span class="k">assert</span> <span class="n">configured_b</span> <span class="o">/</span> <span class="p">(</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                    <span class="n">train_results</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">][</span><span class="s2">&quot;model&quot;</span><span class="p">][</span><span class="s2">&quot;max_seq_len&quot;</span><span class="p">]</span> <span class="o">+</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                    <span class="n">train_results</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">][</span><span class="s2">&quot;burn_in&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="n">actual_b</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="c1"># Make sure each policy has the LEARNER_STATS_KEY under it.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="k">assert</span> <span class="n">LEARNER_STATS_KEY</span> <span class="ow">in</span> <span class="n">policy_stats</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">learner_stats</span> <span class="o">=</span> <span class="n">policy_stats</span><span class="p">[</span><span class="n">LEARNER_STATS_KEY</span><span class="p">]</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">learner_stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="c1"># Min- and max-stats should be single values.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;min_&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;max_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                    <span class="n">value</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;&#39;key&#39; value not a scalar (</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">)!&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">return</span> <span class="n">train_results</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.test_utils.framework_iterator">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">test_utils</span><span class="o">.</span><span class="n">framework_iterator</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frameworks</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;tf2&#39;</span><span class="p">,</span> <span class="s1">&#39;tf&#39;</span><span class="p">,</span> <span class="s1">&#39;tfe&#39;</span><span class="p">,</span> <span class="s1">&#39;torch&#39;</span><span class="p">),</span> <span class="n">session</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_eager_tracing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">time_iterations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>An generator that allows for looping through n frameworks for testing.</p>
<p>Provides the correct config entries ("framework") as well
as the correct eager/non-eager contexts for tfe/tf.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>config</code></td>
        <td><code>Optional[dict]</code></td>
        <td><p>An optional config dict to alter in place depending on the
iteration.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>frameworks</code></td>
        <td><code>Sequence[str]</code></td>
        <td><p>A list/tuple of the frameworks to be tested.
Allowed are: "tf2", "tf", "tfe", "torch", and None.</p></td>
        <td><code>(&#39;tf2&#39;, &#39;tf&#39;, &#39;tfe&#39;, &#39;torch&#39;)</code></td>
      </tr>
      <tr>
        <td><code>session</code></td>
        <td><code>bool</code></td>
        <td><p>If True and only in the tf-case: Enter a tf.Session()
and yield that as second return value (otherwise yield (fw, None)).
Also sets a seed (42) on the session to make the test
deterministic.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>with_eager_tracing</code></td>
        <td><code>bool</code></td>
        <td><p>Include <code>eager_tracing=True</code> in the returned
configs, when framework=[tfe|tf2].</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>time_iterations</code></td>
        <td><code>Optional[dict]</code></td>
        <td><p>If provided, will write to the given dict (by
framework key) the times in seconds that each (framework's)
iteration takes.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>      <p>!!! yields
    If <code>session</code> is False: The current framework [tf2|tf|tfe|torch] used.
    If <code>session</code> is True: A tuple consisting of the current framework
    string and the tf1.Session (if fw="tf", otherwise None).</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/test_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">framework_iterator</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>        <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PartialTrainerConfigDict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="n">frameworks</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;tf2&quot;</span><span class="p">,</span> <span class="s2">&quot;tf&quot;</span><span class="p">,</span> <span class="s2">&quot;tfe&quot;</span><span class="p">,</span> <span class="s2">&quot;torch&quot;</span><span class="p">),</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">session</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">with_eager_tracing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="n">time_iterations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;tf1.Session&quot;</span><span class="p">]]]:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="sd">&quot;&quot;&quot;An generator that allows for looping through n frameworks for testing.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Provides the correct config entries (&quot;framework&quot;) as well</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    as the correct eager/non-eager contexts for tfe/tf.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        config: An optional config dict to alter in place depending on the</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            iteration.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        frameworks: A list/tuple of the frameworks to be tested.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">            Allowed are: &quot;tf2&quot;, &quot;tf&quot;, &quot;tfe&quot;, &quot;torch&quot;, and None.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        session: If True and only in the tf-case: Enter a tf.Session()</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            and yield that as second return value (otherwise yield (fw, None)).</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">            Also sets a seed (42) on the session to make the test</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">            deterministic.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        with_eager_tracing: Include `eager_tracing=True` in the returned</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">            configs, when framework=[tfe|tf2].</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        time_iterations: If provided, will write to the given dict (by</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">            framework key) the times in seconds that each (framework&#39;s)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            iteration takes.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        If `session` is False: The current framework [tf2|tf|tfe|torch] used.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        If `session` is True: A tuple consisting of the current framework</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        string and the tf1.Session (if fw=&quot;tf&quot;, otherwise None).</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">config</span> <span class="o">=</span> <span class="n">config</span> <span class="ow">or</span> <span class="p">{}</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">frameworks</span> <span class="o">=</span> <span class="p">[</span><span class="n">frameworks</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frameworks</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> \
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="nb">list</span><span class="p">(</span><span class="n">frameworks</span><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="c1"># Both tf2 and tfe present -&gt; remove &quot;tfe&quot; or &quot;tf2&quot; depending on version.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="k">if</span> <span class="s2">&quot;tf2&quot;</span> <span class="ow">in</span> <span class="n">frameworks</span> <span class="ow">and</span> <span class="s2">&quot;tfe&quot;</span> <span class="ow">in</span> <span class="n">frameworks</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="n">frameworks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;tfe&quot;</span> <span class="k">if</span> <span class="n">tfv</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="s2">&quot;tf2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">for</span> <span class="n">fw</span> <span class="ow">in</span> <span class="n">frameworks</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="c1"># Skip non-installed frameworks.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="k">if</span> <span class="n">fw</span> <span class="o">==</span> <span class="s2">&quot;torch&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">torch</span><span class="p">:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>                <span class="s2">&quot;framework_iterator skipping torch (not installed)!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>            <span class="k">continue</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="k">if</span> <span class="n">fw</span> <span class="o">!=</span> <span class="s2">&quot;torch&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">tf</span><span class="p">:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;framework_iterator skipping </span><span class="si">{}</span><span class="s2"> (tf not &quot;</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>                           <span class="s2">&quot;installed)!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fw</span><span class="p">))</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="k">continue</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="k">elif</span> <span class="n">fw</span> <span class="o">==</span> <span class="s2">&quot;tfe&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">eager_mode</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;framework_iterator skipping tf-eager (could not &quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>                           <span class="s2">&quot;import `eager_mode` from tensorflow.python)!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>            <span class="k">continue</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="k">elif</span> <span class="n">fw</span> <span class="o">==</span> <span class="s2">&quot;tf2&quot;</span> <span class="ow">and</span> <span class="n">tfv</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="s2">&quot;framework_iterator skipping tf2.x (tf version is &lt; 2.0)!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>            <span class="k">continue</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="k">elif</span> <span class="n">fw</span> <span class="o">==</span> <span class="s2">&quot;jax&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">jax</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;framework_iterator skipping JAX (not installed)!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="k">continue</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="k">assert</span> <span class="n">fw</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;tf2&quot;</span><span class="p">,</span> <span class="s2">&quot;tf&quot;</span><span class="p">,</span> <span class="s2">&quot;tfe&quot;</span><span class="p">,</span> <span class="s2">&quot;torch&quot;</span><span class="p">,</span> <span class="s2">&quot;jax&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="c1"># Do we need a test session?</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">sess</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="k">if</span> <span class="n">fw</span> <span class="o">==</span> <span class="s2">&quot;tf&quot;</span> <span class="ow">and</span> <span class="n">session</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>            <span class="n">sess</span> <span class="o">=</span> <span class="n">tf1</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="n">sess</span><span class="o">.</span><span class="fm">__enter__</span><span class="p">()</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="n">tf1</span><span class="o">.</span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;framework&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fw</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">eager_ctx</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="c1"># Enable eager mode for tf2 and tfe.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="k">if</span> <span class="n">fw</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;tf2&quot;</span><span class="p">,</span> <span class="s2">&quot;tfe&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="n">eager_ctx</span> <span class="o">=</span> <span class="n">eager_mode</span><span class="p">()</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="n">eager_ctx</span><span class="o">.</span><span class="fm">__enter__</span><span class="p">()</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="k">assert</span> <span class="n">tf1</span><span class="o">.</span><span class="n">executing_eagerly</span><span class="p">()</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="c1"># Make sure, eager mode is off.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="k">elif</span> <span class="n">fw</span> <span class="o">==</span> <span class="s2">&quot;tf&quot;</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="k">assert</span> <span class="ow">not</span> <span class="n">tf1</span><span class="o">.</span><span class="n">executing_eagerly</span><span class="p">()</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="c1"># Additionally loop through eager_tracing=True + False, if necessary.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="k">if</span> <span class="n">fw</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;tf2&quot;</span><span class="p">,</span> <span class="s2">&quot;tfe&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">with_eager_tracing</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="k">for</span> <span class="n">tracing</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                <span class="n">config</span><span class="p">[</span><span class="s2">&quot;eager_tracing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tracing</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;framework=</span><span class="si">{</span><span class="n">fw</span><span class="si">}</span><span class="s2"> (eager-tracing=</span><span class="si">{</span><span class="n">tracing</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                <span class="n">time_started</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="k">yield</span> <span class="n">fw</span> <span class="k">if</span> <span class="n">session</span> <span class="ow">is</span> <span class="kc">False</span> <span class="k">else</span> <span class="p">(</span><span class="n">fw</span><span class="p">,</span> <span class="n">sess</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                <span class="k">if</span> <span class="n">time_iterations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                    <span class="n">time_total</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_started</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>                    <span class="n">time_iterations</span><span class="p">[</span><span class="n">fw</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;+tracing&quot;</span> <span class="k">if</span> <span class="n">tracing</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)]</span> <span class="o">=</span> \
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                        <span class="n">time_total</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;.. took </span><span class="si">{</span><span class="n">time_total</span><span class="si">}</span><span class="s2">sec&quot;</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="n">config</span><span class="p">[</span><span class="s2">&quot;eager_tracing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="c1"># Yield current framework + tf-session (if necessary).</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;framework=</span><span class="si">{</span><span class="n">fw</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="n">time_started</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="k">yield</span> <span class="n">fw</span> <span class="k">if</span> <span class="n">session</span> <span class="ow">is</span> <span class="kc">False</span> <span class="k">else</span> <span class="p">(</span><span class="n">fw</span><span class="p">,</span> <span class="n">sess</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="k">if</span> <span class="n">time_iterations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                <span class="n">time_total</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_started</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="n">time_iterations</span><span class="p">[</span><span class="n">fw</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;+tracing&quot;</span> <span class="k">if</span> <span class="n">tracing</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)]</span> <span class="o">=</span> \
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                    <span class="n">time_total</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;.. took </span><span class="si">{</span><span class="n">time_total</span><span class="si">}</span><span class="s2">sec&quot;</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="c1"># Exit any context we may have entered.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">if</span> <span class="n">eager_ctx</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="n">eager_ctx</span><span class="o">.</span><span class="fm">__exit__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="k">elif</span> <span class="n">sess</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="n">sess</span><span class="o">.</span><span class="fm">__exit__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.util.ml_utils.dict.merge_dicts">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">ml_utils</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>d1</code></td>
        <td><code>dict</code></td>
        <td><p>Dict 1.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>d2</code></td>
        <td><code>dict</code></td>
        <td><p>Dict 2.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>dict</code></td>
      <td><p>A new dict that is d1 and d2 deep merged.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/util/ml_utils/dict.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">merge_dicts</span><span class="p">(</span><span class="n">d1</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">d2</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">        d1 (dict): Dict 1.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">        d2 (dict): Dict 2.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">         dict: A new dict that is d1 and d2 deep merged.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">merged</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">deep_update</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="k">return</span> <span class="n">merged</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.util.ml_utils.dict.deep_update">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">ml_utils</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">deep_update</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">new_dict</span><span class="p">,</span> <span class="n">new_keys_allowed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_new_subkey_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">override_all_if_type_changes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Updates original dict with values from new_dict recursively.</p>
<p>If new key is introduced in new_dict, then if new_keys_allowed is not
True, an error will be thrown. Further, for sub-dicts, if the key is
in the allow_new_subkey_list, then new subkeys can be introduced.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>original</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary with default values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>new_dict</code></td>
        <td><code>dict</code></td>
        <td><p>Dictionary with values to be updated</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>new_keys_allowed</code></td>
        <td><code>bool</code></td>
        <td><p>Whether new keys are allowed.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>allow_new_subkey_list</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>List of keys that
correspond to dict values where new subkeys can be introduced.
This is only at the top level.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>override_all_if_type_changes(Optional[List[str]])</code></td>
        <td></td>
        <td><p>List of top level
keys with value=dict, for which we always simply override the
entire value (dict), iff the "type" key in that value dict changes.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/util/ml_utils/dict.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">deep_update</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>        <span class="n">original</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="n">new_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">new_keys_allowed</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">allow_new_subkey_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="n">override_all_if_type_changes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="sd">&quot;&quot;&quot;Updates original dict with values from new_dict recursively.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    If new key is introduced in new_dict, then if new_keys_allowed is not</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    True, an error will be thrown. Further, for sub-dicts, if the key is</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    in the allow_new_subkey_list, then new subkeys can be introduced.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        original (dict): Dictionary with default values.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        new_dict (dict): Dictionary with values to be updated</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        new_keys_allowed (bool): Whether new keys are allowed.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        allow_new_subkey_list (Optional[List[str]]): List of keys that</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">            correspond to dict values where new subkeys can be introduced.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            This is only at the top level.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        override_all_if_type_changes(Optional[List[str]]): List of top level</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">            keys with value=dict, for which we always simply override the</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">            entire value (dict), iff the &quot;type&quot; key in that value dict changes.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">allow_new_subkey_list</span> <span class="o">=</span> <span class="n">allow_new_subkey_list</span> <span class="ow">or</span> <span class="p">[]</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">override_all_if_type_changes</span> <span class="o">=</span> <span class="n">override_all_if_type_changes</span> <span class="ow">or</span> <span class="p">[]</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">original</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">new_keys_allowed</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown config parameter `</span><span class="si">{}</span><span class="s2">` &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="c1"># Both orginal value and new one are dicts.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>            <span class="c1"># Check old type vs old one. If different, override entire value.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">override_all_if_type_changes</span> <span class="ow">and</span> \
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>                <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="ow">and</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">original</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">and</span> \
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>                    <span class="n">value</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">original</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>                <span class="n">original</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="c1"># Allowed key -&gt; ok to add new subkeys.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">allow_new_subkey_list</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                <span class="n">deep_update</span><span class="p">(</span><span class="n">original</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">value</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="c1"># Non-allowed key.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>                <span class="n">deep_update</span><span class="p">(</span><span class="n">original</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">value</span><span class="p">,</span> <span class="n">new_keys_allowed</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="c1"># Original value not a dict OR new value not a dict:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="c1"># Override entire value.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="n">original</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="k">return</span> <span class="n">original</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.add_mixins">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">add_mixins</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">mixins</span><span class="p">,</span> <span class="nb">reversed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Returns a new class with mixins applied in priority order.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">add_mixins</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">mixins</span><span class="p">,</span> <span class="nb">reversed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Returns a new class with mixins applied in priority order.&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="n">mixins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mixins</span> <span class="ow">or</span> <span class="p">[])</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="k">while</span> <span class="n">mixins</span><span class="p">:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="k">if</span> <span class="nb">reversed</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>            <span class="k">class</span> <span class="nc">new_base</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">mixins</span><span class="o">.</span><span class="n">pop</span><span class="p">()):</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>                <span class="k">pass</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>            <span class="k">class</span> <span class="nc">new_base</span><span class="p">(</span><span class="n">mixins</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span> <span class="n">base</span><span class="p">):</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>                <span class="k">pass</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">new_base</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="k">return</span> <span class="n">base</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.utils.force_list">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">force_list</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_tuple</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Makes sure <code>elements</code> is returned as a list, whether <code>elements</code> is a single
item, already a list, or a tuple.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>elements</code></td>
        <td><code>Optional[any]</code></td>
        <td><p>The inputs as single item, list, or tuple to
be converted into a list/tuple. If None, returns empty list/tuple.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>to_tuple</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use tuple (instead of list).</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Union[list,tuple]</code></td>
      <td><p>All given elements in a list/tuple depending on
    <code>to_tuple</code>'s value. If elements is None,
    returns an empty list/tuple.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/utils/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">force_list</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_tuple</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="sd">    Makes sure `elements` is returned as a list, whether `elements` is a single</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    item, already a list, or a tuple.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        elements (Optional[any]): The inputs as single item, list, or tuple to</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">            be converted into a list/tuple. If None, returns empty list/tuple.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        to_tuple (bool): Whether to use tuple (instead of list).</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        Union[list,tuple]: All given elements in a list/tuple depending on</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            `to_tuple`&#39;s value. If elements is None,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">            returns an empty list/tuple.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">ctor</span> <span class="o">=</span> <span class="nb">list</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">if</span> <span class="n">to_tuple</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="n">ctor</span> <span class="o">=</span> <span class="nb">tuple</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="k">return</span> <span class="n">ctor</span><span class="p">()</span> <span class="k">if</span> <span class="n">elements</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ctor</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> \
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="k">else</span> <span class="n">ctor</span><span class="p">([</span><span class="n">elements</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h2 class="doc doc-heading" id="ray.rllib.utils.force_tuple">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">force_tuple</span></code>


</h2>

    <div class="doc doc-contents first">

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../execution/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Execution" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Execution
            </div>
          </div>
        </a>
      
      
        
        <a href="../../ray-core/" class="md-footer__link md-footer__link--next" aria-label="Next: Ray Core" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Ray Core
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Anyscale, Inc 2021
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://twitter.com/raydistributed" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/ray-project/ray" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://ray.io" target="_blank" rel="noopener" title="ray.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.indexes", "content.tabs.link", "navigation.tracking", "navigation.instant", "navigation.top", "content.code.annotate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.0bbba5b5.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
        <script src="../../../js/termynal.js"></script>
      
        <script src="../../../js/custom.js"></script>
      
    
  </body>
</html>