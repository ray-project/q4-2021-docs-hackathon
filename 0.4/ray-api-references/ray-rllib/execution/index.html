
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.3">
    
    
      
        <title>Execution - Ray</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/termynal.css">
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#execution-package" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://ray.io" title="Ray" class="md-header__button md-logo" aria-label="Ray" data-md-component="logo">
      
  <img src="../../../images/ray-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ray
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Execution
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ray-project/ray" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ray-project/ray
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-deployment/" class="md-tabs__link">
        Deploying Ray
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-ecosystem/" class="md-tabs__link">
        Ecosystem
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-examples/" class="md-tabs__link">
        Examples
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link md-tabs__link--active">
        API
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-contributor-guide/" class="md-tabs__link">
        Contribute
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ray.io" title="Ray" class="md-nav__button md-logo" aria-label="Ray" data-md-component="logo">
      
  <img src="../../../images/ray-logo.png" alt="logo">

    </a>
    Ray
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ray-project/ray" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ray-project/ray
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../..">Getting Started</a>
          
            <label for="__nav_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-overview/what-and-why-ray/" class="md-nav__link">
        Why Ray?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-overview/more-information/" class="md-nav__link">
        Learn more
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-core/">Ray Core</a>
          
            <label for="__nav_1_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Core" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          Ray Core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-core/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-core/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-data/">Ray Data</a>
          
            <label for="__nav_1_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Data" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          Ray Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-data/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5_3" type="checkbox" id="__nav_1_5_3" >
      
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-data/tutorials/">Tutorials</a>
          
        </div>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_5_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-train/">Ray Train</a>
          
            <label for="__nav_1_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Train" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Ray Train
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-train/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-train/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7" type="checkbox" id="__nav_1_7" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-rllib/">Ray RLlib</a>
          
            <label for="__nav_1_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray RLlib" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_7">
          <span class="md-nav__icon md-icon"></span>
          Ray RLlib
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-rllib/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-rllib/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_8" type="checkbox" id="__nav_1_8" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-tune/">Ray Tune</a>
          
            <label for="__nav_1_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Tune" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_8">
          <span class="md-nav__icon md-icon"></span>
          Ray Tune
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-tune/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-tune/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_9" type="checkbox" id="__nav_1_9" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-serve/">Ray Serve</a>
          
            <label for="__nav_1_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Serve" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_9">
          <span class="md-nav__icon md-icon"></span>
          Ray Serve
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-serve/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_9_3" type="checkbox" id="__nav_1_9_3" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-serve/tutorials/">Tutorials</a>
          
            <label for="__nav_1_9_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_9_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-serve/tutorials/model-composition/" class="md-nav__link">
        Model composition
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_10" type="checkbox" id="__nav_1_10" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-workflows/">Ray Workflows</a>
          
            <label for="__nav_1_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Workflows" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_10">
          <span class="md-nav__icon md-icon"></span>
          Ray Workflows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-workflows/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-workflows/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-deployment/">Deploying Ray</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Deploying Ray" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Deploying Ray
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-deployment/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-deployment/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ecosystem/">Ecosystem</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ecosystem" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Ecosystem
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ecosystem/integrations/integrations/" class="md-nav__link">
        Integrations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ecosystem/integrations/joblib/" class="md-nav__link">
        Joblib
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-examples/">Examples</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Crash Course
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Crash Course" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Crash Course
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/00-Ray-Crash-Course-Overview/" class="md-nav__link">
        Ray "Crash Course" Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/01-Ray-Tasks/" class="md-nav__link">
        Ray Crash Course - Tasks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/02-Ray-Actors/" class="md-nav__link">
        Ray Crash Course - Actors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/03-Why-Ray/" class="md-nav__link">
        Ray Crash Course - Why Ray?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/04-Ray-Multiprocessing/" class="md-nav__link">
        Ray Crash Course - Python Multiprocessing with Ray
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/05-Ray-Parallel-Iterators/" class="md-nav__link">
        Ray Crash Course - Ray Parallel Iterators (Now deprecated in Ray 1.7)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/06-Exploring-Ray-API-Calls/" class="md-nav__link">
        Ray Crash Course - Exploring Ray API Calls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/07-Running-Ray-Clusters/" class="md-nav__link">
        Ray Crash Course - Ray Clusters and the Ray CLI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../">API</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Ray RLlib</a>
          
            <label for="__nav_5_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray RLlib" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Ray RLlib
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../agents/" class="md-nav__link">
        Agents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../policy/" class="md-nav__link">
        Policies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../env/" class="md-nav__link">
        Environments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation/" class="md-nav__link">
        Evaluation
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Execution
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Execution
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.concurrency_ops.Concurrently" class="md-nav__link">
    Concurrently()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.concurrency_ops.Enqueue" class="md-nav__link">
    Enqueue
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.concurrency_ops.Dequeue" class="md-nav__link">
    Dequeue()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.learner_thread.LearnerThread" class="md-nav__link">
    LearnerThread
  </a>
  
    <nav class="md-nav" aria-label="LearnerThread">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.learner_thread.LearnerThread.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.learner_thread.LearnerThread.add_learner_metrics" class="md-nav__link">
    add_learner_metrics()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.learner_thread.LearnerThread.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.metric_ops.StandardMetricsReporting" class="md-nav__link">
    StandardMetricsReporting()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.metric_ops.CollectMetrics" class="md-nav__link">
    CollectMetrics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.metric_ops.OncePerTimeInterval" class="md-nav__link">
    OncePerTimeInterval
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.metric_ops.OncePerTimestepsElapsed" class="md-nav__link">
    OncePerTimestepsElapsed
  </a>
  
    <nav class="md-nav" aria-label="OncePerTimestepsElapsed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.metric_ops.OncePerTimestepsElapsed.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.multi_gpu_learner_thread.MultiGPULearnerThread" class="md-nav__link">
    MultiGPULearnerThread
  </a>
  
    <nav class="md-nav" aria-label="MultiGPULearnerThread">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.multi_gpu_learner_thread.MultiGPULearnerThread.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.StoreToReplayBuffer" class="md-nav__link">
    StoreToReplayBuffer
  </a>
  
    <nav class="md-nav" aria-label="StoreToReplayBuffer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.StoreToReplayBuffer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.Replay" class="md-nav__link">
    Replay()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.SimpleReplayBuffer" class="md-nav__link">
    SimpleReplayBuffer
  </a>
  
    <nav class="md-nav" aria-label="SimpleReplayBuffer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.SimpleReplayBuffer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.MixInReplay" class="md-nav__link">
    MixInReplay
  </a>
  
    <nav class="md-nav" aria-label="MixInReplay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.MixInReplay.__init__" class="md-nav__link">
    __init__()
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.MixInReplay.__init__--replay-proportion-21" class="md-nav__link">
    replay proportion 2:1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.MixInReplay.__init__--replay-proportion-01-replay-disabled" class="md-nav__link">
    replay proportion 0:1, replay disabled
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.rollout_ops.ParallelRollouts" class="md-nav__link">
    ParallelRollouts()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.rollout_ops.AsyncGradients" class="md-nav__link">
    AsyncGradients()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.rollout_ops.ConcatBatches" class="md-nav__link">
    ConcatBatches
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.rollout_ops.SelectExperiences" class="md-nav__link">
    SelectExperiences
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.rollout_ops.StandardizeFields" class="md-nav__link">
    StandardizeFields
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.TrainOneStep" class="md-nav__link">
    TrainOneStep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.MultiGPUTrainOneStep" class="md-nav__link">
    MultiGPUTrainOneStep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.ComputeGradients" class="md-nav__link">
    ComputeGradients
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.ApplyGradients" class="md-nav__link">
    ApplyGradients
  </a>
  
    <nav class="md-nav" aria-label="ApplyGradients">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.ApplyGradients.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.AverageGradients" class="md-nav__link">
    AverageGradients
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.UpdateTargetNetwork" class="md-nav__link">
    UpdateTargetNetwork
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Utility
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-core/" class="md-nav__link">
        Ray Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-data/" class="md-nav__link">
        Ray Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-train/" class="md-nav__link">
        Ray Train
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-tune/" class="md-nav__link">
        Ray Tune
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-workflows/" class="md-nav__link">
        Ray Workflows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-serve/" class="md-nav__link">
        Ray Serve
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-contributor-guide/">Contribute</a>
          
            <label for="__nav_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Contribute" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Contribute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-contributor-guide/getting-involved/" class="md-nav__link">
        Start Contributing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-contributor-guide/installing-ray/building-ray-on-linux-and-macos/" class="md-nav__link">
        Building Ray on Linux and macOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-contributor-guide/installing-ray/building-ray-on-windows/" class="md-nav__link">
        Building Ray on Windows
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.concurrency_ops.Concurrently" class="md-nav__link">
    Concurrently()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.concurrency_ops.Enqueue" class="md-nav__link">
    Enqueue
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.concurrency_ops.Dequeue" class="md-nav__link">
    Dequeue()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.learner_thread.LearnerThread" class="md-nav__link">
    LearnerThread
  </a>
  
    <nav class="md-nav" aria-label="LearnerThread">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.learner_thread.LearnerThread.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.learner_thread.LearnerThread.add_learner_metrics" class="md-nav__link">
    add_learner_metrics()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.learner_thread.LearnerThread.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.metric_ops.StandardMetricsReporting" class="md-nav__link">
    StandardMetricsReporting()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.metric_ops.CollectMetrics" class="md-nav__link">
    CollectMetrics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.metric_ops.OncePerTimeInterval" class="md-nav__link">
    OncePerTimeInterval
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.metric_ops.OncePerTimestepsElapsed" class="md-nav__link">
    OncePerTimestepsElapsed
  </a>
  
    <nav class="md-nav" aria-label="OncePerTimestepsElapsed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.metric_ops.OncePerTimestepsElapsed.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.multi_gpu_learner_thread.MultiGPULearnerThread" class="md-nav__link">
    MultiGPULearnerThread
  </a>
  
    <nav class="md-nav" aria-label="MultiGPULearnerThread">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.multi_gpu_learner_thread.MultiGPULearnerThread.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.StoreToReplayBuffer" class="md-nav__link">
    StoreToReplayBuffer
  </a>
  
    <nav class="md-nav" aria-label="StoreToReplayBuffer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.StoreToReplayBuffer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.Replay" class="md-nav__link">
    Replay()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.SimpleReplayBuffer" class="md-nav__link">
    SimpleReplayBuffer
  </a>
  
    <nav class="md-nav" aria-label="SimpleReplayBuffer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.SimpleReplayBuffer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.MixInReplay" class="md-nav__link">
    MixInReplay
  </a>
  
    <nav class="md-nav" aria-label="MixInReplay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.MixInReplay.__init__" class="md-nav__link">
    __init__()
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.MixInReplay.__init__--replay-proportion-21" class="md-nav__link">
    replay proportion 2:1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.replay_ops.MixInReplay.__init__--replay-proportion-01-replay-disabled" class="md-nav__link">
    replay proportion 0:1, replay disabled
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.rollout_ops.ParallelRollouts" class="md-nav__link">
    ParallelRollouts()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.rollout_ops.AsyncGradients" class="md-nav__link">
    AsyncGradients()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.rollout_ops.ConcatBatches" class="md-nav__link">
    ConcatBatches
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.rollout_ops.SelectExperiences" class="md-nav__link">
    SelectExperiences
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.rollout_ops.StandardizeFields" class="md-nav__link">
    StandardizeFields
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.TrainOneStep" class="md-nav__link">
    TrainOneStep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.MultiGPUTrainOneStep" class="md-nav__link">
    MultiGPUTrainOneStep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.ComputeGradients" class="md-nav__link">
    ComputeGradients
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.ApplyGradients" class="md-nav__link">
    ApplyGradients
  </a>
  
    <nav class="md-nav" aria-label="ApplyGradients">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.ApplyGradients.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.AverageGradients" class="md-nav__link">
    AverageGradients
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.execution.train_ops.UpdateTargetNetwork" class="md-nav__link">
    UpdateTargetNetwork
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="execution-package"><code>execution</code> Package</h1>


  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.execution.concurrency_ops.Concurrently">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">concurrency_ops</span><span class="o">.</span><span class="n">Concurrently</span><span class="p">(</span><span class="n">ops</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;round_robin&#39;</span><span class="p">,</span> <span class="n">output_indexes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">round_robin_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Operator that runs the given parent iterators concurrently.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>mode</code></td>
        <td><code>str</code></td>
        <td><p>One of 'round_robin', 'async'. In 'round_robin' mode,
we alternate between pulling items from each parent iterator in
order deterministically. In 'async' mode, we pull from each parent
iterator as fast as they are produced. This is non-deterministic.</p></td>
        <td><code>&#39;round_robin&#39;</code></td>
      </tr>
      <tr>
        <td><code>output_indexes</code></td>
        <td><code>list</code></td>
        <td><p>If specified, only output results from the
given ops. For example, if <code>output_indexes=[0]</code>, only results
from the first op in ops will be returned.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>round_robin_weights</code></td>
        <td><code>list</code></td>
        <td><p>List of weights to use for round robin
mode. For example, <code>[2, 1]</code> will cause the iterator to pull twice
as many items from the first iterator as the second. <code>[2, 1, *]</code>
will cause as many items to be pulled as possible from the third
iterator without blocking. This is only allowed in round robin
mode.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">sim_op</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">replay_op</span> <span class="o">=</span> <span class="n">LocalReplay</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">combined_op</span> <span class="o">=</span> <span class="n">Concurrently</span><span class="p">([</span><span class="n">sim_op</span><span class="p">,</span> <span class="n">replay_op</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;async&quot;</span><span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/concurrency_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">Concurrently</span><span class="p">(</span><span class="n">ops</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LocalIterator</span><span class="p">],</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>                 <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                 <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;round_robin&quot;</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>                 <span class="n">output_indexes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>                 <span class="n">round_robin_weights</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LocalIterator</span><span class="p">[</span><span class="n">SampleBatchType</span><span class="p">]:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="sd">&quot;&quot;&quot;Operator that runs the given parent iterators concurrently.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        mode (str): One of &#39;round_robin&#39;, &#39;async&#39;. In &#39;round_robin&#39; mode,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            we alternate between pulling items from each parent iterator in</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            order deterministically. In &#39;async&#39; mode, we pull from each parent</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            iterator as fast as they are produced. This is non-deterministic.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        output_indexes (list): If specified, only output results from the</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            given ops. For example, if ``output_indexes=[0]``, only results</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            from the first op in ops will be returned.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        round_robin_weights (list): List of weights to use for round robin</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">            mode. For example, ``[2, 1]`` will cause the iterator to pull twice</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            as many items from the first iterator as the second. ``[2, 1, *]``</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">            will cause as many items to be pulled as possible from the third</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">            iterator without blocking. This is only allowed in round robin</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">            mode.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        &gt;&gt;&gt; sim_op = ParallelRollouts(...).for_each(...)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        &gt;&gt;&gt; replay_op = LocalReplay(...).for_each(...)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        &gt;&gt;&gt; combined_op = Concurrently([sim_op, replay_op], mode=&quot;async&quot;)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ops</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Should specify at least 2 ops.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;round_robin&quot;</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;async&quot;</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">deterministic</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="k">if</span> <span class="n">round_robin_weights</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>                <span class="s2">&quot;round_robin_weights cannot be specified in async mode&quot;</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown mode </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">if</span> <span class="n">round_robin_weights</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">r</span> <span class="o">==</span> <span class="s2">&quot;*&quot;</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">round_robin_weights</span><span class="p">):</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot specify all round robin weights = *&quot;</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="k">if</span> <span class="n">output_indexes</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">output_indexes</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ops</span><span class="p">)),</span> <span class="p">(</span><span class="s2">&quot;Index out of range&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="k">def</span> <span class="nf">tag</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>            <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">ops</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">op</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ops</span><span class="p">)]</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">ops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="o">*</span><span class="n">ops</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="n">deterministic</span><span class="o">=</span><span class="n">deterministic</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">round_robin_weights</span><span class="o">=</span><span class="n">round_robin_weights</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="k">if</span> <span class="n">output_indexes</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">output_indexes</span><span class="p">)</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>            <span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">return</span> <span class="n">output</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.concurrency_ops.Enqueue">
        <code>
ray.rllib.execution.concurrency_ops.Enqueue        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Enqueue data items into a queue.Queue instance.</p>
<p>Returns the input item as output.</p>
<p>The enqueue is non-blocking, so Enqueue operations can executed with
Dequeue via the Concurrently() operator.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">write_op</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">Enqueue</span><span class="p">(</span><span class="n">queue</span><span class="p">))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">read_op</span> <span class="o">=</span> <span class="n">Dequeue</span><span class="p">(</span><span class="n">queue</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">combined_op</span> <span class="o">=</span> <span class="n">Concurrently</span><span class="p">([</span><span class="n">write_op</span><span class="p">,</span> <span class="n">read_op</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;async&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">next</span><span class="p">(</span><span class="n">combined_op</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="n">SampleBatch</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre></div>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.execution.concurrency_ops.Dequeue">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">concurrency_ops</span><span class="o">.</span><span class="n">Dequeue</span><span class="p">(</span><span class="n">input_queue</span><span class="p">,</span> <span class="n">check</span><span class="o">=&lt;</span><span class="n">function</span> <span class="o">&lt;</span><span class="k">lambda</span><span class="o">&gt;</span> <span class="n">at</span> <span class="mh">0x1250a5710</span><span class="o">&gt;</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Dequeue data items from a queue.Queue instance.</p>
<p>The dequeue is non-blocking, so Dequeue operations can execute with
Enqueue via the Concurrently() operator.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>input_queue</code></td>
        <td><code>Queue</code></td>
        <td><p>queue to pull items from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>check</code></td>
        <td><code>fn</code></td>
        <td><p>liveness check. When this function returns false,
Dequeue() will raise an error to halt execution.</p></td>
        <td><code>&lt;function &lt;lambda&gt; at 0x1250a5710&gt;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">write_op</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">Enqueue</span><span class="p">(</span><span class="n">queue</span><span class="p">))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">read_op</span> <span class="o">=</span> <span class="n">Dequeue</span><span class="p">(</span><span class="n">queue</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">combined_op</span> <span class="o">=</span> <span class="n">Concurrently</span><span class="p">([</span><span class="n">write_op</span><span class="p">,</span> <span class="n">read_op</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;async&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">next</span><span class="p">(</span><span class="n">combined_op</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="n">SampleBatch</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/concurrency_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">Dequeue</span><span class="p">(</span><span class="n">input_queue</span><span class="p">:</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>            <span class="n">check</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LocalIterator</span><span class="p">[</span><span class="n">SampleBatchType</span><span class="p">]:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Dequeue data items from a queue.Queue instance.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    The dequeue is non-blocking, so Dequeue operations can execute with</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Enqueue via the Concurrently() operator.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        input_queue (Queue): queue to pull items from.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        check (fn): liveness check. When this function returns false,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            Dequeue() will raise an error to halt execution.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        &gt;&gt;&gt; queue = queue.Queue(100)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        &gt;&gt;&gt; write_op = ParallelRollouts(...).for_each(Enqueue(queue))</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        &gt;&gt;&gt; read_op = Dequeue(queue)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        &gt;&gt;&gt; combined_op = Concurrently([write_op, read_op], mode=&quot;async&quot;)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        &gt;&gt;&gt; next(combined_op)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        SampleBatch(...)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_queue</span><span class="p">,</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected queue.Queue, got </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>            <span class="nb">type</span><span class="p">(</span><span class="n">input_queue</span><span class="p">)))</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">def</span> <span class="nf">base_iterator</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="k">while</span> <span class="n">check</span><span class="p">():</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>                <span class="n">item</span> <span class="o">=</span> <span class="n">input_queue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>                <span class="k">yield</span> <span class="n">item</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>            <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>                <span class="k">yield</span> <span class="n">_NextValueNotReady</span><span class="p">()</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Dequeue `check()` returned False! &quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>                           <span class="s2">&quot;Exiting with Exception from Dequeue iterator.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="k">return</span> <span class="n">LocalIterator</span><span class="p">(</span><span class="n">base_iterator</span><span class="p">,</span> <span class="n">SharedMetrics</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.learner_thread.LearnerThread">
        <code>
ray.rllib.execution.learner_thread.LearnerThread            (<span title="threading.Thread">Thread</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Background thread that updates the local model from sample trajectories.</p>
<p>The learner thread communicates with the main thread through Queues. This
is needed since Ray operations can only be run on the main thread. In
addition, moving heavyweight gradient ops session runs off the main thread
improves overall throughput.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.execution.learner_thread.LearnerThread.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_worker</span><span class="p">,</span> <span class="n">minibatch_buffer_size</span><span class="p">,</span> <span class="n">num_sgd_iter</span><span class="p">,</span> <span class="n">learner_queue_size</span><span class="p">,</span> <span class="n">learner_queue_timeout</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize the learner thread.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>local_worker</code></td>
        <td><code>RolloutWorker</code></td>
        <td><p>process local rollout worker holding
policies this thread will call learn_on_batch() on</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>minibatch_buffer_size</code></td>
        <td><code>int</code></td>
        <td><p>max number of train batches to store
in the minibatching buffer</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_sgd_iter</code></td>
        <td><code>int</code></td>
        <td><p>number of passes to learn on per train batch</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>learner_queue_size</code></td>
        <td><code>int</code></td>
        <td><p>max size of queue of inbound
train batches to this thread</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>learner_queue_timeout</code></td>
        <td><code>int</code></td>
        <td><p>raise an exception if the queue has
been empty for this long in seconds</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/learner_thread.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_worker</span><span class="p">:</span> <span class="n">RolloutWorker</span><span class="p">,</span> <span class="n">minibatch_buffer_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>             <span class="n">num_sgd_iter</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">learner_queue_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">learner_queue_timeout</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="sd">&quot;&quot;&quot;Initialize the learner thread.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        local_worker (RolloutWorker): process local rollout worker holding</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">            policies this thread will call learn_on_batch() on</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        minibatch_buffer_size (int): max number of train batches to store</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">            in the minibatching buffer</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        num_sgd_iter (int): number of passes to learn on per train batch</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        learner_queue_size (int): max size of queue of inbound</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            train batches to this thread</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        learner_queue_timeout (int): raise an exception if the queue has</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            been empty for this long in seconds</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">learner_queue_size</span> <span class="o">=</span> <span class="n">WindowStat</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">local_worker</span> <span class="o">=</span> <span class="n">local_worker</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">inqueue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="n">learner_queue_size</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">outqueue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">minibatch_buffer</span> <span class="o">=</span> <span class="n">MinibatchBuffer</span><span class="p">(</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="n">inqueue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inqueue</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="n">size</span><span class="o">=</span><span class="n">minibatch_buffer_size</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">learner_queue_timeout</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="n">num_passes</span><span class="o">=</span><span class="n">num_sgd_iter</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="n">init_num_passes</span><span class="o">=</span><span class="n">num_sgd_iter</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">queue_timer</span> <span class="o">=</span> <span class="n">TimerStat</span><span class="p">()</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">grad_timer</span> <span class="o">=</span> <span class="n">TimerStat</span><span class="p">()</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">load_timer</span> <span class="o">=</span> <span class="n">TimerStat</span><span class="p">()</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">load_wait_timer</span> <span class="o">=</span> <span class="n">TimerStat</span><span class="p">()</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">weights_updated</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">learner_info</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stopped</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_steps</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.execution.learner_thread.LearnerThread.add_learner_metrics">
<code class="highlight language-python"><span class="n">add_learner_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Add internal metrics to a trainer result dict.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/learner_thread.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">add_learner_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Add internal metrics to a trainer result dict.&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="k">def</span> <span class="nf">timer_to_ms</span><span class="p">(</span><span class="n">timer</span><span class="p">):</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">timer</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="n">result</span><span class="p">[</span><span class="s2">&quot;info&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>        <span class="s2">&quot;learner_queue&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">learner_queue_size</span><span class="o">.</span><span class="n">stats</span><span class="p">(),</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>        <span class="n">LEARNER_INFO</span><span class="p">:</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">learner_info</span><span class="p">),</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>        <span class="s2">&quot;timing_breakdown&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>            <span class="s2">&quot;learner_grad_time_ms&quot;</span><span class="p">:</span> <span class="n">timer_to_ms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grad_timer</span><span class="p">),</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>            <span class="s2">&quot;learner_load_time_ms&quot;</span><span class="p">:</span> <span class="n">timer_to_ms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_timer</span><span class="p">),</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>            <span class="s2">&quot;learner_load_wait_time_ms&quot;</span><span class="p">:</span> <span class="n">timer_to_ms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_wait_timer</span><span class="p">),</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>            <span class="s2">&quot;learner_dequeue_time_ms&quot;</span><span class="p">:</span> <span class="n">timer_to_ms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_timer</span><span class="p">),</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="p">}</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="p">})</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.execution.learner_thread.LearnerThread.run">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Method representing the thread's activity.</p>
<p>You may override this method in a subclass. The standard run() method
invokes the callable object passed to the object's constructor as the
target argument, if any, with sequential and keyword arguments taken
from the args and kwargs arguments, respectively.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/learner_thread.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="c1"># Switch on eager mode if configured.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_worker</span><span class="o">.</span><span class="n">policy_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;framework&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;tf2&quot;</span><span class="p">,</span> <span class="s2">&quot;tfe&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">tf1</span><span class="o">.</span><span class="n">enable_eager_execution</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopped</span><span class="p">:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.execution.metric_ops.StandardMetricsReporting">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">metric_ops</span><span class="o">.</span><span class="n">StandardMetricsReporting</span><span class="p">(</span><span class="n">train_op</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">selected_workers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">by_steps_trained</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Operator to periodically collect and report metrics.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>train_op</code></td>
        <td><code>LocalIterator</code></td>
        <td><p>Operator for executing training steps.
We ignore the output values.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>workers</code></td>
        <td><code>WorkerSet</code></td>
        <td><p>Rollout workers to collect metrics from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>config</code></td>
        <td><code>dict</code></td>
        <td><p>Trainer configuration, used to determine the frequency
of stats reporting.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>selected_workers</code></td>
        <td><code>list</code></td>
        <td><p>Override the list of remote workers
to collect metrics from.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>by_steps_trained</code></td>
        <td><code>bool</code></td>
        <td><p>If True, uses the <code>STEPS_TRAINED_COUNTER</code>
instead of the <code>STEPS_SAMPLED_COUNTER</code> in metrics.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>LocalIterator[dict]</code></td>
      <td><p>A local iterator over training results.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">train_op</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">TrainOneStep</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">metrics_op</span> <span class="o">=</span> <span class="n">StandardMetricsReporting</span><span class="p">(</span><span class="n">train_op</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">next</span><span class="p">(</span><span class="n">metrics_op</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="p">{</span><span class="s2">&quot;episode_reward_max&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;episode_reward_mean&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/metric_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">StandardMetricsReporting</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>        <span class="n">train_op</span><span class="p">:</span> <span class="n">LocalIterator</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="n">workers</span><span class="p">:</span> <span class="n">WorkerSet</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">selected_workers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ActorHandle</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="n">by_steps_trained</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LocalIterator</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="sd">&quot;&quot;&quot;Operator to periodically collect and report metrics.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        train_op (LocalIterator): Operator for executing training steps.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            We ignore the output values.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        workers (WorkerSet): Rollout workers to collect metrics from.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        config (dict): Trainer configuration, used to determine the frequency</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            of stats reporting.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        selected_workers (list): Override the list of remote workers</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">            to collect metrics from.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        by_steps_trained (bool): If True, uses the `STEPS_TRAINED_COUNTER`</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            instead of the `STEPS_SAMPLED_COUNTER` in metrics.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        LocalIterator[dict]: A local iterator over training results.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        &gt;&gt;&gt; train_op = ParallelRollouts(...).for_each(TrainOneStep(...))</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        &gt;&gt;&gt; metrics_op = StandardMetricsReporting(train_op, workers, config)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        &gt;&gt;&gt; next(metrics_op)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        {&quot;episode_reward_max&quot;: ..., &quot;episode_reward_mean&quot;: ..., ...}</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">output_op</span> <span class="o">=</span> <span class="n">train_op</span> \
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">OncePerTimestepsElapsed</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;timesteps_per_iteration&quot;</span><span class="p">],</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>                                        <span class="n">by_steps_trained</span><span class="o">=</span><span class="n">by_steps_trained</span><span class="p">))</span> \
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">OncePerTimeInterval</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;min_iter_time_s&quot;</span><span class="p">]))</span> \
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">CollectMetrics</span><span class="p">(</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="n">workers</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="n">min_history</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;metrics_smoothing_episodes&quot;</span><span class="p">],</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="n">timeout_seconds</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;collect_metrics_timeout&quot;</span><span class="p">],</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="n">selected_workers</span><span class="o">=</span><span class="n">selected_workers</span><span class="p">))</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">return</span> <span class="n">output_op</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.metric_ops.CollectMetrics">
        <code>
ray.rllib.execution.metric_ops.CollectMetrics        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable that collects metrics from workers.</p>
<p>The metrics are smoothed over a given history window.</p>
<p>This should be used with the .for_each() operator. For a higher level
API, consider using StandardMetricsReporting instead.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">output_op</span> <span class="o">=</span> <span class="n">train_op</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">CollectMetrics</span><span class="p">(</span><span class="n">workers</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">output_op</span><span class="p">))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="p">{</span><span class="s2">&quot;episode_reward_max&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;episode_reward_mean&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
</code></pre></div>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.metric_ops.OncePerTimeInterval">
        <code>
ray.rllib.execution.metric_ops.OncePerTimeInterval        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable that returns True once per given interval.</p>
<p>This should be used with the .filter() operator to throttle / rate-limit
metrics reporting. For a higher-level API, consider using
StandardMetricsReporting instead.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">throttled_op</span> <span class="o">=</span> <span class="n">train_op</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">OncePerTimeInterval</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">next</span><span class="p">(</span><span class="n">throttled_op</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="mf">5.00001</span>  <span class="c1"># will be greater than 5 seconds</span>
</code></pre></div>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.metric_ops.OncePerTimestepsElapsed">
        <code>
ray.rllib.execution.metric_ops.OncePerTimestepsElapsed        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable that returns True once per given number of timesteps.</p>
<p>This should be used with the .filter() operator to throttle / rate-limit
metrics reporting. For a higher-level API, consider using
StandardMetricsReporting instead.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">throttled_op</span> <span class="o">=</span> <span class="n">train_op</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">OncePerTimestepsElapsed</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">next</span><span class="p">(</span><span class="n">throttled_op</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="c1"># will only return after 1000 steps have elapsed</span>
</code></pre></div>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.execution.metric_ops.OncePerTimestepsElapsed.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delay_steps</span><span class="p">,</span> <span class="n">by_steps_trained</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>delay_steps</code></td>
        <td><code>int</code></td>
        <td><p>The number of steps (sampled or trained) every
which this op returns True.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>by_steps_trained</code></td>
        <td><code>bool</code></td>
        <td><p>If True, uses the <code>STEPS_TRAINED_COUNTER</code>
instead of the <code>STEPS_SAMPLED_COUNTER</code> in metrics.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/metric_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delay_steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by_steps_trained</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">        delay_steps (int): The number of steps (sampled or trained) every</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">            which this op returns True.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        by_steps_trained (bool): If True, uses the `STEPS_TRAINED_COUNTER`</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">            instead of the `STEPS_SAMPLED_COUNTER` in metrics.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">delay_steps</span> <span class="o">=</span> <span class="n">delay_steps</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">by_steps_trained</span> <span class="o">=</span> <span class="n">by_steps_trained</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_called</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.multi_gpu_learner_thread.MultiGPULearnerThread">
        <code>
ray.rllib.execution.multi_gpu_learner_thread.MultiGPULearnerThread            (<a title="ray.rllib.execution.learner_thread.LearnerThread" href="#ray.rllib.execution.learner_thread.LearnerThread">LearnerThread</a>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Learner that can use multiple GPUs and parallel loading.</p>
<p>This class is used for async sampling algorithms.</p>
<p>Example workflow: 2 GPUs and 3 multi-GPU tower stacks.
-&gt; On each GPU, there are 3 slots for batches, indexed 0, 1, and 2.</p>
<p>Workers collect data from env and push it into inqueue:
Workers -&gt; (data) -&gt; self.inqueue</p>
<p>We also have two queues, indicating, which stacks are loaded and which
are not.
- idle_tower_stacks = [0, 1, 2]  &lt;- all 3 stacks are free at first.
- ready_tower_stacks = []  &lt;- None of the 3 stacks is loaded with data.</p>
<p><code>ready_tower_stacks</code> is managed by <code>ready_tower_stacks_buffer</code> for
possible minibatch-SGD iterations per loaded batch (this avoids a reload
from CPU to GPU for each SGD iter).</p>
<p>n _MultiGPULoaderThreads: self.inqueue -get()-&gt;
policy.load_batch_into_buffer() -&gt; ready_stacks = [0 ...]</p>
<p>This thread: self.ready_tower_stacks_buffer -get()-&gt;
policy.learn_on_loaded_batch() -&gt; if SGD-iters done,
put stack index back in idle_tower_stacks queue.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.execution.multi_gpu_learner_thread.MultiGPULearnerThread.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_worker</span><span class="p">,</span> <span class="n">num_gpus</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">train_batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">num_multi_gpu_tower_stacks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_sgd_iter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">learner_queue_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">learner_queue_timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">num_data_load_threads</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">_fake_gpus</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">minibatch_buffer_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initializes a MultiGPULearnerThread instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>local_worker</code></td>
        <td><code>RolloutWorker</code></td>
        <td><p>Local RolloutWorker holding
policies this thread will call <code>load_batch_into_buffer</code> and
<code>learn_on_loaded_batch</code> on.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_gpus</code></td>
        <td><code>int</code></td>
        <td><p>Number of GPUs to use for data-parallel SGD.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>train_batch_size</code></td>
        <td><code>int</code></td>
        <td><p>Size of batches (minibatches if
<code>num_sgd_iter</code> &gt; 1) to learn on.</p></td>
        <td><code>500</code></td>
      </tr>
      <tr>
        <td><code>num_multi_gpu_tower_stacks</code></td>
        <td><code>int</code></td>
        <td><p>Number of buffers to parallelly
load data into on one device. Each buffer is of size of
<code>train_batch_size</code> and hence increases GPU memory usage
accordingly.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>num_sgd_iter</code></td>
        <td><code>int</code></td>
        <td><p>Number of passes to learn on per train batch
(minibatch if <code>num_sgd_iter</code> &gt; 1).</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>learner_queue_size</code></td>
        <td><code>int</code></td>
        <td><p>Max size of queue of inbound
train batches to this thread.</p></td>
        <td><code>16</code></td>
      </tr>
      <tr>
        <td><code>num_data_load_threads</code></td>
        <td><code>int</code></td>
        <td><p>Number of threads to use to load
data into GPU memory in parallel.</p></td>
        <td><code>16</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/multi_gpu_learner_thread.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="n">local_worker</span><span class="p">:</span> <span class="n">RolloutWorker</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">num_gpus</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">lr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># deprecated.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="n">train_batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="n">num_multi_gpu_tower_stacks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>        <span class="n">num_sgd_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>        <span class="n">learner_queue_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>        <span class="n">learner_queue_timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>        <span class="n">num_data_load_threads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="n">_fake_gpus</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>        <span class="c1"># Deprecated arg, use</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="n">minibatch_buffer_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="p">):</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="sd">&quot;&quot;&quot;Initializes a MultiGPULearnerThread instance.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        local_worker (RolloutWorker): Local RolloutWorker holding</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">            policies this thread will call `load_batch_into_buffer` and</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">            `learn_on_loaded_batch` on.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        num_gpus (int): Number of GPUs to use for data-parallel SGD.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        train_batch_size (int): Size of batches (minibatches if</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">            `num_sgd_iter` &gt; 1) to learn on.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        num_multi_gpu_tower_stacks (int): Number of buffers to parallelly</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            load data into on one device. Each buffer is of size of</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">            `train_batch_size` and hence increases GPU memory usage</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            accordingly.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        num_sgd_iter (int): Number of passes to learn on per train batch</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">            (minibatch if `num_sgd_iter` &gt; 1).</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        learner_queue_size (int): Max size of queue of inbound</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">            train batches to this thread.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        num_data_load_threads (int): Number of threads to use to load</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            data into GPU memory in parallel.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="c1"># Deprecated: No need to specify as we don&#39;t need the actual</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="c1"># minibatch-buffer anyways.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="k">if</span> <span class="n">minibatch_buffer_size</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="n">deprecation_warning</span><span class="p">(</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>            <span class="n">old</span><span class="o">=</span><span class="s2">&quot;MultiGPULearnerThread.minibatch_buffer_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="n">local_worker</span><span class="o">=</span><span class="n">local_worker</span><span class="p">,</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="n">minibatch_buffer_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="n">num_sgd_iter</span><span class="o">=</span><span class="n">num_sgd_iter</span><span class="p">,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">learner_queue_size</span><span class="o">=</span><span class="n">learner_queue_size</span><span class="p">,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="n">learner_queue_timeout</span><span class="o">=</span><span class="n">learner_queue_timeout</span><span class="p">,</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="c1"># Delete reference to parent&#39;s minibatch_buffer, which is not needed.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="c1"># Instead, in multi-GPU mode, we pull tower stack indices from the</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="c1"># `self.ready_tower_stacks_buffer` buffer, whose size is exactly</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="c1"># `num_multi_gpu_tower_stacks`.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">minibatch_buffer</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">=</span> <span class="n">train_batch_size</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">policy_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_worker</span><span class="o">.</span><span class="n">policy_map</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">devices</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">policy_map</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">devices</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MultiGPULearnerThread devices </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">devices</span><span class="p">))</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">devices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">devices</span><span class="p">),</span>\
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="s2">&quot;batch too small&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tower_stack_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_multi_gpu_tower_stacks</span><span class="p">))</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="c1"># Two queues for tower stacks:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="c1"># a) Those that are loaded with data (&quot;ready&quot;)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="c1"># b) Those that are ready to be loaded with new data (&quot;idle&quot;).</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">idle_tower_stacks</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ready_tower_stacks</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="c1"># In the beginning, all stacks are idle (no loading has taken place</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="c1"># yet).</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tower_stack_indices</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idle_tower_stacks</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="c1"># Start n threads that are responsible for loading data into the</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="c1"># different (idle) stacks.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_data_load_threads</span><span class="p">):</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loader_thread</span> <span class="o">=</span> <span class="n">_MultiGPULoaderThread</span><span class="p">(</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">share_stats</span><span class="o">=</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loader_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="c1"># Create a buffer that holds stack indices that are &quot;ready&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="c1"># (loaded with data). Those are stacks that we can call</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="c1"># &quot;learn_on_loaded_batch&quot; on.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ready_tower_stacks_buffer</span> <span class="o">=</span> <span class="n">MinibatchBuffer</span><span class="p">(</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ready_tower_stacks</span><span class="p">,</span> <span class="n">num_multi_gpu_tower_stacks</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">learner_queue_timeout</span><span class="p">,</span> <span class="n">num_sgd_iter</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.replay_ops.StoreToReplayBuffer">
        <code>
ray.rllib.execution.replay_ops.StoreToReplayBuffer        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable that stores data into replay buffer actors.</p>
<p>If constructed with a local replay actor, data will be stored into that
buffer. If constructed with a list of replay actor handles, data will
be stored randomly among those actors.</p>
<p>This should be used with the .for_each() operator on a rollouts iterator.
The batch that was stored is returned.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">actors</span> <span class="o">=</span> <span class="p">[</span><span class="n">ReplayActor</span><span class="o">.</span><span class="n">remote</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">store_op</span> <span class="o">=</span> <span class="n">rollouts</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">StoreToReplayActors</span><span class="p">(</span><span class="n">actors</span><span class="o">=</span><span class="n">actors</span><span class="p">))</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">next</span><span class="p">(</span><span class="n">store_op</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="n">SampleBatch</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre></div>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.execution.replay_ops.StoreToReplayBuffer.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">local_buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">actors</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>local_buffer</code></td>
        <td><code>LocalReplayBuffer</code></td>
        <td><p>The local replay buffer to store
the data into.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>actors</code></td>
        <td><code>Optional[List[ActorHandle]]</code></td>
        <td><p>An optional list of replay
actors to use instead of <code>local_buffer</code>.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/replay_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">local_buffer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LocalReplayBuffer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">actors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ActorHandle</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        local_buffer (LocalReplayBuffer): The local replay buffer to store</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">            the data into.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        actors (Optional[List[ActorHandle]]): An optional list of replay</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            actors to use instead of `local_buffer`.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">local_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">(</span><span class="n">actors</span><span class="p">):</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>            <span class="s2">&quot;Either `local_buffer` or `replay_actors` must be given, &quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>            <span class="s2">&quot;not both!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="k">if</span> <span class="n">local_buffer</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">local_actor</span> <span class="o">=</span> <span class="n">local_buffer</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">replay_actors</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">local_actor</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">replay_actors</span> <span class="o">=</span> <span class="n">actors</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.execution.replay_ops.Replay">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">replay_ops</span><span class="o">.</span><span class="n">Replay</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">local_buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">actors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_async</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Replay experiences from the given buffer or actors.</p>
<p>This should be combined with the StoreToReplayActors operation using the
Concurrently() operator.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>local_buffer</code></td>
        <td><code>LocalReplayBuffer</code></td>
        <td><p>Local buffer to use. Only one of this
and replay_actors can be specified.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>actors</code></td>
        <td><code>list</code></td>
        <td><p>List of replay actors. Only one of this and
local_buffer can be specified.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>num_async</code></td>
        <td><code>int</code></td>
        <td><p>In async mode, the max number of async
requests in flight per actor.</p></td>
        <td><code>4</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">actors</span> <span class="o">=</span> <span class="p">[</span><span class="n">ReplayActor</span><span class="o">.</span><span class="n">remote</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">replay_op</span> <span class="o">=</span> <span class="n">Replay</span><span class="p">(</span><span class="n">actors</span><span class="o">=</span><span class="n">actors</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">next</span><span class="p">(</span><span class="n">replay_op</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="n">SampleBatch</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/replay_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">Replay</span><span class="p">(</span><span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>           <span class="n">local_buffer</span><span class="p">:</span> <span class="n">LocalReplayBuffer</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>           <span class="n">actors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ActorHandle</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>           <span class="n">num_async</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LocalIterator</span><span class="p">[</span><span class="n">SampleBatchType</span><span class="p">]:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Replay experiences from the given buffer or actors.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    This should be combined with the StoreToReplayActors operation using the</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Concurrently() operator.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        local_buffer (LocalReplayBuffer): Local buffer to use. Only one of this</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            and replay_actors can be specified.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        actors (list): List of replay actors. Only one of this and</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">            local_buffer can be specified.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        num_async (int): In async mode, the max number of async</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            requests in flight per actor.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        &gt;&gt;&gt; actors = [ReplayActor.remote() for _ in range(4)]</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        &gt;&gt;&gt; replay_op = Replay(actors=actors)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        &gt;&gt;&gt; next(replay_op)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        SampleBatch(...)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">local_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">(</span><span class="n">actors</span><span class="p">):</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="s2">&quot;Exactly one of local_buffer and replay_actors must be given.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="k">if</span> <span class="n">actors</span><span class="p">:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="n">replay</span> <span class="o">=</span> <span class="n">from_actors</span><span class="p">(</span><span class="n">actors</span><span class="p">)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="k">return</span> <span class="n">replay</span><span class="o">.</span><span class="n">gather_async</span><span class="p">(</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>            <span class="n">num_async</span><span class="o">=</span><span class="n">num_async</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">def</span> <span class="nf">gen_replay</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="n">item</span> <span class="o">=</span> <span class="n">local_buffer</span><span class="o">.</span><span class="n">replay</span><span class="p">()</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>                <span class="k">yield</span> <span class="n">_NextValueNotReady</span><span class="p">()</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                <span class="k">yield</span> <span class="n">item</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">return</span> <span class="n">LocalIterator</span><span class="p">(</span><span class="n">gen_replay</span><span class="p">,</span> <span class="n">SharedMetrics</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.replay_ops.SimpleReplayBuffer">
        <code>
ray.rllib.execution.replay_ops.SimpleReplayBuffer        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Simple replay buffer that operates over batches.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.execution.replay_ops.SimpleReplayBuffer.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_slots</span><span class="p">,</span> <span class="n">replay_proportion</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize SimpleReplayBuffer.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>num_slots</code></td>
        <td><code>int</code></td>
        <td><p>Number of batches to store in total.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/replay_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>             <span class="n">num_slots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">replay_proportion</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="sd">&quot;&quot;&quot;Initialize SimpleReplayBuffer.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        num_slots (int): Number of batches to store in total.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_slots</span> <span class="o">=</span> <span class="n">num_slots</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">replay_batches</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">replay_index</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>
        </details>
    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.replay_ops.MixInReplay">
        <code>
ray.rllib.execution.replay_ops.MixInReplay        </code>



</h2>

    <div class="doc doc-contents first">

      <p>This operator adds replay to a stream of experiences.</p>
<p>It takes input batches, and returns a list of batches that include replayed
data as well. The number of replayed batches is determined by the
configured replay proportion. The max age of a batch is determined by the
number of replay slots.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.execution.replay_ops.MixInReplay.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_slots</span><span class="p">,</span> <span class="n">replay_proportion</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize MixInReplay.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>num_slots</code></td>
        <td><code>int</code></td>
        <td><p>Number of batches to store in total.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>replay_proportion</code></td>
        <td><code>float</code></td>
        <td><p>The input batch will be returned
and an additional number of batches proportional to this value
will be added as well.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <h4 id="ray.rllib.execution.replay_ops.MixInReplay.__init__--replay-proportion-21">replay proportion 2:1</h4>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">replay_op</span> <span class="o">=</span> <span class="n">MixInReplay</span><span class="p">(</span><span class="n">rollouts</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">replay_proportion</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">replay_op</span><span class="p">))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="p">[</span><span class="n">SampleBatch</span><span class="p">(</span><span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span><span class="p">),</span> <span class="n">SampleBatch</span><span class="p">(</span><span class="o">&lt;</span><span class="n">replay</span><span class="o">&gt;</span><span class="p">),</span> <span class="n">SampleBatch</span><span class="p">(</span><span class="o">&lt;</span><span class="n">rep</span><span class="o">.&gt;</span><span class="p">)]</span>
</code></pre></div>
    <h4 id="ray.rllib.execution.replay_ops.MixInReplay.__init__--replay-proportion-01-replay-disabled">replay proportion 0:1, replay disabled</h4>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">replay_op</span> <span class="o">=</span> <span class="n">MixInReplay</span><span class="p">(</span><span class="n">rollouts</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">replay_proportion</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">replay_op</span><span class="p">))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="p">[</span><span class="n">SampleBatch</span><span class="p">(</span><span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span><span class="p">)]</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/replay_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_slots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">replay_proportion</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="sd">&quot;&quot;&quot;Initialize MixInReplay.</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">        num_slots (int): Number of batches to store in total.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        replay_proportion (float): The input batch will be returned</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">            and an additional number of batches proportional to this value</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">            will be added as well.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        # replay proportion 2:1</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        &gt;&gt;&gt; replay_op = MixInReplay(rollouts, 100, replay_proportion=2)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        &gt;&gt;&gt; print(next(replay_op))</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        [SampleBatch(&lt;input&gt;), SampleBatch(&lt;replay&gt;), SampleBatch(&lt;rep.&gt;)]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        # replay proportion 0:1, replay disabled</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        &gt;&gt;&gt; replay_op = MixInReplay(rollouts, 100, replay_proportion=0)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        &gt;&gt;&gt; print(next(replay_op))</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        [SampleBatch(&lt;input&gt;)]</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">if</span> <span class="n">replay_proportion</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">num_slots</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>            <span class="s2">&quot;You must set num_slots &gt; 0 if replay_proportion &gt; 0.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">replay_buffer</span> <span class="o">=</span> <span class="n">SimpleReplayBuffer</span><span class="p">(</span><span class="n">num_slots</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">replay_proportion</span> <span class="o">=</span> <span class="n">replay_proportion</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.execution.rollout_ops.ParallelRollouts">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">rollout_ops</span><span class="o">.</span><span class="n">ParallelRollouts</span><span class="p">(</span><span class="n">workers</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;bulk_sync&#39;</span><span class="p">,</span> <span class="n">num_async</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Operator to collect experiences in parallel from rollout workers.</p>
<p>If there are no remote workers, experiences will be collected serially from
the local worker instance instead.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>workers</code></td>
        <td><code>WorkerSet</code></td>
        <td><p>set of rollout workers to use.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mode</code></td>
        <td><code>str</code></td>
        <td><p>One of 'async', 'bulk_sync', 'raw'. In 'async' mode,
batches are returned as soon as they are computed by rollout
workers with no order guarantees. In 'bulk_sync' mode, we collect
one batch from each worker and concatenate them together into a
large batch to return. In 'raw' mode, the ParallelIterator object
is returned directly and the caller is responsible for implementing
gather and updating the timesteps counter.</p></td>
        <td><code>&#39;bulk_sync&#39;</code></td>
      </tr>
      <tr>
        <td><code>num_async</code></td>
        <td><code>int</code></td>
        <td><p>In async mode, the max number of async
requests in flight per actor.</p></td>
        <td><code>1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ray.util.iter.LocalIterator[ray.rllib.policy.sample_batch.SampleBatch]</code></td>
      <td><p>A local iterator over experiences collected in parallel.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="n">workers</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;async&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">rollouts</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="mi">50</span>  <span class="c1"># config.rollout_fragment_length</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="n">workers</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;bulk_sync&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">rollouts</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="mi">200</span>  <span class="c1"># config.rollout_fragment_length * config.num_workers</span>
</code></pre></div>
      <p>Updates the STEPS_SAMPLED_COUNTER counter in the local iterator context.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/rollout_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">ParallelRollouts</span><span class="p">(</span><span class="n">workers</span><span class="p">:</span> <span class="n">WorkerSet</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;bulk_sync&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>                     <span class="n">num_async</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LocalIterator</span><span class="p">[</span><span class="n">SampleBatch</span><span class="p">]:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Operator to collect experiences in parallel from rollout workers.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    If there are no remote workers, experiences will be collected serially from</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    the local worker instance instead.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        workers (WorkerSet): set of rollout workers to use.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        mode (str): One of &#39;async&#39;, &#39;bulk_sync&#39;, &#39;raw&#39;. In &#39;async&#39; mode,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            batches are returned as soon as they are computed by rollout</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            workers with no order guarantees. In &#39;bulk_sync&#39; mode, we collect</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            one batch from each worker and concatenate them together into a</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">            large batch to return. In &#39;raw&#39; mode, the ParallelIterator object</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            is returned directly and the caller is responsible for implementing</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            gather and updating the timesteps counter.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        num_async (int): In async mode, the max number of async</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">            requests in flight per actor.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        A local iterator over experiences collected in parallel.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        &gt;&gt;&gt; rollouts = ParallelRollouts(workers, mode=&quot;async&quot;)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        &gt;&gt;&gt; batch = next(rollouts)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        &gt;&gt;&gt; print(batch.count)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        50  # config.rollout_fragment_length</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        &gt;&gt;&gt; rollouts = ParallelRollouts(workers, mode=&quot;bulk_sync&quot;)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        &gt;&gt;&gt; batch = next(rollouts)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        &gt;&gt;&gt; print(batch.count)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        200  # config.rollout_fragment_length * config.num_workers</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    Updates the STEPS_SAMPLED_COUNTER counter in the local iterator context.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="c1"># Ensure workers are initially in sync.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">workers</span><span class="o">.</span><span class="n">sync_weights</span><span class="p">()</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">def</span> <span class="nf">report_timesteps</span><span class="p">(</span><span class="n">batch</span><span class="p">):</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="n">metrics</span> <span class="o">=</span> <span class="n">_get_shared_metrics</span><span class="p">()</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="n">metrics</span><span class="o">.</span><span class="n">counters</span><span class="p">[</span><span class="n">STEPS_SAMPLED_COUNTER</span><span class="p">]</span> <span class="o">+=</span> <span class="n">batch</span><span class="o">.</span><span class="n">count</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">MultiAgentBatch</span><span class="p">):</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="n">metrics</span><span class="o">.</span><span class="n">counters</span><span class="p">[</span><span class="n">AGENT_STEPS_SAMPLED_COUNTER</span><span class="p">]</span> <span class="o">+=</span> \
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>                <span class="n">batch</span><span class="o">.</span><span class="n">agent_steps</span><span class="p">()</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="n">metrics</span><span class="o">.</span><span class="n">counters</span><span class="p">[</span><span class="n">AGENT_STEPS_SAMPLED_COUNTER</span><span class="p">]</span> <span class="o">+=</span> <span class="n">batch</span><span class="o">.</span><span class="n">count</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="k">return</span> <span class="n">batch</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">workers</span><span class="o">.</span><span class="n">remote_workers</span><span class="p">():</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="c1"># Handle the `num_workers=0` case, in which the local worker</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="c1"># has to do sampling as well.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="k">def</span> <span class="nf">sampler</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>                <span class="k">yield</span> <span class="n">workers</span><span class="o">.</span><span class="n">local_worker</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">LocalIterator</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>                              <span class="n">SharedMetrics</span><span class="p">())</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">report_timesteps</span><span class="p">))</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="c1"># Create a parallel iterator over generated experiences.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">rollouts</span> <span class="o">=</span> <span class="n">from_actors</span><span class="p">(</span><span class="n">workers</span><span class="o">.</span><span class="n">remote_workers</span><span class="p">())</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;bulk_sync&quot;</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="k">return</span> <span class="n">rollouts</span> \
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="o">.</span><span class="n">batch_across_shards</span><span class="p">()</span> \
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>            <span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="k">lambda</span> <span class="n">batches</span><span class="p">:</span> <span class="n">SampleBatch</span><span class="o">.</span><span class="n">concat_samples</span><span class="p">(</span><span class="n">batches</span><span class="p">))</span> \
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>            <span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">report_timesteps</span><span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;async&quot;</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="k">return</span> <span class="n">rollouts</span><span class="o">.</span><span class="n">gather_async</span><span class="p">(</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="n">num_async</span><span class="o">=</span><span class="n">num_async</span><span class="p">)</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">report_timesteps</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;raw&quot;</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="k">return</span> <span class="n">rollouts</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be one of &#39;bulk_sync&#39;, &#39;async&#39;, &#39;raw&#39;, &quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                         <span class="s2">&quot;got &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="ray.rllib.execution.rollout_ops.AsyncGradients">
<code class="highlight language-python"><span class="n">ray</span><span class="o">.</span><span class="n">rllib</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">rollout_ops</span><span class="o">.</span><span class="n">AsyncGradients</span><span class="p">(</span><span class="n">workers</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Operator to compute gradients in parallel from rollout workers.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>workers</code></td>
        <td><code>WorkerSet</code></td>
        <td><p>set of rollout workers to use.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>ray.util.iter.LocalIterator[Tuple[Union[List[Tuple[Any, Any]], List[Any]], int]]</code></td>
      <td><p>A local iterator over policy gradients computed on rollout workers.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">grads_op</span> <span class="o">=</span> <span class="n">AsyncGradients</span><span class="p">(</span><span class="n">workers</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">grads_op</span><span class="p">))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="p">{</span><span class="s2">&quot;var_0&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span> <span class="mi">50</span>  <span class="c1"># grads, batch count</span>
</code></pre></div>
      <p>Updates the STEPS_SAMPLED_COUNTER counter and LEARNER_INFO field in the
local iterator context.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/rollout_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">AsyncGradients</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>        <span class="n">workers</span><span class="p">:</span> <span class="n">WorkerSet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LocalIterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">ModelGradients</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Operator to compute gradients in parallel from rollout workers.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        workers (WorkerSet): set of rollout workers to use.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        A local iterator over policy gradients computed on rollout workers.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        &gt;&gt;&gt; grads_op = AsyncGradients(workers)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        &gt;&gt;&gt; print(next(grads_op))</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        {&quot;var_0&quot;: ..., ...}, 50  # grads, batch count</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Updates the STEPS_SAMPLED_COUNTER counter and LEARNER_INFO field in the</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    local iterator context.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="c1"># Ensure workers are initially in sync.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">workers</span><span class="o">.</span><span class="n">sync_weights</span><span class="p">()</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="c1"># This function will be applied remotely on the workers.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="k">def</span> <span class="nf">samples_to_grads</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="k">return</span> <span class="n">get_global_worker</span><span class="p">()</span><span class="o">.</span><span class="n">compute_gradients</span><span class="p">(</span><span class="n">samples</span><span class="p">),</span> <span class="n">samples</span><span class="o">.</span><span class="n">count</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="c1"># Record learner metrics and pass through (grads, count).</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="k">class</span> <span class="nc">record_metrics</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="k">def</span> <span class="nf">_on_fetch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fetch_start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>            <span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">info</span><span class="p">),</span> <span class="n">count</span> <span class="o">=</span> <span class="n">item</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>            <span class="n">metrics</span> <span class="o">=</span> <span class="n">_get_shared_metrics</span><span class="p">()</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>            <span class="n">metrics</span><span class="o">.</span><span class="n">counters</span><span class="p">[</span><span class="n">STEPS_SAMPLED_COUNTER</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="n">metrics</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="n">LEARNER_INFO</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>                <span class="n">DEFAULT_POLICY_ID</span><span class="p">:</span> <span class="n">info</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="p">}</span> <span class="k">if</span> <span class="n">LEARNER_STATS_KEY</span> <span class="ow">in</span> <span class="n">info</span> <span class="k">else</span> <span class="n">info</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="n">metrics</span><span class="o">.</span><span class="n">timers</span><span class="p">[</span><span class="n">GRAD_WAIT_TIMER</span><span class="p">]</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                                                 <span class="bp">self</span><span class="o">.</span><span class="n">fetch_start_time</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="k">return</span> <span class="n">grads</span><span class="p">,</span> <span class="n">count</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">rollouts</span> <span class="o">=</span> <span class="n">from_actors</span><span class="p">(</span><span class="n">workers</span><span class="o">.</span><span class="n">remote_workers</span><span class="p">())</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">grads</span> <span class="o">=</span> <span class="n">rollouts</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">samples_to_grads</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">return</span> <span class="n">grads</span><span class="o">.</span><span class="n">gather_async</span><span class="p">()</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">record_metrics</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.rollout_ops.ConcatBatches">
        <code>
ray.rllib.execution.rollout_ops.ConcatBatches        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable used to merge batches into larger batches for training.</p>
<p>This should be used with the .combine() operator.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">rollouts</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">ConcatBatches</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">...</span>    <span class="n">min_batch_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">count_steps_by</span><span class="o">=</span><span class="s2">&quot;env_steps&quot;</span><span class="p">))</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">rollouts</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="mi">10000</span>
</code></pre></div>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.rollout_ops.SelectExperiences">
        <code>
ray.rllib.execution.rollout_ops.SelectExperiences        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable used to select experiences from a MultiAgentBatch.</p>
<p>This should be used with the .for_each() operator.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">rollouts</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">SelectExperiences</span><span class="p">([</span><span class="s2">&quot;pol1&quot;</span><span class="p">,</span> <span class="s2">&quot;pol2&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">rollouts</span><span class="p">)</span><span class="o">.</span><span class="n">policy_batches</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="p">{</span><span class="s2">&quot;pol1&quot;</span><span class="p">,</span> <span class="s2">&quot;pol2&quot;</span><span class="p">}</span>
</code></pre></div>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.rollout_ops.StandardizeFields">
        <code>
ray.rllib.execution.rollout_ops.StandardizeFields        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable used to standardize fields of batches.</p>
<p>This should be used with the .for_each() operator. Note that the input
may be mutated by this operator for efficiency.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">rollouts</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">StandardizeFields</span><span class="p">([</span><span class="s2">&quot;advantages&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">rollouts</span><span class="p">)[</span><span class="s2">&quot;advantages&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="mf">1.0</span>
</code></pre></div>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.train_ops.TrainOneStep">
        <code>
ray.rllib.execution.train_ops.TrainOneStep        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable that improves the policy and updates workers.</p>
<p>This should be used with the .for_each() operator. A tuple of the input
and learner stats will be returned.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">train_op</span> <span class="o">=</span> <span class="n">rollouts</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">TrainOneStep</span><span class="p">(</span><span class="n">workers</span><span class="p">))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">train_op</span><span class="p">))</span>  <span class="c1"># This trains the policy on one batch.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="n">SampleBatch</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="p">{</span><span class="s2">&quot;learner_stats&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">}</span>
</code></pre></div>
      <p>Updates the STEPS_TRAINED_COUNTER counter and LEARNER_INFO field in the
local iterator context.</p>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.train_ops.MultiGPUTrainOneStep">
        <code>
ray.rllib.execution.train_ops.MultiGPUTrainOneStep        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Multi-GPU version of TrainOneStep.</p>
<p>This should be used with the .for_each() operator. A tuple of the input
and learner stats will be returned.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rollouts</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">train_op</span> <span class="o">=</span> <span class="n">rollouts</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">MultiGPUTrainOneStep</span><span class="p">(</span><span class="n">workers</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">train_op</span><span class="p">))</span>  <span class="c1"># This trains the policy on one batch.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="n">SampleBatch</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="p">{</span><span class="s2">&quot;learner_stats&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">}</span>
</code></pre></div>
      <p>Updates the STEPS_TRAINED_COUNTER counter and LEARNER_INFO field in the
local iterator context.</p>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.train_ops.ComputeGradients">
        <code>
ray.rllib.execution.train_ops.ComputeGradients        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable that computes gradients with respect to the policy loss.</p>
<p>This should be used with the .for_each() operator.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">grads_op</span> <span class="o">=</span> <span class="n">rollouts</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">ComputeGradients</span><span class="p">(</span><span class="n">workers</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">grads_op</span><span class="p">))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="p">{</span><span class="s2">&quot;var_0&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span> <span class="mi">50</span>  <span class="c1"># grads, batch count</span>
</code></pre></div>
      <p>Updates the LEARNER_INFO info field in the local iterator context.</p>




  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.train_ops.ApplyGradients">
        <code>
ray.rllib.execution.train_ops.ApplyGradients        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable that applies gradients and updates workers.</p>
<p>This should be used with the .for_each() operator.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">apply_op</span> <span class="o">=</span> <span class="n">grads_op</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">ApplyGradients</span><span class="p">(</span><span class="n">workers</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">apply_op</span><span class="p">))</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kc">None</span>
</code></pre></div>
      <p>Updates the STEPS_TRAINED_COUNTER counter in the local iterator context.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.execution.train_ops.ApplyGradients.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workers</span><span class="p">,</span> <span class="n">policies</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">(),</span> <span class="n">update_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Creates an ApplyGradients instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>workers</code></td>
        <td><code>WorkerSet</code></td>
        <td><p>workers to apply gradients to.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>update_all</code></td>
        <td><code>bool</code></td>
        <td><p>If true, updates all workers. Otherwise, only
update the worker that produced the sample batch we are
currently processing (i.e., A3C style).</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/execution/train_ops.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>             <span class="n">workers</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">policies</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PolicyID</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([]),</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>             <span class="n">update_all</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Creates an ApplyGradients instance.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        workers (WorkerSet): workers to apply gradients to.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        update_all (bool): If true, updates all workers. Otherwise, only</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">            update the worker that produced the sample batch we are</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            currently processing (i.e., A3C style).</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">workers</span> <span class="o">=</span> <span class="n">workers</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">local_worker</span> <span class="o">=</span> <span class="n">workers</span><span class="o">.</span><span class="n">local_worker</span><span class="p">()</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">policies</span> <span class="o">=</span> <span class="n">policies</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">update_all</span> <span class="o">=</span> <span class="n">update_all</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.train_ops.AverageGradients">
        <code>
ray.rllib.execution.train_ops.AverageGradients        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Callable that averages the gradients in a batch.</p>
<p>This should be used with the .for_each() operator after a set of gradients
have been batched with .batch().</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">batched_grads</span> <span class="o">=</span> <span class="n">grads_op</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">avg_grads</span> <span class="o">=</span> <span class="n">batched_grads</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">AverageGradients</span><span class="p">())</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">avg_grads</span><span class="p">))</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="p">{</span><span class="s2">&quot;var_0&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span> <span class="mi">1600</span>  <span class="c1"># averaged grads, summed batch count</span>
</code></pre></div>



    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.execution.train_ops.UpdateTargetNetwork">
        <code>
ray.rllib.execution.train_ops.UpdateTargetNetwork        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Periodically call policy.update_target() on all trainable policies.</p>
<p>This should be used with the .for_each() operator after training step
has been taken.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">train_op</span> <span class="o">=</span> <span class="n">ParallelRollouts</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span><span class="n">TrainOneStep</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">update_op</span> <span class="o">=</span> <span class="n">train_op</span><span class="o">.</span><span class="n">for_each</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">...</span>     <span class="n">UpdateTargetIfNeeded</span><span class="p">(</span><span class="n">workers</span><span class="p">,</span> <span class="n">target_update_freq</span><span class="o">=</span><span class="mi">500</span><span class="p">))</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">update_op</span><span class="p">))</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="kc">None</span>
</code></pre></div>
      <p>Updates the LAST_TARGET_UPDATE_TS and NUM_TARGET_UPDATES counters in the
local iterator context. The value of the last update counter is used to
track when we should update the target next.</p>




  <div class="doc doc-children">












  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../evaluation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Evaluation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Evaluation
            </div>
          </div>
        </a>
      
      
        
        <a href="../utils/" class="md-footer__link md-footer__link--next" aria-label="Next: Utility" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Utility
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Anyscale, Inc 2021
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://twitter.com/raydistributed" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/ray-project/ray" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://ray.io" target="_blank" rel="noopener" title="ray.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.indexes", "content.tabs.link", "navigation.tracking", "navigation.instant", "navigation.top", "content.code.annotate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.0bbba5b5.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
        <script src="../../../js/termynal.js"></script>
      
        <script src="../../../js/custom.js"></script>
      
    
  </body>
</html>