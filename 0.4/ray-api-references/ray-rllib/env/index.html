
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.3">
    
    
      
        <title>Environments - Ray</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/termynal.css">
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#env-package" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://ray.io" title="Ray" class="md-header__button md-logo" aria-label="Ray" data-md-component="logo">
      
  <img src="../../../images/ray-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ray
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Environments
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ray-project/ray" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ray-project/ray
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-deployment/" class="md-tabs__link">
        Deploying Ray
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-ecosystem/" class="md-tabs__link">
        Ecosystem
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-examples/" class="md-tabs__link">
        Examples
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link md-tabs__link--active">
        API
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../ray-contributor-guide/" class="md-tabs__link">
        Contribute
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ray.io" title="Ray" class="md-nav__button md-logo" aria-label="Ray" data-md-component="logo">
      
  <img src="../../../images/ray-logo.png" alt="logo">

    </a>
    Ray
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ray-project/ray" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ray-project/ray
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../..">Getting Started</a>
          
            <label for="__nav_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-overview/what-and-why-ray/" class="md-nav__link">
        Why Ray?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-overview/more-information/" class="md-nav__link">
        Learn more
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-core/">Ray Core</a>
          
            <label for="__nav_1_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Core" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          Ray Core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-core/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-core/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-data/">Ray Data</a>
          
            <label for="__nav_1_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Data" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          Ray Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-data/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5_3" type="checkbox" id="__nav_1_5_3" >
      
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-data/tutorials/">Tutorials</a>
          
        </div>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_5_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-train/">Ray Train</a>
          
            <label for="__nav_1_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Train" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Ray Train
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-train/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-train/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7" type="checkbox" id="__nav_1_7" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-rllib/">Ray RLlib</a>
          
            <label for="__nav_1_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray RLlib" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_7">
          <span class="md-nav__icon md-icon"></span>
          Ray RLlib
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-rllib/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-rllib/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_8" type="checkbox" id="__nav_1_8" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-tune/">Ray Tune</a>
          
            <label for="__nav_1_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Tune" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_8">
          <span class="md-nav__icon md-icon"></span>
          Ray Tune
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-tune/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-tune/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_9" type="checkbox" id="__nav_1_9" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-serve/">Ray Serve</a>
          
            <label for="__nav_1_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Serve" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_9">
          <span class="md-nav__icon md-icon"></span>
          Ray Serve
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-serve/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_9_3" type="checkbox" id="__nav_1_9_3" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-serve/tutorials/">Tutorials</a>
          
            <label for="__nav_1_9_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_9_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-serve/tutorials/model-composition/" class="md-nav__link">
        Model composition
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_10" type="checkbox" id="__nav_1_10" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ml/ray-workflows/">Ray Workflows</a>
          
            <label for="__nav_1_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray Workflows" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_10">
          <span class="md-nav__icon md-icon"></span>
          Ray Workflows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-workflows/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ml/ray-workflows/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-deployment/">Deploying Ray</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Deploying Ray" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Deploying Ray
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-deployment/key-concepts/" class="md-nav__link">
        Key concepts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-deployment/tutorials/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-ecosystem/">Ecosystem</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ecosystem" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Ecosystem
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ecosystem/integrations/integrations/" class="md-nav__link">
        Integrations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-ecosystem/integrations/joblib/" class="md-nav__link">
        Joblib
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-examples/">Examples</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Crash Course
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Crash Course" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Crash Course
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/00-Ray-Crash-Course-Overview/" class="md-nav__link">
        Ray "Crash Course" Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/01-Ray-Tasks/" class="md-nav__link">
        Ray Crash Course - Tasks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/02-Ray-Actors/" class="md-nav__link">
        Ray Crash Course - Actors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/03-Why-Ray/" class="md-nav__link">
        Ray Crash Course - Why Ray?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/04-Ray-Multiprocessing/" class="md-nav__link">
        Ray Crash Course - Python Multiprocessing with Ray
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/05-Ray-Parallel-Iterators/" class="md-nav__link">
        Ray Crash Course - Ray Parallel Iterators (Now deprecated in Ray 1.7)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/06-Exploring-Ray-API-Calls/" class="md-nav__link">
        Ray Crash Course - Exploring Ray API Calls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-examples/ray-crash-course/07-Running-Ray-Clusters/" class="md-nav__link">
        Ray Crash Course - Ray Clusters and the Ray CLI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../">API</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Ray RLlib</a>
          
            <label for="__nav_5_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Ray RLlib" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Ray RLlib
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../agents/" class="md-nav__link">
        Agents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../policy/" class="md-nav__link">
        Policies
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Environments
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Environments
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv" class="md-nav__link">
    BaseEnv
  </a>
  
    <nav class="md-nav" aria-label="BaseEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.get_sub_environments" class="md-nav__link">
    get_sub_environments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.poll" class="md-nav__link">
    poll()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.send_actions" class="md-nav__link">
    send_actions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.to_base_env" class="md-nav__link">
    to_base_env()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.try_render" class="md-nav__link">
    try_render()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.try_reset" class="md-nav__link">
    try_reset()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.env_context.EnvContext" class="md-nav__link">
    EnvContext
  </a>
  
    <nav class="md-nav" aria-label="EnvContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.env_context.EnvContext.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.env_context.EnvContext.copy_with_overrides" class="md-nav__link">
    copy_with_overrides()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv" class="md-nav__link">
    ExternalEnv
  </a>
  
    <nav class="md-nav" aria-label="ExternalEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.end_episode" class="md-nav__link">
    end_episode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.get_action" class="md-nav__link">
    get_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.log_action" class="md-nav__link">
    log_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.log_returns" class="md-nav__link">
    log_returns()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.start_episode" class="md-nav__link">
    start_episode()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient" class="md-nav__link">
    PolicyClient
  </a>
  
    <nav class="md-nav" aria-label="PolicyClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.end_episode" class="md-nav__link">
    end_episode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.get_action" class="md-nav__link">
    get_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.log_action" class="md-nav__link">
    log_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.log_returns" class="md-nav__link">
    log_returns()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.start_episode" class="md-nav__link">
    start_episode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.update_policy_weights" class="md-nav__link">
    update_policy_weights()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_server_input.PolicyServerInput" class="md-nav__link">
    PolicyServerInput
  </a>
  
    <nav class="md-nav" aria-label="PolicyServerInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_server_input.PolicyServerInput.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_server_input.PolicyServerInput.next" class="md-nav__link">
    next()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient" class="md-nav__link">
    PolicyClient
  </a>
  
    <nav class="md-nav" aria-label="PolicyClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.end_episode" class="md-nav__link">
    end_episode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.get_action" class="md-nav__link">
    get_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.log_action" class="md-nav__link">
    log_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.log_returns" class="md-nav__link">
    log_returns()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.start_episode" class="md-nav__link">
    start_episode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.update_policy_weights" class="md-nav__link">
    update_policy_weights()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv" class="md-nav__link">
    RemoteVectorEnv
  </a>
  
    <nav class="md-nav" aria-label="RemoteVectorEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.get_sub_environments" class="md-nav__link">
    get_sub_environments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.poll" class="md-nav__link">
    poll()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.send_actions" class="md-nav__link">
    send_actions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.try_reset" class="md-nav__link">
    try_reset()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv" class="md-nav__link">
    VectorEnv
  </a>
  
    <nav class="md-nav" aria-label="VectorEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.get_sub_environments" class="md-nav__link">
    get_sub_environments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.reset_at" class="md-nav__link">
    reset_at()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.try_render_at" class="md-nav__link">
    try_render_at()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.vector_reset" class="md-nav__link">
    vector_reset()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.vector_step" class="md-nav__link">
    vector_step()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.vectorize_gym_envs" class="md-nav__link">
    vectorize_gym_envs()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation/" class="md-nav__link">
        Evaluation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../execution/" class="md-nav__link">
        Execution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Utility
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-core/" class="md-nav__link">
        Ray Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-data/" class="md-nav__link">
        Ray Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-train/" class="md-nav__link">
        Ray Train
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-tune/" class="md-nav__link">
        Ray Tune
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-workflows/" class="md-nav__link">
        Ray Workflows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ray-serve/" class="md-nav__link">
        Ray Serve
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../ray-contributor-guide/">Contribute</a>
          
            <label for="__nav_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Contribute" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Contribute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-contributor-guide/getting-involved/" class="md-nav__link">
        Start Contributing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-contributor-guide/installing-ray/building-ray-on-linux-and-macos/" class="md-nav__link">
        Building Ray on Linux and macOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ray-contributor-guide/installing-ray/building-ray-on-windows/" class="md-nav__link">
        Building Ray on Windows
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv" class="md-nav__link">
    BaseEnv
  </a>
  
    <nav class="md-nav" aria-label="BaseEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.get_sub_environments" class="md-nav__link">
    get_sub_environments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.poll" class="md-nav__link">
    poll()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.send_actions" class="md-nav__link">
    send_actions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.to_base_env" class="md-nav__link">
    to_base_env()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.try_render" class="md-nav__link">
    try_render()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.base_env.BaseEnv.try_reset" class="md-nav__link">
    try_reset()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.env_context.EnvContext" class="md-nav__link">
    EnvContext
  </a>
  
    <nav class="md-nav" aria-label="EnvContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.env_context.EnvContext.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.env_context.EnvContext.copy_with_overrides" class="md-nav__link">
    copy_with_overrides()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv" class="md-nav__link">
    ExternalEnv
  </a>
  
    <nav class="md-nav" aria-label="ExternalEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.end_episode" class="md-nav__link">
    end_episode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.get_action" class="md-nav__link">
    get_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.log_action" class="md-nav__link">
    log_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.log_returns" class="md-nav__link">
    log_returns()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.external_env.ExternalEnv.start_episode" class="md-nav__link">
    start_episode()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient" class="md-nav__link">
    PolicyClient
  </a>
  
    <nav class="md-nav" aria-label="PolicyClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.end_episode" class="md-nav__link">
    end_episode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.get_action" class="md-nav__link">
    get_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.log_action" class="md-nav__link">
    log_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.log_returns" class="md-nav__link">
    log_returns()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.start_episode" class="md-nav__link">
    start_episode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.update_policy_weights" class="md-nav__link">
    update_policy_weights()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_server_input.PolicyServerInput" class="md-nav__link">
    PolicyServerInput
  </a>
  
    <nav class="md-nav" aria-label="PolicyServerInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_server_input.PolicyServerInput.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_server_input.PolicyServerInput.next" class="md-nav__link">
    next()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient" class="md-nav__link">
    PolicyClient
  </a>
  
    <nav class="md-nav" aria-label="PolicyClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.end_episode" class="md-nav__link">
    end_episode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.get_action" class="md-nav__link">
    get_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.log_action" class="md-nav__link">
    log_action()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.log_returns" class="md-nav__link">
    log_returns()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.start_episode" class="md-nav__link">
    start_episode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.policy_client.PolicyClient.update_policy_weights" class="md-nav__link">
    update_policy_weights()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv" class="md-nav__link">
    RemoteVectorEnv
  </a>
  
    <nav class="md-nav" aria-label="RemoteVectorEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.get_sub_environments" class="md-nav__link">
    get_sub_environments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.poll" class="md-nav__link">
    poll()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.send_actions" class="md-nav__link">
    send_actions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.remote_vector_env.RemoteVectorEnv.try_reset" class="md-nav__link">
    try_reset()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv" class="md-nav__link">
    VectorEnv
  </a>
  
    <nav class="md-nav" aria-label="VectorEnv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.get_sub_environments" class="md-nav__link">
    get_sub_environments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.reset_at" class="md-nav__link">
    reset_at()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.try_render_at" class="md-nav__link">
    try_render_at()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.vector_reset" class="md-nav__link">
    vector_reset()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.vector_step" class="md-nav__link">
    vector_step()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ray.rllib.env.vector_env.VectorEnv.vectorize_gym_envs" class="md-nav__link">
    vectorize_gym_envs()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="env-package"><code>env</code> package</h1>


  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.env.base_env.BaseEnv">
        <code>
ray.rllib.env.base_env.BaseEnv        </code>



</h2>

    <div class="doc doc-contents first">

      <p>The lowest-level env interface used by RLlib for sampling.</p>
<p>BaseEnv models multiple agents executing asynchronously in multiple
environments. A call to poll() returns observations from ready agents
keyed by their environment and agent ids, and actions for those agents
can be sent back via send_actions().</p>
<p>All other env types can be adapted to BaseEnv. RLlib handles these
conversions internally in RolloutWorker, for example:</p>
<p>gym.Env =&gt; rllib.VectorEnv =&gt; rllib.BaseEnv
rllib.MultiAgentEnv (is-a gym.Env) =&gt; rllib.VectorEnv =&gt; rllib.BaseEnv
rllib.ExternalEnv =&gt; rllib.BaseEnv</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>action_space</code></td>
        <td><code>gym.Space</code></td>
        <td><p>Action space. This must be defined for
single-agent envs. Multi-agent envs can set this to None.</p></td>
      </tr>
      <tr>
        <td><code>observation_space</code></td>
        <td><code>gym.Space</code></td>
        <td><p>Observation space. This must be defined
for single-agent envs. Multi-agent envs can set this to None.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">env</span> <span class="o">=</span> <span class="n">MyBaseEnv</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">obs</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span><span class="p">,</span> <span class="n">off_policy_actions</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="p">{</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="s2">&quot;env_0&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="s2">&quot;car_0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="s2">&quot;car_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.2</span><span class="p">],</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="p">},</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="s2">&quot;env_1&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>        <span class="s2">&quot;car_0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">],</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="p">},</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="s2">&quot;env_2&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>        <span class="s2">&quot;car_0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.3</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">],</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="s2">&quot;car_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="s2">&quot;car_3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="p">},</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="p">}</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">env</span><span class="o">.</span><span class="n">send_actions</span><span class="p">(</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">actions</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="s2">&quot;env_0&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>            <span class="s2">&quot;car_0&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>            <span class="s2">&quot;car_1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="p">},</span> <span class="o">...</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="p">})</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">obs</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span><span class="p">,</span> <span class="n">off_policy_actions</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="p">{</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="s2">&quot;env_0&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="s2">&quot;car_0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.1</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">],</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="s2">&quot;car_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.2</span><span class="p">],</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="p">},</span> <span class="o">...</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="p">}</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">dones</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="p">{</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="s2">&quot;env_0&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="s2">&quot;__all__&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="s2">&quot;car_0&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="s2">&quot;car_1&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="p">},</span> <span class="o">...</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="p">}</span>
</code></pre></div>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.base_env.BaseEnv.get_sub_environments">
<code class="highlight language-python"><span class="n">get_sub_environments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Return a reference to the underlying sub environments, if any.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Any]</code></td>
      <td><p>List of the underlying sub environments or [].</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/base_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">get_sub_environments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">EnvType</span><span class="p">]:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Return a reference to the underlying sub environments, if any.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        List of the underlying sub environments or [].</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.base_env.BaseEnv.poll">
<code class="highlight language-python"><span class="n">poll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns observations from ready agents.</p>
<p>All returns are two-level dicts mapping from env_id to dicts of
agent_ids to values. The number of agents and envs can vary over time.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[Dict[Union[int, str], Dict[Any, Any]], Dict[Union[int, str], Dict[Any, Any]], Dict[Union[int, str], Dict[Any, Any]], Dict[Union[int, str], Dict[Any, Any]], Dict[Union[int, str], Dict[Any, Any]]]</code></td>
      <td><p>Tuple consisting of
1) New observations for each ready agent.
2) Reward values for each ready agent. If the episode is
just started, the value will be None.
3) Done values for each ready agent. The special key "<strong>all</strong>"
is used to indicate env termination.
4) Info values for each ready agent.
5) Agents may take off-policy actions. When that
happens, there will be an entry in this dict that contains the
taken action. There is no need to send_actions() for agents that
have already chosen off-policy actions.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/base_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">poll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MultiEnvDict</span><span class="p">,</span> <span class="n">MultiEnvDict</span><span class="p">,</span> <span class="n">MultiEnvDict</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                        <span class="n">MultiEnvDict</span><span class="p">,</span> <span class="n">MultiEnvDict</span><span class="p">]:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="sd">&quot;&quot;&quot;Returns observations from ready agents.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    All returns are two-level dicts mapping from env_id to dicts of</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    agent_ids to values. The number of agents and envs can vary over time.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        Tuple consisting of</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        1) New observations for each ready agent.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        2) Reward values for each ready agent. If the episode is</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        just started, the value will be None.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        3) Done values for each ready agent. The special key &quot;__all__&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        is used to indicate env termination.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        4) Info values for each ready agent.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        5) Agents may take off-policy actions. When that</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        happens, there will be an entry in this dict that contains the</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        taken action. There is no need to send_actions() for agents that</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        have already chosen off-policy actions.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.base_env.BaseEnv.send_actions">
<code class="highlight language-python"><span class="n">send_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_dict</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Called to send actions back to running agents in this env.</p>
<p>Actions should be sent for each ready agent that returned observations
in the previous poll() call.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>action_dict</code></td>
        <td><code>Dict[Union[int, str], Dict[Any, Any]]</code></td>
        <td><p>Actions values keyed by env_id and agent_id.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/base_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">send_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_dict</span><span class="p">:</span> <span class="n">MultiEnvDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Called to send actions back to running agents in this env.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Actions should be sent for each ready agent that returned observations</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    in the previous poll() call.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        action_dict: Actions values keyed by env_id and agent_id.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.base_env.BaseEnv.stop">
<code class="highlight language-python"><span class="n">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Releases all resources used.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/base_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Releases all resources used.&quot;&quot;&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="c1"># Try calling `close` on all sub-environments.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="k">for</span> <span class="n">env</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sub_environments</span><span class="p">():</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">):</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>            <span class="n">env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.base_env.BaseEnv.to_base_env">
<code class="highlight language-python"><span class="n">to_base_env</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">make_env</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">remote_envs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remote_env_batch_wait_ms</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">policy_config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Converts an RLlib-supported env into a BaseEnv object.</p>
<p>Supported types for the given <code>env</code> arg are gym.Env, BaseEnv,
VectorEnv, MultiAgentEnv, or ExternalEnv.</p>
<p>The resulting BaseEnv is always vectorized (contains n
sub-environments) for batched forward passes, where n may also be 1.
BaseEnv also supports async execution via the <code>poll</code> and <code>send_actions</code>
methods and thus supports external simulators.</p>
<p>TODO: Support gym3 environments, which are already vectorized.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>env</code></td>
        <td><code>Any</code></td>
        <td><p>An already existing environment of any supported env type
to convert/wrap into a BaseEnv. Supported types are gym.Env,
BaseEnv, VectorEnv, MultiAgentEnv, ExternalEnv, or
ExternalMultiAgentEnv.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>make_env</code></td>
        <td><code>Callable[[int], Any]</code></td>
        <td><p>A callable taking an int as input (which indicates the
number of individual sub-environments within the final
vectorized BaseEnv) and returning one individual
sub-environment.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>num_envs</code></td>
        <td><code>int</code></td>
        <td><p>The number of sub-environments to create in the
resulting (vectorized) BaseEnv. The already existing <code>env</code>
will be one of the <code>num_envs</code>.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>remote_envs</code></td>
        <td><code>bool</code></td>
        <td><p>Whether each sub-env should be a @ray.remote actor.
You can set this behavior in your config via the
<code>remote_worker_envs=True</code> option.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>remote_env_batch_wait_ms</code></td>
        <td><code>int</code></td>
        <td><p>The wait time (in ms) to poll remote
sub-environments for, if applicable. Only used if
<code>remote_envs</code> is True.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>policy_config</code></td>
        <td><code>Optional[dict]</code></td>
        <td><p>Optional policy config dict.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>BaseEnv</code></td>
      <td><p>The resulting BaseEnv object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/base_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">to_base_env</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="n">env</span><span class="p">:</span> <span class="n">EnvType</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">make_env</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="n">EnvType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">num_envs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="n">remote_envs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="n">remote_env_batch_wait_ms</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>        <span class="n">policy_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PartialTrainerConfigDict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BaseEnv&quot;</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="sd">&quot;&quot;&quot;Converts an RLlib-supported env into a BaseEnv object.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    Supported types for the given `env` arg are gym.Env, BaseEnv,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    VectorEnv, MultiAgentEnv, or ExternalEnv.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    The resulting BaseEnv is always vectorized (contains n</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    sub-environments) for batched forward passes, where n may also be 1.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    BaseEnv also supports async execution via the `poll` and `send_actions`</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    methods and thus supports external simulators.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    TODO: Support gym3 environments, which are already vectorized.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        env: An already existing environment of any supported env type</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">            to convert/wrap into a BaseEnv. Supported types are gym.Env,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">            BaseEnv, VectorEnv, MultiAgentEnv, ExternalEnv, or</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            ExternalMultiAgentEnv.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        make_env: A callable taking an int as input (which indicates the</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            number of individual sub-environments within the final</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">            vectorized BaseEnv) and returning one individual</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">            sub-environment.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        num_envs: The number of sub-environments to create in the</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">            resulting (vectorized) BaseEnv. The already existing `env`</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            will be one of the `num_envs`.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        remote_envs: Whether each sub-env should be a @ray.remote actor.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">            You can set this behavior in your config via the</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            `remote_worker_envs=True` option.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        remote_env_batch_wait_ms: The wait time (in ms) to poll remote</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            sub-environments for, if applicable. Only used if</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            `remote_envs` is True.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        policy_config: Optional policy config dict.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        The resulting BaseEnv object.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="kn">from</span> <span class="nn">ray.rllib.env.remote_vector_env</span> <span class="kn">import</span> <span class="n">RemoteVectorEnv</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="k">if</span> <span class="n">remote_envs</span> <span class="ow">and</span> <span class="n">num_envs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>            <span class="s2">&quot;Remote envs only make sense to use if num_envs &gt; 1 &quot;</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="s2">&quot;(i.e. vectorization is enabled).&quot;</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="c1"># Given `env` is already a BaseEnv -&gt; Return as is.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">BaseEnv</span><span class="p">):</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="k">return</span> <span class="n">env</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="c1"># `env` is not a BaseEnv yet -&gt; Need to convert/vectorize.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="c1"># MultiAgentEnv (which is a gym.Env).</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">MultiAgentEnv</span><span class="p">):</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="c1"># Sub-environments are ray.remote actors:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="k">if</span> <span class="n">remote_envs</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="n">env</span> <span class="o">=</span> <span class="n">RemoteVectorEnv</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                <span class="n">make_env</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                <span class="n">num_envs</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                <span class="n">multiagent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                <span class="n">remote_env_batch_wait_ms</span><span class="o">=</span><span class="n">remote_env_batch_wait_ms</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="c1"># Sub-environments are not ray.remote actors.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="n">env</span> <span class="o">=</span> <span class="n">_MultiAgentEnvToBaseEnv</span><span class="p">(</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                <span class="n">make_env</span><span class="o">=</span><span class="n">make_env</span><span class="p">,</span> <span class="n">existing_envs</span><span class="o">=</span><span class="p">[</span><span class="n">env</span><span class="p">],</span> <span class="n">num_envs</span><span class="o">=</span><span class="n">num_envs</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="c1"># ExternalEnv.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">ExternalEnv</span><span class="p">):</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="k">if</span> <span class="n">num_envs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                <span class="s2">&quot;External(MultiAgent)Env does not currently support &quot;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                <span class="s2">&quot;num_envs &gt; 1. One way of solving this would be to &quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                <span class="s2">&quot;treat your Env as a MultiAgentEnv hosting only one &quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                <span class="s2">&quot;type of agent but with several copies.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">env</span> <span class="o">=</span> <span class="n">_ExternalEnvToBaseEnv</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="c1"># VectorEnv.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="c1"># Note that all BaseEnvs are also vectorized, but the user may want to</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="c1"># define custom vectorization logic and thus implement a custom</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="c1"># VectorEnv class.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">VectorEnv</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">env</span> <span class="o">=</span> <span class="n">_VectorEnvToBaseEnv</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="c1"># Anything else: This usually implies that env is a gym.Env object.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="c1"># Sub-environments are ray.remote actors:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="k">if</span> <span class="n">remote_envs</span><span class="p">:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="c1"># Determine, whether the already existing sub-env (could</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="c1"># be a ray.actor) is multi-agent or not.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="n">multiagent</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">_is_multi_agent</span><span class="o">.</span><span class="n">remote</span><span class="p">())</span> <span class="k">if</span> \
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                <span class="nb">hasattr</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="s2">&quot;_is_multi_agent&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">env</span> <span class="o">=</span> <span class="n">RemoteVectorEnv</span><span class="p">(</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="n">make_env</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                <span class="n">num_envs</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="n">multiagent</span><span class="o">=</span><span class="n">multiagent</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                <span class="n">remote_env_batch_wait_ms</span><span class="o">=</span><span class="n">remote_env_batch_wait_ms</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                <span class="n">existing_envs</span><span class="o">=</span><span class="p">[</span><span class="n">env</span><span class="p">],</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="c1"># Sub-environments are not ray.remote actors.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="n">env</span> <span class="o">=</span> <span class="n">VectorEnv</span><span class="o">.</span><span class="n">vectorize_gym_envs</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="n">make_env</span><span class="o">=</span><span class="n">make_env</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="n">existing_envs</span><span class="o">=</span><span class="p">[</span><span class="n">env</span><span class="p">],</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                <span class="n">num_envs</span><span class="o">=</span><span class="n">num_envs</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="n">action_space</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                <span class="n">observation_space</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="n">env</span> <span class="o">=</span> <span class="n">_VectorEnvToBaseEnv</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="c1"># Make sure conversion went well.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">BaseEnv</span><span class="p">),</span> <span class="n">env</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">return</span> <span class="n">env</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.base_env.BaseEnv.try_render">
<code class="highlight language-python"><span class="n">try_render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Tries to render the environment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>env_id</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>The sub-environment's ID if applicable.
If None, renders the entire Env (i.e. all sub-environments).</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/base_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">try_render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EnvID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Tries to render the environment.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        env_id (Optional[int]): The sub-environment&#39;s ID if applicable.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">            If None, renders the entire Env (i.e. all sub-environments).</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="c1"># By default, do nothing.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">pass</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.base_env.BaseEnv.try_reset">
<code class="highlight language-python"><span class="n">try_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Attempt to reset the sub-env with the given id or all sub-envs.</p>
<p>If the environment does not support synchronous reset, None can be
returned here.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>env_id</code></td>
        <td><code>Union[int, str]</code></td>
        <td><p>The sub-environment's ID if applicable. If None, reset
the entire Env (i.e. all sub-environments).</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[Dict[Any, Any]]</code></td>
      <td><p>The reset (multi-agent) observation dict. None if reset is not
supported.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/base_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">try_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>              <span class="n">env_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EnvID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MultiAgentDict</span><span class="p">]:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="sd">&quot;&quot;&quot;Attempt to reset the sub-env with the given id or all sub-envs.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    If the environment does not support synchronous reset, None can be</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    returned here.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        env_id: The sub-environment&#39;s ID if applicable. If None, reset</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            the entire Env (i.e. all sub-environments).</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        The reset (multi-agent) observation dict. None if reset is not</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        supported.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.env.env_context.EnvContext">
        <code>
ray.rllib.env.env_context.EnvContext            (<span title="dict">dict</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Wraps env configurations to include extra rllib metadata.</p>
<p>These attributes can be used to parameterize environments per process.
For example, one might use <code>worker_index</code> to control which data file an
environment reads in on initialization.</p>
<p>RLlib auto-sets these attributes when constructing registered envs.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.env_context.EnvContext.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env_config</span><span class="p">,</span> <span class="n">worker_index</span><span class="p">,</span> <span class="n">vector_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">remote</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initializes an EnvContext instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>env_config</code></td>
        <td><code>dict</code></td>
        <td><p>The env's configuration defined under the
"env_config" key in the Trainer's config.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>worker_index</code></td>
        <td><code>int</code></td>
        <td><p>When there are multiple workers created, this
uniquely identifies the worker the env is created in.
0 for local worker, &gt;0 for remote workers.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_workers</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>The total number of (remote) workers in the set.
0 if only a local worker exists.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vector_index</code></td>
        <td><code>int</code></td>
        <td><p>When there are multiple envs per worker, this
uniquely identifies the env index within the worker.
Starts from 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>remote</code></td>
        <td><code>bool</code></td>
        <td><p>Whether individual sub-environments (in a vectorized
env) should be @ray.remote actors or not.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/env_context.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>             <span class="n">env_config</span><span class="p">:</span> <span class="n">EnvConfigDict</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">worker_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>             <span class="n">vector_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>             <span class="n">remote</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>             <span class="n">num_workers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="sd">&quot;&quot;&quot;Initializes an EnvContext instance.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        env_config: The env&#39;s configuration defined under the</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            &quot;env_config&quot; key in the Trainer&#39;s config.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        worker_index: When there are multiple workers created, this</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            uniquely identifies the worker the env is created in.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">            0 for local worker, &gt;0 for remote workers.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        num_workers: The total number of (remote) workers in the set.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            0 if only a local worker exists.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        vector_index: When there are multiple envs per worker, this</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">            uniquely identifies the env index within the worker.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            Starts from 0.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        remote: Whether individual sub-environments (in a vectorized</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">            env) should be @ray.remote actors or not.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="c1"># Store the env_config in the (super) dict.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="nb">dict</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env_config</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="c1"># Set some metadata attributes.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">worker_index</span> <span class="o">=</span> <span class="n">worker_index</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vector_index</span> <span class="o">=</span> <span class="n">vector_index</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">remote</span> <span class="o">=</span> <span class="n">remote</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="n">num_workers</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.env_context.EnvContext.copy_with_overrides">
<code class="highlight language-python"><span class="n">copy_with_overrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">worker_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vector_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remote</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns a copy of this EnvContext with some attributes overridden.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>env_config</code></td>
        <td><code>Optional[dict]</code></td>
        <td><p>Optional env config to use. None for not overriding
the one from the source (self).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>worker_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Optional worker index to use. None for not
overriding the one from the source (self).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vector_index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Optional vector index to use. None for not
overriding the one from the source (self).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>remote</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>Optional remote setting to use. None for not overriding
the one from the source (self).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>num_workers</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>Optional num_workers to use. None for not overriding
the one from the source (self).</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>EnvContext</code></td>
      <td><p>A new EnvContext object as a copy of self plus the provided
overrides.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/env_context.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">copy_with_overrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>                        <span class="n">env_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EnvConfigDict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                        <span class="n">worker_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>                        <span class="n">vector_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>                        <span class="n">remote</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>                        <span class="n">num_workers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;EnvContext&quot;</span><span class="p">:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="sd">&quot;&quot;&quot;Returns a copy of this EnvContext with some attributes overridden.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        env_config: Optional env config to use. None for not overriding</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            the one from the source (self).</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        worker_index: Optional worker index to use. None for not</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            overriding the one from the source (self).</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        vector_index: Optional vector index to use. None for not</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            overriding the one from the source (self).</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        remote: Optional remote setting to use. None for not overriding</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">            the one from the source (self).</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        num_workers: Optional num_workers to use. None for not overriding</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            the one from the source (self).</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        A new EnvContext object as a copy of self plus the provided</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        overrides.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">return</span> <span class="n">EnvContext</span><span class="p">(</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">env_config</span><span class="p">)</span> <span class="k">if</span> <span class="n">env_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="n">worker_index</span> <span class="k">if</span> <span class="n">worker_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker_index</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>        <span class="n">vector_index</span> <span class="k">if</span> <span class="n">vector_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_index</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="n">remote</span> <span class="k">if</span> <span class="n">remote</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">remote</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="n">num_workers</span> <span class="k">if</span> <span class="n">num_workers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.env.external_env.ExternalEnv">
        <code>
ray.rllib.env.external_env.ExternalEnv            (<span title="threading.Thread">Thread</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>An environment that interfaces with external agents.</p>
<p>Unlike simulator envs, control is inverted: The environment queries the
policy to obtain actions and in return logs observations and rewards for
training. This is in contrast to gym.Env, where the algorithm drives the
simulation through env.step() calls.</p>
<p>You can use ExternalEnv as the backend for policy serving (by serving HTTP
requests in the run loop), for ingesting offline logs data (by reading
offline transitions in the run loop), or other custom use cases not easily
expressed through gym.Env.</p>
<p>ExternalEnv supports both on-policy actions (through self.get_action()),
and off-policy actions (through self.log_action()).</p>
<p>This env is thread-safe, but individual episodes must be executed serially.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">register_env</span><span class="p">(</span><span class="s2">&quot;my_env&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">config</span><span class="p">:</span> <span class="n">YourExternalEnv</span><span class="p">(</span><span class="n">config</span><span class="p">))</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">trainer</span> <span class="o">=</span> <span class="n">DQNTrainer</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="s2">&quot;my_env&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">())</span>
</code></pre></div>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.external_env.ExternalEnv.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_space</span><span class="p">,</span> <span class="n">observation_space</span><span class="p">,</span> <span class="n">max_concurrent</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initializes an ExternalEnv instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>action_space</code></td>
        <td><code>Space</code></td>
        <td><p>Action space of the env.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>observation_space</code></td>
        <td><code>Space</code></td>
        <td><p>Observation space of the env.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_concurrent</code></td>
        <td><code>int</code></td>
        <td><p>Max number of active episodes to allow at
once. Exceeding this limit raises an error.</p></td>
        <td><code>100</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/external_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">action_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>             <span class="n">observation_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>             <span class="n">max_concurrent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="sd">&quot;&quot;&quot;Initializes an ExternalEnv instance.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        action_space: Action space of the env.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        observation_space: Observation space of the env.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        max_concurrent: Max number of active episodes to allow at</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">            once. Exceeding this limit raises an error.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">action_space</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span> <span class="o">=</span> <span class="n">observation_space</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_episodes</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_results_avail_condition</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Condition</span><span class="p">()</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_max_concurrent_episodes</span> <span class="o">=</span> <span class="n">max_concurrent</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.external_env.ExternalEnv.end_episode">
<code class="highlight language-python"><span class="n">end_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Records the end of an episode.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>observation</code></td>
        <td><code>Any</code></td>
        <td><p>Current environment observation.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/external_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">end_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observation</span><span class="p">:</span> <span class="n">EnvObsType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Records the end of an episode.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        episode_id: Episode id returned from start_episode().</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        observation: Current environment observation.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">episode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">episode_id</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">episode</span><span class="o">.</span><span class="n">episode_id</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">episode</span><span class="o">.</span><span class="n">done</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.external_env.ExternalEnv.get_action">
<code class="highlight language-python"><span class="n">get_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record an observation and get the on-policy action.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>observation</code></td>
        <td><code>Any</code></td>
        <td><p>Current environment observation.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Any</code></td>
      <td><p>Action from the env action space.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/external_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">get_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>               <span class="n">observation</span><span class="p">:</span> <span class="n">EnvObsType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EnvActionType</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="sd">&quot;&quot;&quot;Record an observation and get the on-policy action.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        episode_id: Episode id returned from start_episode().</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        observation: Current environment observation.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        Action from the env action space.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">episode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">episode_id</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="k">return</span> <span class="n">episode</span><span class="o">.</span><span class="n">wait_for_action</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.external_env.ExternalEnv.log_action">
<code class="highlight language-python"><span class="n">log_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record an observation and (off-policy) action taken.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>observation</code></td>
        <td><code>Any</code></td>
        <td><p>Current environment observation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>action</code></td>
        <td><code>Any</code></td>
        <td><p>Action for the observation.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/external_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">log_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observation</span><span class="p">:</span> <span class="n">EnvObsType</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>               <span class="n">action</span><span class="p">:</span> <span class="n">EnvActionType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="sd">&quot;&quot;&quot;Record an observation and (off-policy) action taken.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        episode_id: Episode id returned from start_episode().</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        observation: Current environment observation.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        action: Action for the observation.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">episode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">episode_id</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">episode</span><span class="o">.</span><span class="n">log_action</span><span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.external_env.ExternalEnv.log_returns">
<code class="highlight language-python"><span class="n">log_returns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Records returns (rewards and infos) from the environment.</p>
<p>The reward will be attributed to the previous action taken by the
episode. Rewards accumulate until the next action. If no reward is
logged before the next action, a reward of 0.0 is assumed.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>reward</code></td>
        <td><code>float</code></td>
        <td><p>Reward from the environment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>info</code></td>
        <td><code>Optional[dict]</code></td>
        <td><p>Optional info dict.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/external_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">log_returns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>                <span class="n">reward</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>                <span class="n">info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EnvInfoDict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="sd">&quot;&quot;&quot;Records returns (rewards and infos) from the environment.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    The reward will be attributed to the previous action taken by the</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    episode. Rewards accumulate until the next action. If no reward is</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    logged before the next action, a reward of 0.0 is assumed.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        episode_id: Episode id returned from start_episode().</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        reward: Reward from the environment.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        info: Optional info dict.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">episode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">episode_id</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">episode</span><span class="o">.</span><span class="n">cur_reward</span> <span class="o">+=</span> <span class="n">reward</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="n">episode</span><span class="o">.</span><span class="n">cur_info</span> <span class="o">=</span> <span class="n">info</span> <span class="ow">or</span> <span class="p">{}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.external_env.ExternalEnv.run">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Override this to implement the run loop.</p>
<p>Your loop should continuously:
    1. Call self.start_episode(episode_id)
    2. Call self.get_action(episode_id, obs)
            -or-
            self.log_action(episode_id, obs, action)
    3. Call self.log_returns(episode_id, reward)
    4. Call self.end_episode(episode_id, obs)
    5. Wait if nothing to do.</p>
<p>Multiple episodes may be started at the same time.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/external_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Override this to implement the run loop.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Your loop should continuously:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        1. Call self.start_episode(episode_id)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        2. Call self.get_action(episode_id, obs)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">                -or-</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">                self.log_action(episode_id, obs, action)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        3. Call self.log_returns(episode_id, reward)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        4. Call self.end_episode(episode_id, obs)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        5. Wait if nothing to do.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Multiple episodes may be started at the same time.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.external_env.ExternalEnv.start_episode">
<code class="highlight language-python"><span class="n">start_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">training_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record the start of an episode.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Unique string id for the episode or
None for it to be auto-assigned and returned.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>training_enabled</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use experiences for this
episode to improve the policy.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Unique string id for the episode.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/external_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">start_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                  <span class="n">episode_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>                  <span class="n">training_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Record the start of an episode.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        episode_id: Unique string id for the episode or</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">            None for it to be auto-assigned and returned.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        training_enabled: Whether to use experiences for this</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            episode to improve the policy.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        Unique string id for the episode.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">if</span> <span class="n">episode_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="n">episode_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="k">if</span> <span class="n">episode_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_finished</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>            <span class="s2">&quot;Episode </span><span class="si">{}</span><span class="s2"> has already completed.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">episode_id</span><span class="p">))</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="k">if</span> <span class="n">episode_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_episodes</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>            <span class="s2">&quot;Episode </span><span class="si">{}</span><span class="s2"> is already started&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">episode_id</span><span class="p">))</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_episodes</span><span class="p">[</span><span class="n">episode_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ExternalEnvEpisode</span><span class="p">(</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="n">episode_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results_avail_condition</span><span class="p">,</span> <span class="n">training_enabled</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="k">return</span> <span class="n">episode_id</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient">
        <code>
ray.rllib.env.policy_client.PolicyClient        </code>



</h2>

    <div class="doc doc-contents first">

      <p>REST client to interact with a RLlib policy server.</p>




  <div class="doc doc-children">



















  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">inference_mode</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span> <span class="n">update_interval</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Create a PolicyClient instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>address</code></td>
        <td><code>str</code></td>
        <td><p>Server to connect to (e.g., "localhost:9090").</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>inference_mode</code></td>
        <td><code>str</code></td>
        <td><p>Whether to use 'local' or 'remote' policy
inference for computing actions.</p></td>
        <td><code>&#39;local&#39;</code></td>
      </tr>
      <tr>
        <td><code>update_interval</code></td>
        <td><code>float or None</code></td>
        <td><p>If using 'local' inference mode,
the policy is refreshed after this many seconds have passed,
or None for manual control via client.</p></td>
        <td><code>10.0</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>             <span class="n">inference_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>             <span class="n">update_interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="sd">&quot;&quot;&quot;Create a PolicyClient instance.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        address (str): Server to connect to (e.g., &quot;localhost:9090&quot;).</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        inference_mode (str): Whether to use &#39;local&#39; or &#39;remote&#39; policy</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            inference for computing actions.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        update_interval (float or None): If using &#39;local&#39; inference mode,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            the policy is refreshed after this many seconds have passed,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">            or None for manual control via client.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">:</span> <span class="n">ExternalEnv</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">if</span> <span class="n">inference_mode</span> <span class="o">==</span> <span class="s2">&quot;local&quot;</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">local</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_local_rollout_worker</span><span class="p">(</span><span class="n">update_interval</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">elif</span> <span class="n">inference_mode</span> <span class="o">==</span> <span class="s2">&quot;remote&quot;</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">local</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>            <span class="s2">&quot;inference_mode must be either &#39;local&#39; or &#39;remote&#39;&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.end_episode">
<code class="highlight language-python"><span class="n">end_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record the end of an episode.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>observation</code></td>
        <td><code>obj</code></td>
        <td><p>Current environment observation.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">end_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                <span class="n">observation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvObsType</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="sd">&quot;&quot;&quot;Record the end of an episode.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        episode_id (str): Episode id returned from start_episode().</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        observation (obj): Current environment observation.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">()</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">end_episode</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">({</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">PolicyClient</span><span class="o">.</span><span class="n">END_EPISODE</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="s2">&quot;observation&quot;</span><span class="p">:</span> <span class="n">observation</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="s2">&quot;episode_id&quot;</span><span class="p">:</span> <span class="n">episode_id</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="p">})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.get_action">
<code class="highlight language-python"><span class="n">get_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record an observation and get the on-policy action.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>observation</code></td>
        <td><code>obj</code></td>
        <td><p>Current environment observation.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>action (obj)</code></td>
      <td><p>Action from the env action space.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">get_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>               <span class="n">observation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvObsType</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>               <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvActionType</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">]:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Record an observation and get the on-policy action.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        episode_id (str): Episode id returned from start_episode().</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        observation (obj): Current environment observation.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        action (obj): Action from the env action space.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">()</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>            <span class="n">actions</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>                <span class="n">eid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">observation</span><span class="p">[</span><span class="n">eid</span><span class="p">])</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>                <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">episode_id</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>            <span class="p">}</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>            <span class="k">return</span> <span class="n">actions</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">({</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">PolicyClient</span><span class="o">.</span><span class="n">GET_ACTION</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>            <span class="s2">&quot;observation&quot;</span><span class="p">:</span> <span class="n">observation</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>            <span class="s2">&quot;episode_id&quot;</span><span class="p">:</span> <span class="n">episode_id</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="p">})[</span><span class="s2">&quot;action&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.log_action">
<code class="highlight language-python"><span class="n">log_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record an observation and (off-policy) action taken.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>observation</code></td>
        <td><code>obj</code></td>
        <td><p>Current environment observation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>action</code></td>
        <td><code>obj</code></td>
        <td><p>Action for the observation.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">log_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>               <span class="n">observation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvObsType</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>               <span class="n">action</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvActionType</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Record an observation and (off-policy) action taken.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        episode_id (str): Episode id returned from start_episode().</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        observation (obj): Current environment observation.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        action (obj): Action for the observation.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">()</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">log_action</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">({</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">PolicyClient</span><span class="o">.</span><span class="n">LOG_ACTION</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="s2">&quot;observation&quot;</span><span class="p">:</span> <span class="n">observation</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="n">action</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="s2">&quot;episode_id&quot;</span><span class="p">:</span> <span class="n">episode_id</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="p">})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.log_returns">
<code class="highlight language-python"><span class="n">log_returns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">multiagent_done_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record returns from the environment.</p>
<p>The reward will be attributed to the previous action taken by the
episode. Rewards accumulate until the next action. If no reward is
logged before the next action, a reward of 0.0 is assumed.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>reward</code></td>
        <td><code>float</code></td>
        <td><p>Reward from the environment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>info</code></td>
        <td><code>dict</code></td>
        <td><p>Extra info dict.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>multiagent_done_dict</code></td>
        <td><code>dict</code></td>
        <td><p>Multi-agent done information.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">log_returns</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">reward</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="n">info</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvInfoDict</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="n">multiagent_done_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MultiAgentDict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="sd">&quot;&quot;&quot;Record returns from the environment.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    The reward will be attributed to the previous action taken by the</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    episode. Rewards accumulate until the next action. If no reward is</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    logged before the next action, a reward of 0.0 is assumed.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        episode_id (str): Episode id returned from start_episode().</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        reward (float): Reward from the environment.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        info (dict): Extra info dict.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        multiagent_done_dict (dict): Multi-agent done information.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">()</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="k">if</span> <span class="n">multiagent_done_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reward</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">log_returns</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>                                        <span class="n">multiagent_done_dict</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">log_returns</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">({</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">PolicyClient</span><span class="o">.</span><span class="n">LOG_RETURNS</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="s2">&quot;reward&quot;</span><span class="p">:</span> <span class="n">reward</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="n">info</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="s2">&quot;episode_id&quot;</span><span class="p">:</span> <span class="n">episode_id</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="s2">&quot;done&quot;</span><span class="p">:</span> <span class="n">multiagent_done_dict</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="p">})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.start_episode">
<code class="highlight language-python"><span class="n">start_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">training_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record the start of one or more episode(s).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Unique string id for the episode or
None for it to be auto-assigned.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>training_enabled</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use experiences for this
episode to improve the policy.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>episode_id (str)</code></td>
      <td><p>Unique string id for the episode.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">start_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                  <span class="n">episode_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>                  <span class="n">training_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Record the start of one or more episode(s).</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        episode_id (Optional[str]): Unique string id for the episode or</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">            None for it to be auto-assigned.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        training_enabled (bool): Whether to use experiences for this</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            episode to improve the policy.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        episode_id (str): Unique string id for the episode.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">()</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">start_episode</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">training_enabled</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">({</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="s2">&quot;episode_id&quot;</span><span class="p">:</span> <span class="n">episode_id</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">PolicyClient</span><span class="o">.</span><span class="n">START_EPISODE</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="s2">&quot;training_enabled&quot;</span><span class="p">:</span> <span class="n">training_enabled</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="p">})[</span><span class="s2">&quot;episode_id&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.update_policy_weights">
<code class="highlight language-python"><span class="n">update_policy_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Query the server for new policy weights, if local inference is enabled.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">update_policy_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Query the server for new policy weights, if local inference is enabled.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.env.policy_server_input.PolicyServerInput">
        <code>
ray.rllib.env.policy_server_input.PolicyServerInput            (<span title="socketserver.ThreadingMixIn">ThreadingMixIn</span>, <span title="http.server.HTTPServer">HTTPServer</span>, <span title="ray.rllib.offline.input_reader.InputReader">InputReader</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>REST policy server that acts as an offline data source.</p>
<p>This launches a multi-threaded server that listens on the specified host
and port to serve policy requests and forward experiences to RLlib. For
high performance experience collection, it implements InputReader.</p>
<p>For an example, run <code>examples/serving/cartpole_server.py</code> along
with <code>examples/serving/cartpole_client.py --inference-mode=local|remote</code>.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pg</span> <span class="o">=</span> <span class="n">PGTrainer</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">...</span>     <span class="n">env</span><span class="o">=</span><span class="s2">&quot;CartPole-v0&quot;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">...</span>         <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">ioctx</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="o">...</span>             <span class="n">PolicyServerInput</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">port</span><span class="p">),</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="o">...</span>         <span class="s2">&quot;num_workers&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Run just 1 server, in the trainer.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="o">...</span>     <span class="p">}</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="o">&gt;&gt;&gt;</span>     <span class="n">pg</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">client</span> <span class="o">=</span> <span class="n">PolicyClient</span><span class="p">(</span><span class="s2">&quot;localhost:9900&quot;</span><span class="p">,</span> <span class="n">inference_mode</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">eps_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">start_episode</span><span class="p">()</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">action</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">eps_id</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="o">...</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">log_returns</span><span class="p">(</span><span class="n">eps_id</span><span class="p">,</span> <span class="n">reward</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="o">...</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">log_returns</span><span class="p">(</span><span class="n">eps_id</span><span class="p">,</span> <span class="n">reward</span><span class="p">)</span>
</code></pre></div>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_server_input.PolicyServerInput.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ioctx</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">idle_timeout</span><span class="o">=</span><span class="mf">3.0</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Create a PolicyServerInput.</p>
<p>This class implements rllib.offline.InputReader, and can be used with
any Trainer by configuring</p>
<div class="highlight"><pre><span></span><code>{&quot;num_workers&quot;: 0,
 &quot;input&quot;: lambda ioctx: PolicyServerInput(ioctx, addr, port)}
</code></pre></div>
<p>Note that by setting num_workers: 0, the trainer will only create one
rollout worker / PolicyServerInput. Clients can connect to the launched
server using rllib.env.PolicyClient.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ioctx</code></td>
        <td><code>IOContext</code></td>
        <td><p>IOContext provided by RLlib.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>address</code></td>
        <td><code>str</code></td>
        <td><p>Server addr (e.g., "localhost").</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>port</code></td>
        <td><code>int</code></td>
        <td><p>Server port (e.g., 9900).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_server_input.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ioctx</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">idle_timeout</span><span class="o">=</span><span class="mf">3.0</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Create a PolicyServerInput.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    This class implements rllib.offline.InputReader, and can be used with</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    any Trainer by configuring</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        {&quot;num_workers&quot;: 0,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">         &quot;input&quot;: lambda ioctx: PolicyServerInput(ioctx, addr, port)}</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Note that by setting num_workers: 0, the trainer will only create one</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    rollout worker / PolicyServerInput. Clients can connect to the launched</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    server using rllib.env.PolicyClient.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        ioctx (IOContext): IOContext provided by RLlib.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        address (str): Server addr (e.g., &quot;localhost&quot;).</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        port (int): Server port (e.g., 9900).</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">rollout_worker</span> <span class="o">=</span> <span class="n">ioctx</span><span class="o">.</span><span class="n">worker</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">samples_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">metrics_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">idle_timeout</span> <span class="o">=</span> <span class="n">idle_timeout</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="k">def</span> <span class="nf">get_metrics</span><span class="p">():</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="n">completed</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>                <span class="n">completed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metrics_queue</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">())</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>            <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>                <span class="k">break</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="k">return</span> <span class="n">completed</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="c1"># Forwards client-reported rewards directly into the local rollout</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="c1"># worker. This is a bit of a hack since it is patching the get_metrics</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="c1"># function of the sampler.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rollout_worker</span><span class="o">.</span><span class="n">sampler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rollout_worker</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">get_metrics</span> <span class="o">=</span> <span class="n">get_metrics</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="c1"># Create a request handler that receives commands from the clients</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="c1"># and sends data and metrics into the queues.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">handler</span> <span class="o">=</span> <span class="n">_make_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rollout_worker</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples_queue</span><span class="p">,</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">metrics_queue</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="kn">import</span> <span class="nn">time</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="n">HTTPServer</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">),</span> <span class="n">handler</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating a PolicyServer on </span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2"> failed!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="kn">import</span> <span class="nn">time</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="k">raise</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting connector server at &quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">server_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">server_port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="c1"># Start the serving thread, listening on socket and handling commands.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">serving_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;server&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">serving_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">serving_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="c1"># Start a dummy thread that puts empty SampleBatches on the queue, just</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="c1"># in case we don&#39;t receive anything from clients (or there aren&#39;t</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="c1"># any). The latter would block sample collection entirely otherwise,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="c1"># even if other workers&#39; PolicyServerInput receive incoming data from</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="c1"># actual clients.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">heart_beat_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;heart-beat&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_put_empty_sample_batch_every_n_sec</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">heart_beat_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">heart_beat_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_server_input.PolicyServerInput.next">
<code class="highlight language-python"><span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns the next batch of read experiences.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>The experience read (SampleBatch or MultiAgentBatch).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_server_input.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@override</span><span class="p">(</span><span class="n">InputReader</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient">
        <code>
ray.rllib.env.policy_client.PolicyClient        </code>



</h2>

    <div class="doc doc-contents first">

      <p>REST client to interact with a RLlib policy server.</p>




  <div class="doc doc-children">



















  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">inference_mode</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span> <span class="n">update_interval</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Create a PolicyClient instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>address</code></td>
        <td><code>str</code></td>
        <td><p>Server to connect to (e.g., "localhost:9090").</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>inference_mode</code></td>
        <td><code>str</code></td>
        <td><p>Whether to use 'local' or 'remote' policy
inference for computing actions.</p></td>
        <td><code>&#39;local&#39;</code></td>
      </tr>
      <tr>
        <td><code>update_interval</code></td>
        <td><code>float or None</code></td>
        <td><p>If using 'local' inference mode,
the policy is refreshed after this many seconds have passed,
or None for manual control via client.</p></td>
        <td><code>10.0</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>             <span class="n">inference_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>             <span class="n">update_interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="sd">&quot;&quot;&quot;Create a PolicyClient instance.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        address (str): Server to connect to (e.g., &quot;localhost:9090&quot;).</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        inference_mode (str): Whether to use &#39;local&#39; or &#39;remote&#39; policy</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            inference for computing actions.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        update_interval (float or None): If using &#39;local&#39; inference mode,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">            the policy is refreshed after this many seconds have passed,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">            or None for manual control via client.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">:</span> <span class="n">ExternalEnv</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">if</span> <span class="n">inference_mode</span> <span class="o">==</span> <span class="s2">&quot;local&quot;</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">local</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_local_rollout_worker</span><span class="p">(</span><span class="n">update_interval</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">elif</span> <span class="n">inference_mode</span> <span class="o">==</span> <span class="s2">&quot;remote&quot;</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">local</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>            <span class="s2">&quot;inference_mode must be either &#39;local&#39; or &#39;remote&#39;&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.end_episode">
<code class="highlight language-python"><span class="n">end_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record the end of an episode.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>observation</code></td>
        <td><code>obj</code></td>
        <td><p>Current environment observation.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">end_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                <span class="n">observation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvObsType</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="sd">&quot;&quot;&quot;Record the end of an episode.</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">        episode_id (str): Episode id returned from start_episode().</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        observation (obj): Current environment observation.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">()</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">end_episode</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">({</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">PolicyClient</span><span class="o">.</span><span class="n">END_EPISODE</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="s2">&quot;observation&quot;</span><span class="p">:</span> <span class="n">observation</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="s2">&quot;episode_id&quot;</span><span class="p">:</span> <span class="n">episode_id</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="p">})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.get_action">
<code class="highlight language-python"><span class="n">get_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record an observation and get the on-policy action.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>observation</code></td>
        <td><code>obj</code></td>
        <td><p>Current environment observation.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>action (obj)</code></td>
      <td><p>Action from the env action space.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">get_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>               <span class="n">observation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvObsType</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>               <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvActionType</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">]:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Record an observation and get the on-policy action.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        episode_id (str): Episode id returned from start_episode().</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        observation (obj): Current environment observation.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        action (obj): Action from the env action space.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">()</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>            <span class="n">actions</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>                <span class="n">eid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">observation</span><span class="p">[</span><span class="n">eid</span><span class="p">])</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>                <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">episode_id</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>            <span class="p">}</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>            <span class="k">return</span> <span class="n">actions</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">({</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">PolicyClient</span><span class="o">.</span><span class="n">GET_ACTION</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>            <span class="s2">&quot;observation&quot;</span><span class="p">:</span> <span class="n">observation</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>            <span class="s2">&quot;episode_id&quot;</span><span class="p">:</span> <span class="n">episode_id</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="p">})[</span><span class="s2">&quot;action&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.log_action">
<code class="highlight language-python"><span class="n">log_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record an observation and (off-policy) action taken.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>observation</code></td>
        <td><code>obj</code></td>
        <td><p>Current environment observation.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>action</code></td>
        <td><code>obj</code></td>
        <td><p>Action for the observation.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">log_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>               <span class="n">observation</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvObsType</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>               <span class="n">action</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvActionType</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Record an observation and (off-policy) action taken.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        episode_id (str): Episode id returned from start_episode().</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        observation (obj): Current environment observation.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        action (obj): Action for the observation.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">()</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">log_action</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">observation</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">({</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">PolicyClient</span><span class="o">.</span><span class="n">LOG_ACTION</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="s2">&quot;observation&quot;</span><span class="p">:</span> <span class="n">observation</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="n">action</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="s2">&quot;episode_id&quot;</span><span class="p">:</span> <span class="n">episode_id</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="p">})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.log_returns">
<code class="highlight language-python"><span class="n">log_returns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">multiagent_done_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record returns from the environment.</p>
<p>The reward will be attributed to the previous action taken by the
episode. Rewards accumulate until the next action. If no reward is
logged before the next action, a reward of 0.0 is assumed.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>str</code></td>
        <td><p>Episode id returned from start_episode().</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>reward</code></td>
        <td><code>float</code></td>
        <td><p>Reward from the environment.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>info</code></td>
        <td><code>dict</code></td>
        <td><p>Extra info dict.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>multiagent_done_dict</code></td>
        <td><code>dict</code></td>
        <td><p>Multi-agent done information.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">log_returns</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">episode_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">reward</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="n">info</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">EnvInfoDict</span><span class="p">,</span> <span class="n">MultiAgentDict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="n">multiagent_done_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MultiAgentDict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="sd">&quot;&quot;&quot;Record returns from the environment.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    The reward will be attributed to the previous action taken by the</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    episode. Rewards accumulate until the next action. If no reward is</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    logged before the next action, a reward of 0.0 is assumed.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        episode_id (str): Episode id returned from start_episode().</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        reward (float): Reward from the environment.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        info (dict): Extra info dict.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        multiagent_done_dict (dict): Multi-agent done information.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">()</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="k">if</span> <span class="n">multiagent_done_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reward</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">log_returns</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>                                        <span class="n">multiagent_done_dict</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">log_returns</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">({</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">PolicyClient</span><span class="o">.</span><span class="n">LOG_RETURNS</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="s2">&quot;reward&quot;</span><span class="p">:</span> <span class="n">reward</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="n">info</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="s2">&quot;episode_id&quot;</span><span class="p">:</span> <span class="n">episode_id</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="s2">&quot;done&quot;</span><span class="p">:</span> <span class="n">multiagent_done_dict</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="p">})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.start_episode">
<code class="highlight language-python"><span class="n">start_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episode_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">training_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Record the start of one or more episode(s).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>episode_id</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Unique string id for the episode or
None for it to be auto-assigned.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>training_enabled</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use experiences for this
episode to improve the policy.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>episode_id (str)</code></td>
      <td><p>Unique string id for the episode.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">start_episode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                  <span class="n">episode_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>                  <span class="n">training_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Record the start of one or more episode(s).</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        episode_id (Optional[str]): Unique string id for the episode or</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">            None for it to be auto-assigned.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        training_enabled (bool): Whether to use experiences for this</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            episode to improve the policy.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        episode_id (str): Unique string id for the episode.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">()</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">start_episode</span><span class="p">(</span><span class="n">episode_id</span><span class="p">,</span> <span class="n">training_enabled</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">({</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="s2">&quot;episode_id&quot;</span><span class="p">:</span> <span class="n">episode_id</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">PolicyClient</span><span class="o">.</span><span class="n">START_EPISODE</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="s2">&quot;training_enabled&quot;</span><span class="p">:</span> <span class="n">training_enabled</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="p">})[</span><span class="s2">&quot;episode_id&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.policy_client.PolicyClient.update_policy_weights">
<code class="highlight language-python"><span class="n">update_policy_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Query the server for new policy weights, if local inference is enabled.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/policy_client.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">update_policy_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Query the server for new policy weights, if local inference is enabled.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_update_local_policy</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.env.remote_vector_env.RemoteVectorEnv">
        <code>
ray.rllib.env.remote_vector_env.RemoteVectorEnv            (<a title="ray.rllib.env.base_env.BaseEnv" href="#ray.rllib.env.base_env.BaseEnv">BaseEnv</a>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Vector env that executes envs in remote workers.</p>
<p>This provides dynamic batching of inference as observations are returned
from the remote simulator actors. Both single and multi-agent child envs
are supported, and envs can be stepped synchronously or async.</p>
<p>You shouldn't need to instantiate this class directly. It's automatically
inserted when you use the <code>remote_worker_envs=True</code> option in your
Trainer's config.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.remote_vector_env.RemoteVectorEnv.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">make_env</span><span class="p">,</span> <span class="n">num_envs</span><span class="p">,</span> <span class="n">multiagent</span><span class="p">,</span> <span class="n">remote_env_batch_wait_ms</span><span class="p">,</span> <span class="n">existing_envs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initializes a RemoteVectorEnv instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>make_env</code></td>
        <td><code>Callable[[int], Any]</code></td>
        <td><p>Callable that produces a single (non-vectorized) env,
given the vector env index as only arg.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_envs</code></td>
        <td><code>int</code></td>
        <td><p>The number of sub-envs to create for the vectorization.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>multiagent</code></td>
        <td><code>bool</code></td>
        <td><p>Whether this is a multiagent env or not.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>remote_env_batch_wait_ms</code></td>
        <td><code>int</code></td>
        <td><p>Time to wait for (ray.remote)
sub-environments to have new observations available when
polled. When none of the sub-envs is ready, simply repeat the
ray.wait call until at least one sub-env is ready.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>existing_envs</code></td>
        <td><code>Optional[List[ray.actor.ActorHandle]]</code></td>
        <td><p>Optional list of already created sub-envs.
These will be used as-is and only as many new sub-envs as
necessary (<code>num_envs - len(existing_envs)</code>) will be created.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/remote_vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>             <span class="n">make_env</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="n">EnvType</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>             <span class="n">num_envs</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>             <span class="n">multiagent</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>             <span class="n">remote_env_batch_wait_ms</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>             <span class="n">existing_envs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ray</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">ActorHandle</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="sd">&quot;&quot;&quot;Initializes a RemoteVectorEnv instance.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        make_env: Callable that produces a single (non-vectorized) env,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">            given the vector env index as only arg.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        num_envs: The number of sub-envs to create for the vectorization.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        multiagent: Whether this is a multiagent env or not.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        remote_env_batch_wait_ms: Time to wait for (ray.remote)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            sub-environments to have new observations available when</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            polled. When none of the sub-envs is ready, simply repeat the</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">            ray.wait call until at least one sub-env is ready.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        existing_envs: Optional list of already created sub-envs.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            These will be used as-is and only as many new sub-envs as</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">            necessary (`num_envs - len(existing_envs)`) will be created.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="c1"># Could be creating local or remote envs.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">make_env</span> <span class="o">=</span> <span class="n">make_env</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="c1"># Whether the given `make_env` callable already returns ray.remote</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="c1"># objects or not.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">make_env_creates_actors</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="c1"># Already existing env objects (generated by the RolloutWorker).</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">existing_envs</span> <span class="o">=</span> <span class="n">existing_envs</span> <span class="ow">or</span> <span class="p">[]</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_envs</span> <span class="o">=</span> <span class="n">num_envs</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">multiagent</span> <span class="o">=</span> <span class="n">multiagent</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">poll_timeout</span> <span class="o">=</span> <span class="n">remote_env_batch_wait_ms</span> <span class="o">/</span> <span class="mi">1000</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">actors</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># lazy init</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">pending</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># lazy init</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.remote_vector_env.RemoteVectorEnv.get_sub_environments">
<code class="highlight language-python"><span class="n">get_sub_environments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Return a reference to the underlying sub environments, if any.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>List of the underlying sub environments or [].</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/remote_vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@override</span><span class="p">(</span><span class="n">BaseEnv</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="k">def</span> <span class="nf">get_sub_environments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.remote_vector_env.RemoteVectorEnv.poll">
<code class="highlight language-python"><span class="n">poll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns observations from ready agents.</p>
<p>All returns are two-level dicts mapping from env_id to dicts of
agent_ids to values. The number of agents and envs can vary over time.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[Dict[Union[int, str], Dict[Any, Any]], Dict[Union[int, str], Dict[Any, Any]], Dict[Union[int, str], Dict[Any, Any]], Dict[Union[int, str], Dict[Any, Any]], Dict[Union[int, str], Dict[Any, Any]]]</code></td>
      <td><p>Tuple consisting of
1) New observations for each ready agent.
2) Reward values for each ready agent. If the episode is
just started, the value will be None.
3) Done values for each ready agent. The special key "<strong>all</strong>"
is used to indicate env termination.
4) Info values for each ready agent.
5) Agents may take off-policy actions. When that
happens, there will be an entry in this dict that contains the
taken action. There is no need to send_actions() for agents that
have already chosen off-policy actions.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/remote_vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@override</span><span class="p">(</span><span class="n">BaseEnv</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">poll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MultiEnvDict</span><span class="p">,</span> <span class="n">MultiEnvDict</span><span class="p">,</span> <span class="n">MultiEnvDict</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>                        <span class="n">MultiEnvDict</span><span class="p">,</span> <span class="n">MultiEnvDict</span><span class="p">]:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="c1"># `self.make_env` already produces Actors: Use it directly.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">existing_envs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">existing_envs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ray</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">ActorHandle</span><span class="p">):</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">make_env_creates_actors</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">actors</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actors</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_envs</span><span class="p">:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">actors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">make_env</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actors</span><span class="p">)))</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="c1"># `self.make_env` produces gym.Envs (or children thereof, such</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>        <span class="c1"># as MultiAgentEnv): Need to auto-wrap it here. The problem with</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="c1"># this is that custom methods wil get lost. If you would like to</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="c1"># keep your custom methods in your envs, you should provide the</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="c1"># env class directly in your config (w/o tune.register_env()),</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="c1"># such that your class will directly be made a @ray.remote</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="c1"># (w/o the wrapping via `_Remote[Multi|Single]AgentEnv`).</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>            <span class="k">def</span> <span class="nf">make_remote_env</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Launching env </span><span class="si">{}</span><span class="s2"> in remote actor&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiagent</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>                    <span class="k">return</span> <span class="n">_RemoteMultiAgentEnv</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">make_env</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>                    <span class="k">return</span> <span class="n">_RemoteSingleAgentEnv</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">make_env</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">actors</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>                <span class="n">make_remote_env</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_envs</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>            <span class="p">]</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="o">.</span><span class="n">reset</span><span class="o">.</span><span class="n">remote</span><span class="p">():</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span><span class="p">}</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="c1"># each keyed by env_id in [0, num_remote_envs)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">obs</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">ready</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="c1"># Wait for at least 1 env to be ready here</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">while</span> <span class="ow">not</span> <span class="n">ready</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="n">ready</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending</span><span class="p">),</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>            <span class="n">num_returns</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pending</span><span class="p">),</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">poll_timeout</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="c1"># Get and return observations for each of the ready envs</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">env_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="k">for</span> <span class="n">obj_ref</span> <span class="ow">in</span> <span class="n">ready</span><span class="p">:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">actor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pending</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">obj_ref</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="n">env_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">env_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">env_id</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">obj_ref</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="c1"># Our sub-envs are simple Actor-turned gym.Envs or MultiAgentEnvs.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_env_creates_actors</span><span class="p">:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>            <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiagent</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>                    <span class="n">ob</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">ret</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>                    <span class="n">ob</span> <span class="o">=</span> <span class="n">ret</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                    <span class="n">ob</span> <span class="o">=</span> <span class="p">{</span><span class="n">_DUMMY_AGENT_ID</span><span class="p">:</span> <span class="n">ret</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                    <span class="n">rew</span> <span class="o">=</span> <span class="p">{</span><span class="n">_DUMMY_AGENT_ID</span><span class="p">:</span> <span class="n">ret</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                    <span class="n">done</span> <span class="o">=</span> <span class="p">{</span><span class="n">_DUMMY_AGENT_ID</span><span class="p">:</span> <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;__all__&quot;</span><span class="p">:</span> <span class="n">ret</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                    <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="n">_DUMMY_AGENT_ID</span><span class="p">:</span> <span class="n">ret</span><span class="p">[</span><span class="mi">3</span><span class="p">]}</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                    <span class="n">ob</span> <span class="o">=</span> <span class="p">{</span><span class="n">_DUMMY_AGENT_ID</span><span class="p">:</span> <span class="n">ret</span><span class="p">}</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="k">if</span> <span class="n">rew</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                <span class="n">rew</span> <span class="o">=</span> <span class="p">{</span><span class="n">agent_id</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">agent_id</span> <span class="ow">in</span> <span class="n">ob</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                <span class="n">done</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;__all__&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="n">agent_id</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">agent_id</span> <span class="ow">in</span> <span class="n">ob</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="c1"># Our sub-envs are auto-wrapped and already behave like multi-agent</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="c1"># envs.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="n">ob</span><span class="p">,</span> <span class="n">rew</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">ret</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">obs</span><span class="p">[</span><span class="n">env_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">ob</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">rewards</span><span class="p">[</span><span class="n">env_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">rew</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">dones</span><span class="p">[</span><span class="n">env_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">done</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">infos</span><span class="p">[</span><span class="n">env_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Got obs batch for actors </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env_ids</span><span class="p">))</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">return</span> <span class="n">obs</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span><span class="p">,</span> <span class="p">{}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.remote_vector_env.RemoteVectorEnv.send_actions">
<code class="highlight language-python"><span class="n">send_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_dict</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Called to send actions back to running agents in this env.</p>
<p>Actions should be sent for each ready agent that returned observations
in the previous poll() call.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>action_dict</code></td>
        <td><code>Dict[Union[int, str], Dict[Any, Any]]</code></td>
        <td><p>Actions values keyed by env_id and agent_id.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/remote_vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@override</span><span class="p">(</span><span class="n">BaseEnv</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="k">def</span> <span class="nf">send_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_dict</span><span class="p">:</span> <span class="n">MultiEnvDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="k">for</span> <span class="n">env_id</span><span class="p">,</span> <span class="n">actions</span> <span class="ow">in</span> <span class="n">action_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">actor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span><span class="p">[</span><span class="n">env_id</span><span class="p">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="c1"># `actor` is a simple single-agent (remote) env, e.g. a gym.Env</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="c1"># that was made a @ray.remote.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiagent</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_env_creates_actors</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>            <span class="n">obj_ref</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">step</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">_DUMMY_AGENT_ID</span><span class="p">])</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>        <span class="c1"># `actor` is already a _RemoteSingleAgentEnv or</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>        <span class="c1"># _RemoteMultiAgentEnv wrapper</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="c1"># (handles the multi-agent action_dict automatically).</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>            <span class="n">obj_ref</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">step</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pending</span><span class="p">[</span><span class="n">obj_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">actor</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.remote_vector_env.RemoteVectorEnv.stop">
<code class="highlight language-python"><span class="n">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Releases all resources used.</p>

        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/remote_vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@override</span><span class="p">(</span><span class="n">BaseEnv</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span><span class="p">:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>            <span class="n">actor</span><span class="o">.</span><span class="n">__ray_terminate__</span><span class="o">.</span><span class="n">remote</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.remote_vector_env.RemoteVectorEnv.try_reset">
<code class="highlight language-python"><span class="n">try_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Attempt to reset the sub-env with the given id or all sub-envs.</p>
<p>If the environment does not support synchronous reset, None can be
returned here.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>env_id</code></td>
        <td><code>Union[int, str]</code></td>
        <td><p>The sub-environment's ID if applicable. If None, reset
the entire Env (i.e. all sub-environments).</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[Dict[Any, Any]]</code></td>
      <td><p>The reset (multi-agent) observation dict. None if reset is not
supported.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/remote_vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@override</span><span class="p">(</span><span class="n">BaseEnv</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="k">def</span> <span class="nf">try_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>              <span class="n">env_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EnvID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MultiAgentDict</span><span class="p">]:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="n">actor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actors</span><span class="p">[</span><span class="n">env_id</span><span class="p">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="n">obj_ref</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">reset</span><span class="o">.</span><span class="n">remote</span><span class="p">()</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">pending</span><span class="p">[</span><span class="n">obj_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">actor</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="k">return</span> <span class="n">ASYNC_RESET_RETURN</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="ray.rllib.env.vector_env.VectorEnv">
        <code>
ray.rllib.env.vector_env.VectorEnv        </code>



</h2>

    <div class="doc doc-contents first">

      <p>An environment that supports batch evaluation using clones of sub-envs.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.vector_env.VectorEnv.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observation_space</span><span class="p">,</span> <span class="n">action_space</span><span class="p">,</span> <span class="n">num_envs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initializes a VectorEnv instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>observation_space</code></td>
        <td><code>Space</code></td>
        <td><p>The observation Space of a single
sub-env.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>action_space</code></td>
        <td><code>Space</code></td>
        <td><p>The action Space of a single sub-env.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>num_envs</code></td>
        <td><code>int</code></td>
        <td><p>The number of clones to make of the given sub-env.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observation_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span> <span class="n">action_space</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">Space</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>             <span class="n">num_envs</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Initializes a VectorEnv instance.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        observation_space: The observation Space of a single</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">            sub-env.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        action_space: The action Space of a single sub-env.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        num_envs: The number of clones to make of the given sub-env.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span> <span class="o">=</span> <span class="n">observation_space</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">action_space</span> <span class="o">=</span> <span class="n">action_space</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_envs</span> <span class="o">=</span> <span class="n">num_envs</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.vector_env.VectorEnv.get_sub_environments">
<code class="highlight language-python"><span class="n">get_sub_environments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns the underlying sub environments.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Any]</code></td>
      <td><p>List of all underlying sub environments.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">get_sub_environments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">EnvType</span><span class="p">]:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Returns the underlying sub environments.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        List of all underlying sub environments.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.vector_env.VectorEnv.reset_at">
<code class="highlight language-python"><span class="n">reset_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Resets a single environment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>An optional sub-env index to reset.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Any</code></td>
      <td><p>Observations from the reset sub environment.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">reset_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EnvObsType</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Resets a single environment.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        index: An optional sub-env index to reset.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        Observations from the reset sub environment.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.vector_env.VectorEnv.try_render_at">
<code class="highlight language-python"><span class="n">try_render_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Renders a single environment.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>index</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>An optional sub-env index to render.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[numpy.ndarray]</code></td>
      <td><p>Either a numpy RGB image (shape=(w x h x 3) dtype=uint8) or
None in case rendering is handled directly by this method.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">def</span> <span class="nf">try_render_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> \
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>        <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Renders a single environment.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        index: An optional sub-env index to render.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">        Either a numpy RGB image (shape=(w x h x 3) dtype=uint8) or</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">        None in case rendering is handled directly by this method.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="k">pass</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.vector_env.VectorEnv.vector_reset">
<code class="highlight language-python"><span class="n">vector_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Resets all sub-environments.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Any]</code></td>
      <td><p>List of observations from each environment.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">vector_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">EnvObsType</span><span class="p">]:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="sd">&quot;&quot;&quot;Resets all sub-environments.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="sd">        List of observations from each environment.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.vector_env.VectorEnv.vector_step">
<code class="highlight language-python"><span class="n">vector_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Performs a vectorized step on all sub environments using <code>actions</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>actions</code></td>
        <td><code>List[Any]</code></td>
        <td><p>List of actions (one for each sub-env).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[List[Any], List[float], List[bool], List[dict]]</code></td>
      <td><p>A tuple consisting of
1) New observations for each sub-env.
2) Reward values for each sub-env.
3) Done values for each sub-env.
4) Info values for each sub-env.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@PublicAPI</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">vector_step</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">EnvActionType</span><span class="p">]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">EnvObsType</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">EnvInfoDict</span><span class="p">]]:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span class="sd">&quot;&quot;&quot;Performs a vectorized step on all sub environments using `actions`.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">        actions: List of actions (one for each sub-env).</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">        A tuple consisting of</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        1) New observations for each sub-env.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        2) Reward values for each sub-env.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        3) Done values for each sub-env.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        4) Info values for each sub-env.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="ray.rllib.env.vector_env.VectorEnv.vectorize_gym_envs">
<code class="highlight language-python"><span class="n">vectorize_gym_envs</span><span class="p">(</span><span class="n">make_env</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">existing_envs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">action_space</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">observation_space</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">env_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">policy_config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Translates any given gym.Env(s) into a VectorizedEnv object.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>make_env</code></td>
        <td><code>Optional[Callable[[int], Any]]</code></td>
        <td><p>Factory that produces a new gym.Env taking the sub-env's
vector index as only arg. Must be defined if the
number of <code>existing_envs</code> is less than <code>num_envs</code>.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>existing_envs</code></td>
        <td><code>Optional[List[gym.core.Env]]</code></td>
        <td><p>Optional list of already instantiated sub
environments.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>num_envs</code></td>
        <td><code>int</code></td>
        <td><p>Total number of sub environments in this VectorEnv.</p></td>
        <td><code>1</code></td>
      </tr>
      <tr>
        <td><code>action_space</code></td>
        <td><code>Optional[gym.spaces.space.Space]</code></td>
        <td><p>The action space. If None, use existing_envs[0]'s
action space.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>observation_space</code></td>
        <td><code>Optional[gym.spaces.space.Space]</code></td>
        <td><p>The observation space. If None, use
existing_envs[0]'s action space.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>_VectorizedGymEnv</code></td>
      <td><p>The resulting _VectorizedGymEnv object (subclass of VectorEnv).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>ray/rllib/env/vector_env.py</code></summary>
          <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">def</span> <span class="nf">vectorize_gym_envs</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="n">make_env</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="n">EnvType</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">existing_envs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">num_envs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="n">action_space</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">Space</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="n">observation_space</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">gym</span><span class="o">.</span><span class="n">Space</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>        <span class="c1"># Deprecated. These seem to have never been used.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>        <span class="n">env_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>        <span class="n">policy_config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;_VectorizedGymEnv&quot;</span><span class="p">:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="sd">&quot;&quot;&quot;Translates any given gym.Env(s) into a VectorizedEnv object.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        make_env: Factory that produces a new gym.Env taking the sub-env&#39;s</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">            vector index as only arg. Must be defined if the</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">            number of `existing_envs` is less than `num_envs`.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        existing_envs: Optional list of already instantiated sub</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">            environments.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        num_envs: Total number of sub environments in this VectorEnv.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        action_space: The action space. If None, use existing_envs[0]&#39;s</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">            action space.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        observation_space: The observation space. If None, use</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">            existing_envs[0]&#39;s action space.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        The resulting _VectorizedGymEnv object (subclass of VectorEnv).</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="k">return</span> <span class="n">_VectorizedGymEnv</span><span class="p">(</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="n">make_env</span><span class="o">=</span><span class="n">make_env</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="n">existing_envs</span><span class="o">=</span><span class="n">existing_envs</span> <span class="ow">or</span> <span class="p">[],</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="n">num_envs</span><span class="o">=</span><span class="n">num_envs</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="n">observation_space</span><span class="o">=</span><span class="n">observation_space</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">action_space</span><span class="o">=</span><span class="n">action_space</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../policy/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Policies" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Policies
            </div>
          </div>
        </a>
      
      
        
        <a href="../models/" class="md-footer__link md-footer__link--next" aria-label="Next: Models" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Models
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Anyscale, Inc 2021
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://twitter.com/raydistributed" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/ray-project/ray" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://ray.io" target="_blank" rel="noopener" title="ray.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.indexes", "content.tabs.link", "navigation.tracking", "navigation.instant", "navigation.top", "content.code.annotate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.0bbba5b5.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
        <script src="../../../js/termynal.js"></script>
      
        <script src="../../../js/custom.js"></script>
      
    
  </body>
</html>